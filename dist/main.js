// @bun
var LG=Object.create;var{getPrototypeOf:KG,defineProperty:CZ,getOwnPropertyNames:SG}=Object;var PG=Object.prototype.hasOwnProperty;var JY=(Y,X,$)=>{$=Y!=null?LG(KG(Y)):{};let Q=X||!Y||!Y.__esModule?CZ($,"default",{value:Y,enumerable:!0}):$;for(let Z of SG(Y))if(!PG.call(Q,Z))CZ(Q,Z,{get:()=>Y[Z],enumerable:!0});return Q};var SY=(Y,X)=>()=>(X||Y((X={exports:{}}).exports,X),X.exports);var wX=(Y,X)=>{for(var $ in X)CZ(Y,$,{get:X[$],enumerable:!0,configurable:!0,set:(Q)=>X[$]=()=>Q})};var T0=(Y,X)=>()=>(Y&&(X=Y(Y=0)),X);var gY=import.meta.require;var E0,_8;var s6=T0(()=>{E0=class E0 extends Error{constructor(){super("End-Of-Stream");this.name="EndOfStreamError"}};_8=class _8 extends Error{constructor(Y="The operation was aborted"){super(Y);this.name="AbortError"}}});class HW{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((Y,X)=>{this.reject=X,this.resolve=Y})}}class E8{constructor(){this.endOfStream=!1,this.interrupted=!1,this.peekQueue=[]}async peek(Y,X=!1){let $=await this.read(Y,X);return this.peekQueue.push(Y.subarray(0,$)),$}async read(Y,X=!1){if(Y.length===0)return 0;let $=this.readFromPeekBuffer(Y);if(!this.endOfStream)$+=await this.readRemainderFromStream(Y.subarray($),X);if($===0&&!X)throw new E0;return $}readFromPeekBuffer(Y){let X=Y.length,$=0;while(this.peekQueue.length>0&&X>0){let Q=this.peekQueue.pop();if(!Q)throw Error("peekData should be defined");let Z=Math.min(Q.length,X);if(Y.set(Q.subarray(0,Z),$),$+=Z,X-=Z,Z<Q.length)this.peekQueue.push(Q.subarray(Z))}return $}async readRemainderFromStream(Y,X){let $=0;while($<Y.length&&!this.endOfStream){if(this.interrupted)throw new _8;let Q=await this.readFromStream(Y.subarray($),X);if(Q===0)break;$+=Q}if(!X&&$<Y.length)throw new E0;return $}}var bQ=T0(()=>{s6()});var gQ;var p7=T0(()=>{s6();bQ();gQ=class gQ extends E8{constructor(Y){super();if(this.s=Y,this.deferred=null,!Y.read||!Y.once)throw Error("Expected an instance of stream.Readable");this.s.once("end",()=>{if(this.endOfStream=!0,this.deferred)this.deferred.resolve(0)}),this.s.once("error",(X)=>this.reject(X)),this.s.once("close",()=>this.abort())}async readFromStream(Y,X){if(Y.length===0)return 0;let $=this.s.read(Y.length);if($)return Y.set($),$.length;let Q={buffer:Y,mayBeLess:X,deferred:new HW};return this.deferred=Q.deferred,this.s.once("readable",()=>{this.readDeferred(Q)}),Q.deferred.promise}readDeferred(Y){let X=this.s.read(Y.buffer.length);if(X)Y.buffer.set(X),Y.deferred.resolve(X.length),this.deferred=null;else this.s.once("readable",()=>{this.readDeferred(Y)})}reject(Y){if(this.interrupted=!0,this.deferred)this.deferred.reject(Y),this.deferred=null}async abort(){this.reject(new _8)}async close(){return this.abort()}}});var zW;var i7=T0(()=>{bQ();zW=class zW extends E8{constructor(Y){super();this.reader=Y}async abort(){return this.close()}async close(){this.reader.releaseLock()}}});var kQ;var qW=T0(()=>{i7();kQ=class kQ extends zW{async readFromStream(Y,X){if(Y.length===0)return 0;let $=await this.reader.read(new Uint8Array(Y.length),{min:X?void 0:Y.length});if($.done)this.endOfStream=$.done;if($.value)return Y.set($.value),$.value.length;return 0}}});var a6;var OW=T0(()=>{s6();bQ();a6=class a6 extends E8{constructor(Y){super();this.reader=Y,this.buffer=null}writeChunk(Y,X){let $=Math.min(X.length,Y.length);if(Y.set(X.subarray(0,$)),$<X.length)this.buffer=X.subarray($);else this.buffer=null;return $}async readFromStream(Y,X){if(Y.length===0)return 0;let $=0;if(this.buffer)$+=this.writeChunk(Y,this.buffer);while($<Y.length&&!this.endOfStream){let Q=await this.reader.read();if(Q.done){this.endOfStream=!0;break}if(Q.value)$+=this.writeChunk(Y.subarray($),Q.value)}if(!X&&$===0&&this.endOfStream)throw new E0;return $}abort(){return this.interrupted=!0,this.reader.cancel()}async close(){await this.abort(),this.reader.releaseLock()}}});function DW(Y){try{let X=Y.getReader({mode:"byob"});if(X instanceof ReadableStreamDefaultReader)return new a6(X);return new kQ(X)}catch(X){if(X instanceof TypeError)return new a6(Y.getReader());throw X}}var l7=T0(()=>{qW();OW()});var Z8=T0(()=>{s6();p7();qW();OW();l7()});class gX{constructor(Y){if(this.numBuffer=new Uint8Array(8),this.position=0,this.onClose=Y?.onClose,Y?.abortSignal)Y.abortSignal.addEventListener("abort",()=>{this.abort()})}async readToken(Y,X=this.position){let $=new Uint8Array(Y.len);if(await this.readBuffer($,{position:X})<Y.len)throw new E0;return Y.get($,0)}async peekToken(Y,X=this.position){let $=new Uint8Array(Y.len);if(await this.peekBuffer($,{position:X})<Y.len)throw new E0;return Y.get($,0)}async readNumber(Y){if(await this.readBuffer(this.numBuffer,{length:Y.len})<Y.len)throw new E0;return Y.get(this.numBuffer,0)}async peekNumber(Y){if(await this.peekBuffer(this.numBuffer,{length:Y.len})<Y.len)throw new E0;return Y.get(this.numBuffer,0)}async ignore(Y){if(this.fileInfo.size!==void 0){let X=this.fileInfo.size-this.position;if(Y>X)return this.position+=X,X}return this.position+=Y,Y}async close(){await this.abort(),await this.onClose?.()}normalizeOptions(Y,X){if(!this.supportsRandomAccess()&&X&&X.position!==void 0&&X.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");return{...{mayBeLess:!1,offset:0,length:Y.length,position:this.position},...X}}abort(){return Promise.resolve()}}var M6=T0(()=>{Z8()});var Zw=256000,fQ;var n7=T0(()=>{M6();Z8();fQ=class fQ extends gX{constructor(Y,X){super(X);this.streamReader=Y,this.fileInfo=X?.fileInfo??{}}async readBuffer(Y,X){let $=this.normalizeOptions(Y,X),Q=$.position-this.position;if(Q>0)return await this.ignore(Q),this.readBuffer(Y,X);if(Q<0)throw Error("`options.position` must be equal or greater than `tokenizer.position`");if($.length===0)return 0;let Z=await this.streamReader.read(Y.subarray(0,$.length),$.mayBeLess);if(this.position+=Z,(!X||!X.mayBeLess)&&Z<$.length)throw new E0;return Z}async peekBuffer(Y,X){let $=this.normalizeOptions(Y,X),Q=0;if($.position){let Z=$.position-this.position;if(Z>0){let W=new Uint8Array($.length+Z);return Q=await this.peekBuffer(W,{mayBeLess:$.mayBeLess}),Y.set(W.subarray(Z)),Q-Z}if(Z<0)throw Error("Cannot peek from a negative offset in a stream")}if($.length>0){try{Q=await this.streamReader.peek(Y.subarray(0,$.length),$.mayBeLess)}catch(Z){if(X?.mayBeLess&&Z instanceof E0)return 0;throw Z}if(!$.mayBeLess&&Q<$.length)throw new E0}return Q}async ignore(Y){let X=Math.min(Zw,Y),$=new Uint8Array(X),Q=0;while(Q<Y){let Z=Y-Q,W=await this.readBuffer($,{length:Math.min(X,Z)});if(W<0)return W;Q+=W}return Q}abort(){return this.streamReader.abort()}async close(){return this.streamReader.close()}supportsRandomAccess(){return!1}}});var wW;var o7=T0(()=>{Z8();M6();wW=class wW extends gX{constructor(Y,X){super(X);this.uint8Array=Y,this.fileInfo={...X?.fileInfo??{},...{size:Y.length}}}async readBuffer(Y,X){if(X?.position)this.position=X.position;let $=await this.peekBuffer(Y,X);return this.position+=$,$}async peekBuffer(Y,X){let $=this.normalizeOptions(Y,X),Q=Math.min(this.uint8Array.length-$.position,$.length);if(!$.mayBeLess&&Q<$.length)throw new E0;return Y.set(this.uint8Array.subarray($.position,$.position+Q)),Q}close(){return super.close()}supportsRandomAccess(){return!0}setPosition(Y){this.position=Y}}});var t7=T0(()=>{Z8();M6()});function r7(Y,X){let $=new gQ(Y),Q=X??{},Z=Q.onClose;return Q.onClose=async()=>{if(await $.close(),Z)return Z()},new fQ($,Q)}function yQ(Y,X){let $=DW(Y),Q=X??{},Z=Q.onClose;return Q.onClose=async()=>{if(await $.close(),Z)return Z()},new fQ($,Q)}function s7(Y,X){return new wW(Y,X)}var vQ=T0(()=>{Z8();n7();o7();t7();Z8();M6()});import{open as Jw}from"fs/promises";var e6;var LW=T0(()=>{M6();Z8();e6=class e6 extends gX{static async fromFile(Y){let X=await Jw(Y,"r"),$=await X.stat();return new e6(X,{fileInfo:{path:Y,size:$.size}})}constructor(Y,X){super(X);this.fileHandle=Y,this.fileInfo=X.fileInfo}async readBuffer(Y,X){let $=this.normalizeOptions(Y,X);if(this.position=$.position,$.length===0)return 0;let Q=await this.fileHandle.read(Y,0,$.length,$.position);if(this.position+=Q.bytesRead,Q.bytesRead<$.length&&(!X||!X.mayBeLess))throw new E0;return Q.bytesRead}async peekBuffer(Y,X){let $=this.normalizeOptions(Y,X),Q=await this.fileHandle.read(Y,0,$.length,$.position);if(!$.mayBeLess&&Q.bytesRead<$.length)throw new E0;return Q.bytesRead}async close(){return await this.fileHandle.close(),super.close()}setPosition(Y){this.position=Y}supportsRandomAccess(){return!0}}});import{stat as Mw}from"fs/promises";async function a7(Y,X){let $=r7(Y,X);if(Y.path){let Q=await Mw(Y.path);$.fileInfo.path=Y.path,$.fileInfo.size=Q.size}return $}var e7;var YM=T0(()=>{vQ();LW();LW();vQ();e7=e6.fromFile});var XM=T0(()=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */});function $M(Y,X="utf-8"){switch(X.toLowerCase()){case"utf-8":case"utf8":if(typeof globalThis.TextDecoder<"u")return new globalThis.TextDecoder("utf-8").decode(Y);return Bw(Y);case"utf-16le":return Aw(Y);case"ascii":return Hw(Y);case"latin1":case"iso-8859-1":return zw(Y);case"windows-1252":return qw(Y);default:throw RangeError(`Encoding '${X}' not supported`)}}function Bw(Y){let X="",$=0;while($<Y.length){let Q=Y[$++];if(Q<128)X+=String.fromCharCode(Q);else if(Q<224){let Z=Y[$++]&63;X+=String.fromCharCode((Q&31)<<6|Z)}else if(Q<240){let Z=Y[$++]&63,W=Y[$++]&63;X+=String.fromCharCode((Q&15)<<12|Z<<6|W)}else{let Z=Y[$++]&63,W=Y[$++]&63,J=Y[$++]&63,M=(Q&7)<<18|Z<<12|W<<6|J;M-=65536,X+=String.fromCharCode(55296+(M>>10&1023),56320+(M&1023))}}return X}function Aw(Y){let X="";for(let $=0;$<Y.length;$+=2)X+=String.fromCharCode(Y[$]|Y[$+1]<<8);return X}function Hw(Y){return String.fromCharCode(...Y.map((X)=>X&127))}function zw(Y){return String.fromCharCode(...Y)}function qw(Y){let X="";for(let $ of Y)if($>=128&&$<=159&&KW[$])X+=KW[$];else X+=String.fromCharCode($);return X}var KW,Uw;var QM=T0(()=>{KW={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"},Uw={};for(let[Y,X]of Object.entries(KW))Uw[X]=Number.parseInt(Y)});function e1(Y){return new DataView(Y.buffer,Y.byteOffset)}class OY{constructor(Y,X){this.len=Y,this.encoding=X}get(Y,X=0){let $=Y.subarray(X,X+this.len);return $M($,this.encoding)}}var ZM,p0,N6,M1,WM,JM,MM;var Y$=T0(()=>{XM();QM();ZM={len:1,get(Y,X){return e1(Y).getUint8(X)},put(Y,X,$){return e1(Y).setUint8(X,$),X+1}},p0={len:2,get(Y,X){return e1(Y).getUint16(X,!0)},put(Y,X,$){return e1(Y).setUint16(X,$,!0),X+2}},N6={len:2,get(Y,X){return e1(Y).getUint16(X)},put(Y,X,$){return e1(Y).setUint16(X,$),X+2}},M1={len:4,get(Y,X){return e1(Y).getUint32(X,!0)},put(Y,X,$){return e1(Y).setUint32(X,$,!0),X+4}},WM={len:4,get(Y,X){return e1(Y).getUint32(X)},put(Y,X,$){return e1(Y).setUint32(X,$),X+4}},JM={len:4,get(Y,X){return e1(Y).getInt32(X)},put(Y,X,$){return e1(Y).setInt32(X,$),X+4}},MM={len:8,get(Y,X){return e1(Y).getBigUint64(X,!0)},put(Y,X,$){return e1(Y).setBigUint64(X,$,!0),X+8}}});import{createRequire as Dw}from"module";function bw(Y,X){return CW(Y,{i:2},X&&X.out,X&&X.dictionary)}function gw(Y,X){var $=Iw(Y);if($+8>Y.length)DY(6,"invalid gzip data");return CW(Y.subarray($,-8),{i:2},X&&X.out||new wY(Tw(Y)),X&&X.dictionary)}function kw(Y,X){return CW(Y.subarray(xw(Y,X&&X.dictionary),-4),{i:2},X&&X.out,X&&X.dictionary)}function qM(Y,X){return Y[0]==31&&Y[1]==139&&Y[2]==8?gw(Y,X):(Y[0]&15)!=8||Y[0]>>4>7||(Y[0]<<8|Y[1])%31?bw(Y,X):kw(Y,X)}var ww,Lw,wY,G6,Kw,NM,GM,Sw,UM=function(Y,X){var $=new G6(31);for(var Q=0;Q<31;++Q)$[Q]=X+=1<<Y[Q-1];var Z=new Kw($[30]);for(var Q=1;Q<30;++Q)for(var W=$[Q];W<$[Q+1];++W)Z[W]=W-$[Q]<<5|Q;return{b:$,r:Z}},BM,AM,Pw,HM,Fw,Tf,FW,BX,X0,X$=function(Y,X,$){var Q=Y.length,Z=0,W=new G6(X);for(;Z<Q;++Z)if(Y[Z])++W[Y[Z]-1];var J=new G6(X);for(Z=1;Z<X;++Z)J[Z]=J[Z-1]+W[Z-1]<<1;var M;if($){M=new G6(1<<X);var N=15-X;for(Z=0;Z<Q;++Z)if(Y[Z]){var U=Z<<4|Y[Z],G=X-Y[Z],A=J[Y[Z]-1]++<<G;for(var O=A|(1<<G)-1;A<=O;++A)M[FW[A]>>N]=U}}else{M=new G6(Q);for(Z=0;Z<Q;++Z)if(Y[Z])M[Z]=FW[J[Y[Z]-1]++]>>15-Y[Z]}return M},$$,X0,X0,X0,X0,zM,X0,Cw,Rw,SW=function(Y){var X=Y[0];for(var $=1;$<Y.length;++$)if(Y[$]>X)X=Y[$];return X},eY=function(Y,X,$){var Q=X/8|0;return(Y[Q]|Y[Q+1]<<8)>>(X&7)&$},PW=function(Y,X){var $=X/8|0;return(Y[$]|Y[$+1]<<8|Y[$+2]<<16)>>(X&7)},jw=function(Y){return(Y+7)/8|0},_w=function(Y,X,$){if(X==null||X<0)X=0;if($==null||$>Y.length)$=Y.length;return new wY(Y.subarray(X,$))},Ew,DY=function(Y,X,$){var Q=Error(X||Ew[Y]);if(Q.code=Y,Error.captureStackTrace)Error.captureStackTrace(Q,DY);if(!$)throw Q;return Q},CW=function(Y,X,$,Q){var Z=Y.length,W=Q?Q.length:0;if(!Z||X.f&&!X.l)return $||new wY(0);var J=!$,M=J||X.i!=2,N=X.i;if(J)$=new wY(Z*3);var U=function(L){var j=$.length;if(L>j){var q=new wY(Math.max(j*2,L));q.set($),$=q}},G=X.f||0,A=X.p||0,O=X.b||0,B=X.l,z=X.d,H=X.m,P=X.n,R=Z*8;do{if(!B){G=eY(Y,A,1);var D=eY(Y,A+1,3);if(A+=3,!D){var C=jw(A)+4,g=Y[C-4]|Y[C-3]<<8,c=C+g;if(c>Z){if(N)DY(0);break}if(M)U(O+g);$.set(Y.subarray(C,c),O),X.b=O+=g,X.p=A=c*8,X.f=G;continue}else if(D==1)B=Cw,z=Rw,H=9,P=5;else if(D==2){var f=eY(Y,A,31)+257,y=eY(Y,A+10,15)+4,v=f+eY(Y,A+5,31)+1;A+=14;var E=new wY(v),k=new wY(19);for(var b=0;b<y;++b)k[Sw[b]]=eY(Y,A+b*3,7);A+=y*3;var u=SW(k),h=(1<<u)-1,L0=X$(k,u,1);for(var b=0;b<v;){var l=L0[eY(Y,A,h)];A+=l&15;var C=l>>4;if(C<16)E[b++]=C;else{var $1=0,l1=0;if(C==16)l1=3+eY(Y,A,3),A+=2,$1=E[b-1];else if(C==17)l1=3+eY(Y,A,7),A+=3;else if(C==18)l1=11+eY(Y,A,127),A+=7;while(l1--)E[b++]=$1}}var KY=E.subarray(0,f),P1=E.subarray(f);H=SW(KY),P=SW(P1),B=X$(KY,H,1),z=X$(P1,P,1)}else DY(1);if(A>R){if(N)DY(0);break}}if(M)U(O+131072);var WY=(1<<H)-1,l0=(1<<P)-1,Q1=A;for(;;Q1=A){var $1=B[PW(Y,A)&WY],N1=$1>>4;if(A+=$1&15,A>R){if(N)DY(0);break}if(!$1)DY(2);if(N1<256)$[O++]=N1;else if(N1==256){Q1=A,B=null;break}else{var J0=N1-254;if(N1>264){var b=N1-257,Y1=NM[b];J0=eY(Y,A,(1<<Y1)-1)+AM[b],A+=Y1}var A1=z[PW(Y,A)&l0],F1=A1>>4;if(!A1)DY(3);A+=A1&15;var P1=Fw[F1];if(F1>3){var Y1=GM[F1];P1+=PW(Y,A)&(1<<Y1)-1,A+=Y1}if(A>R){if(N)DY(0);break}if(M)U(O+131072);var OX=O+J0;if(O<P1){var DX=W-P1,V6=Math.min(P1,OX);if(DX+O<0)DY(3);for(;O<V6;++O)$[O]=Q[DX+O]}for(;O<OX;++O)$[O]=$[O-P1]}}if(X.l=B,X.p=Q1,X.b=O,X.f=G,B)G=1,X.m=H,X.d=z,X.n=P}while(!G);return O!=$.length&&J?_w($,0,O):$.subarray(0,O)},Vw,Iw=function(Y){if(Y[0]!=31||Y[1]!=139||Y[2]!=8)DY(6,"invalid gzip data");var X=Y[3],$=10;if(X&4)$+=(Y[10]|Y[11]<<8)+2;for(var Q=(X>>3&1)+(X>>4&1);Q>0;Q-=!Y[$++]);return $+(X&2)},Tw=function(Y){var X=Y.length;return(Y[X-4]|Y[X-3]<<8|Y[X-2]<<16|Y[X-1]<<24)>>>0},xw=function(Y,X){if((Y[0]&15)!=8||Y[0]>>4>7||(Y[0]<<8|Y[1])%31)DY(6,"invalid zlib data");if((Y[1]>>5&1)==+!X)DY(6,"invalid zlib data: "+(Y[1]&32?"need":"unexpected")+" dictionary");return(Y[1]>>3&4)+2},fw,yw=0;var OM=T0(()=>{ww=Dw("/");try{Lw=ww("worker_threads").Worker}catch(Y){}wY=Uint8Array,G6=Uint16Array,Kw=Int32Array,NM=new wY([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),GM=new wY([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sw=new wY([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BM=UM(NM,2),AM=BM.b,Pw=BM.r;AM[28]=258,Pw[258]=28;HM=UM(GM,0),Fw=HM.b,Tf=HM.r,FW=new G6(32768);for(X0=0;X0<32768;++X0)BX=(X0&43690)>>1|(X0&21845)<<1,BX=(BX&52428)>>2|(BX&13107)<<2,BX=(BX&61680)>>4|(BX&3855)<<4,FW[X0]=((BX&65280)>>8|(BX&255)<<8)>>1;$$=new wY(288);for(X0=0;X0<144;++X0)$$[X0]=8;for(X0=144;X0<256;++X0)$$[X0]=9;for(X0=256;X0<280;++X0)$$[X0]=7;for(X0=280;X0<288;++X0)$$[X0]=8;zM=new wY(32);for(X0=0;X0<32;++X0)zM[X0]=5;Cw=X$($$,9,1),Rw=X$(zM,5,1),Ew=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Vw=new wY(0);fw=typeof TextDecoder<"u"&&new TextDecoder;try{fw.decode(Vw,{stream:!0}),yw=1}catch(Y){}});var RW=SY((bf,DM)=>{var U6=1000,B6=U6*60,A6=B6*60,V8=A6*24,vw=V8*7,hw=V8*365.25;DM.exports=function(Y,X){X=X||{};var $=typeof Y;if($==="string"&&Y.length>0)return dw(Y);else if($==="number"&&isFinite(Y))return X.long?uw(Y):mw(Y);throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Y))};function dw(Y){if(Y=String(Y),Y.length>100)return;var X=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Y);if(!X)return;var $=parseFloat(X[1]),Q=(X[2]||"ms").toLowerCase();switch(Q){case"years":case"year":case"yrs":case"yr":case"y":return $*hw;case"weeks":case"week":case"w":return $*vw;case"days":case"day":case"d":return $*V8;case"hours":case"hour":case"hrs":case"hr":case"h":return $*A6;case"minutes":case"minute":case"mins":case"min":case"m":return $*B6;case"seconds":case"second":case"secs":case"sec":case"s":return $*U6;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return $;default:return}}function mw(Y){var X=Math.abs(Y);if(X>=V8)return Math.round(Y/V8)+"d";if(X>=A6)return Math.round(Y/A6)+"h";if(X>=B6)return Math.round(Y/B6)+"m";if(X>=U6)return Math.round(Y/U6)+"s";return Y+"ms"}function uw(Y){var X=Math.abs(Y);if(X>=V8)return hQ(Y,X,V8,"day");if(X>=A6)return hQ(Y,X,A6,"hour");if(X>=B6)return hQ(Y,X,B6,"minute");if(X>=U6)return hQ(Y,X,U6,"second");return Y+" ms"}function hQ(Y,X,$,Q){var Z=X>=$*1.5;return Math.round(Y/$)+" "+Q+(Z?"s":"")}});var jW=SY((gf,wM)=>{function cw(Y){$.debug=$,$.default=$,$.coerce=N,$.disable=J,$.enable=Z,$.enabled=M,$.humanize=RW(),$.destroy=U,Object.keys(Y).forEach((G)=>{$[G]=Y[G]}),$.names=[],$.skips=[],$.formatters={};function X(G){let A=0;for(let O=0;O<G.length;O++)A=(A<<5)-A+G.charCodeAt(O),A|=0;return $.colors[Math.abs(A)%$.colors.length]}$.selectColor=X;function $(G){let A,O=null,B,z;function H(...P){if(!H.enabled)return;let R=H,D=Number(new Date),C=D-(A||D);if(R.diff=C,R.prev=A,R.curr=D,A=D,P[0]=$.coerce(P[0]),typeof P[0]!=="string")P.unshift("%O");let g=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(f,y)=>{if(f==="%%")return"%";g++;let v=$.formatters[y];if(typeof v==="function"){let E=P[g];f=v.call(R,E),P.splice(g,1),g--}return f}),$.formatArgs.call(R,P),(R.log||$.log).apply(R,P)}if(H.namespace=G,H.useColors=$.useColors(),H.color=$.selectColor(G),H.extend=Q,H.destroy=$.destroy,Object.defineProperty(H,"enabled",{enumerable:!0,configurable:!1,get:()=>{if(O!==null)return O;if(B!==$.namespaces)B=$.namespaces,z=$.enabled(G);return z},set:(P)=>{O=P}}),typeof $.init==="function")$.init(H);return H}function Q(G,A){let O=$(this.namespace+(typeof A>"u"?":":A)+G);return O.log=this.log,O}function Z(G){$.save(G),$.namespaces=G,$.names=[],$.skips=[];let A=(typeof G==="string"?G:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let O of A)if(O[0]==="-")$.skips.push(O.slice(1));else $.names.push(O)}function W(G,A){let O=0,B=0,z=-1,H=0;while(O<G.length)if(B<A.length&&(A[B]===G[O]||A[B]==="*"))if(A[B]==="*")z=B,H=O,B++;else O++,B++;else if(z!==-1)B=z+1,H++,O=H;else return!1;while(B<A.length&&A[B]==="*")B++;return B===A.length}function J(){let G=[...$.names,...$.skips.map((A)=>"-"+A)].join(",");return $.enable(""),G}function M(G){for(let A of $.skips)if(W(G,A))return!1;for(let A of $.names)if(W(G,A))return!0;return!1}function N(G){if(G instanceof Error)return G.stack||G.message;return G}function U(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return $.enable($.load()),$}wM.exports=cw});var KM=SY((LM,dQ)=>{LM.formatArgs=iw;LM.save=lw;LM.load=nw;LM.useColors=pw;LM.storage=ow();LM.destroy=(()=>{let Y=!1;return()=>{if(!Y)Y=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}})();LM.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function pw(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let Y;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(Y=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(Y[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function iw(Y){if(Y[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Y[0]+(this.useColors?"%c ":" ")+"+"+dQ.exports.humanize(this.diff),!this.useColors)return;let X="color: "+this.color;Y.splice(1,0,X,"color: inherit");let $=0,Q=0;Y[0].replace(/%[a-zA-Z%]/g,(Z)=>{if(Z==="%%")return;if($++,Z==="%c")Q=$}),Y.splice(Q,0,X)}LM.log=console.debug||console.log||(()=>{});function lw(Y){try{if(Y)LM.storage.setItem("debug",Y);else LM.storage.removeItem("debug")}catch(X){}}function nw(){let Y;try{Y=LM.storage.getItem("debug")||LM.storage.getItem("DEBUG")}catch(X){}if(!Y&&typeof process<"u"&&"env"in process)Y=process.env.DEBUG;return Y}function ow(){try{return localStorage}catch(Y){}}dQ.exports=jW()(LM);var{formatters:tw}=dQ.exports;tw.j=function(Y){try{return JSON.stringify(Y)}catch(X){return"[UnexpectedJSONParseError]: "+X.message}}});var PM=SY((ff,SM)=>{SM.exports=(Y,X=process.argv)=>{let $=Y.startsWith("-")?"":Y.length===1?"-":"--",Q=X.indexOf($+Y),Z=X.indexOf("--");return Q!==-1&&(Z===-1||Q<Z)}});var VW=SY((yf,CM)=>{var QL=gY("os"),FM=gY("tty"),TY=PM(),{env:_1}=process,W8;if(TY("no-color")||TY("no-colors")||TY("color=false")||TY("color=never"))W8=0;else if(TY("color")||TY("colors")||TY("color=true")||TY("color=always"))W8=1;if("FORCE_COLOR"in _1)if(_1.FORCE_COLOR==="true")W8=1;else if(_1.FORCE_COLOR==="false")W8=0;else W8=_1.FORCE_COLOR.length===0?1:Math.min(parseInt(_1.FORCE_COLOR,10),3);function _W(Y){if(Y===0)return!1;return{level:Y,hasBasic:!0,has256:Y>=2,has16m:Y>=3}}function EW(Y,X){if(W8===0)return 0;if(TY("color=16m")||TY("color=full")||TY("color=truecolor"))return 3;if(TY("color=256"))return 2;if(Y&&!X&&W8===void 0)return 0;let $=W8||0;if(_1.TERM==="dumb")return $;if(process.platform==="win32"){let Q=QL.release().split(".");if(Number(Q[0])>=10&&Number(Q[2])>=10586)return Number(Q[2])>=14931?3:2;return 1}if("CI"in _1){if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((Q)=>(Q in _1))||_1.CI_NAME==="codeship")return 1;return $}if("TEAMCITY_VERSION"in _1)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(_1.TEAMCITY_VERSION)?1:0;if(_1.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in _1){let Q=parseInt((_1.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(_1.TERM_PROGRAM){case"iTerm.app":return Q>=3?3:2;case"Apple_Terminal":return 2}}if(/-256(color)?$/i.test(_1.TERM))return 2;if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(_1.TERM))return 1;if("COLORTERM"in _1)return 1;return $}function ZL(Y){let X=EW(Y,Y&&Y.isTTY);return _W(X)}CM.exports={supportsColor:ZL,stdout:_W(EW(!0,FM.isatty(1))),stderr:_W(EW(!0,FM.isatty(2)))}});var EM=SY((jM,uQ)=>{var WL=gY("tty"),mQ=gY("util");jM.init=AL;jM.log=GL;jM.formatArgs=ML;jM.save=UL;jM.load=BL;jM.useColors=JL;jM.destroy=mQ.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");jM.colors=[6,2,3,4,5,1];try{let Y=VW();if(Y&&(Y.stderr||Y).level>=2)jM.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}catch(Y){}jM.inspectOpts=Object.keys(process.env).filter((Y)=>{return/^debug_/i.test(Y)}).reduce((Y,X)=>{let $=X.substring(6).toLowerCase().replace(/_([a-z])/g,(Z,W)=>{return W.toUpperCase()}),Q=process.env[X];if(/^(yes|on|true|enabled)$/i.test(Q))Q=!0;else if(/^(no|off|false|disabled)$/i.test(Q))Q=!1;else if(Q==="null")Q=null;else Q=Number(Q);return Y[$]=Q,Y},{});function JL(){return"colors"in jM.inspectOpts?Boolean(jM.inspectOpts.colors):WL.isatty(process.stderr.fd)}function ML(Y){let{namespace:X,useColors:$}=this;if($){let Q=this.color,Z="\x1B[3"+(Q<8?Q:"8;5;"+Q),W=`  ${Z};1m${X} \x1B[0m`;Y[0]=W+Y[0].split(`
`).join(`
`+W),Y.push(Z+"m+"+uQ.exports.humanize(this.diff)+"\x1B[0m")}else Y[0]=NL()+X+" "+Y[0]}function NL(){if(jM.inspectOpts.hideDate)return"";return new Date().toISOString()+" "}function GL(...Y){return process.stderr.write(mQ.formatWithOptions(jM.inspectOpts,...Y)+`
`)}function UL(Y){if(Y)process.env.DEBUG=Y;else delete process.env.DEBUG}function BL(){return process.env.DEBUG}function AL(Y){Y.inspectOpts={};let X=Object.keys(jM.inspectOpts);for(let $=0;$<X.length;$++)Y.inspectOpts[X[$]]=jM.inspectOpts[X[$]]}uQ.exports=jW()(jM);var{formatters:RM}=uQ.exports;RM.o=function(Y){return this.inspectOpts.colors=this.useColors,mQ.inspect(Y,this.inspectOpts).split(`
`).map((X)=>X.trim()).join(" ")};RM.O=function(Y){return this.inspectOpts.colors=this.useColors,mQ.inspect(Y,this.inspectOpts)}});var VM=SY((hf,IW)=>{if(typeof process>"u"||process.type==="renderer"||!1||process.__nwjs)IW.exports=KM();else IW.exports=EM()});var T8,TW,IM,TM,xM;var bM=T0(()=>{Y$();T8={LocalFileHeader:67324752,DataDescriptor:134695760,CentralFileHeader:33639248,EndOfCentralDirectory:101010256},TW={get(Y){let X=p0.get(Y,6);return{signature:M1.get(Y,0),compressedSize:M1.get(Y,8),uncompressedSize:M1.get(Y,12)}},len:16},IM={get(Y){let X=p0.get(Y,6);return{signature:M1.get(Y,0),minVersion:p0.get(Y,4),dataDescriptor:!!(X&8),compressedMethod:p0.get(Y,8),compressedSize:M1.get(Y,18),uncompressedSize:M1.get(Y,22),filenameLength:p0.get(Y,26),extraFieldLength:p0.get(Y,28),filename:null}},len:30},TM={get(Y){return{signature:M1.get(Y,0),nrOfThisDisk:p0.get(Y,4),nrOfThisDiskWithTheStart:p0.get(Y,6),nrOfEntriesOnThisDisk:p0.get(Y,8),nrOfEntriesOfSize:p0.get(Y,10),sizeOfCd:M1.get(Y,12),offsetOfStartOfCd:M1.get(Y,16),zipFileCommentLength:p0.get(Y,20)}},len:22},xM={get(Y){let X=p0.get(Y,8);return{signature:M1.get(Y,0),minVersion:p0.get(Y,6),dataDescriptor:!!(X&8),compressedMethod:p0.get(Y,10),compressedSize:M1.get(Y,20),uncompressedSize:M1.get(Y,24),filenameLength:p0.get(Y,28),extraFieldLength:p0.get(Y,30),fileCommentLength:p0.get(Y,32),relativeOffsetOfLocalHeader:M1.get(Y,42),filename:null}},len:46}});function kM(Y){let X=new Uint8Array(M1.len);return M1.put(X,0,Y),X}class bW{constructor(Y){this.tokenizer=Y,this.syncBuffer=new Uint8Array(xW)}async isZip(){return await this.peekSignature()===T8.LocalFileHeader}peekSignature(){return this.tokenizer.peekToken(M1)}async findEndOfCentralDirectoryLocator(){let Y=this.tokenizer,X=Math.min(16384,Y.fileInfo.size),$=this.syncBuffer.subarray(0,X);await this.tokenizer.readBuffer($,{position:Y.fileInfo.size-X});for(let Q=$.length-4;Q>=0;Q--)if($[Q]===cQ[0]&&$[Q+1]===cQ[1]&&$[Q+2]===cQ[2]&&$[Q+3]===cQ[3])return Y.fileInfo.size-X+Q;return-1}async readCentralDirectory(){if(!this.tokenizer.supportsRandomAccess()){AX("Cannot reading central-directory without random-read support");return}AX("Reading central-directory...");let Y=this.tokenizer.position,X=await this.findEndOfCentralDirectoryLocator();if(X>0){AX("Central-directory 32-bit signature found");let $=await this.tokenizer.readToken(TM,X),Q=[];this.tokenizer.setPosition($.offsetOfStartOfCd);for(let Z=0;Z<$.nrOfEntriesOfSize;++Z){let W=await this.tokenizer.readToken(xM);if(W.signature!==T8.CentralFileHeader)throw Error("Expected Central-File-Header signature");W.filename=await this.tokenizer.readToken(new OY(W.filenameLength,"utf-8")),await this.tokenizer.ignore(W.extraFieldLength),await this.tokenizer.ignore(W.fileCommentLength),Q.push(W),AX(`Add central-directory file-entry: n=${Z+1}/${Q.length}: filename=${Q[Z].filename}`)}return this.tokenizer.setPosition(Y),Q}this.tokenizer.setPosition(Y)}async unzip(Y){let X=await this.readCentralDirectory();if(X)return this.iterateOverCentralDirectory(X,Y);let $=!1;do{let Q=await this.readLocalFileHeader();if(!Q)break;let Z=Y(Q);$=!!Z.stop;let W=void 0;if(await this.tokenizer.ignore(Q.extraFieldLength),Q.dataDescriptor&&Q.compressedSize===0){let J=[],M=xW;AX("Compressed-file-size unknown, scanning for next data-descriptor-signature....");let N=-1;while(N<0&&M===xW){M=await this.tokenizer.peekBuffer(this.syncBuffer,{mayBeLess:!0}),N=SL(this.syncBuffer.subarray(0,M),KL);let U=N>=0?N:M;if(Z.handler){let G=new Uint8Array(U);await this.tokenizer.readBuffer(G),J.push(G)}else await this.tokenizer.ignore(U)}if(AX(`Found data-descriptor-signature at pos=${this.tokenizer.position}`),Z.handler)await this.inflate(Q,PL(J),Z.handler)}else if(Z.handler)AX(`Reading compressed-file-data: ${Q.compressedSize} bytes`),W=new Uint8Array(Q.compressedSize),await this.tokenizer.readBuffer(W),await this.inflate(Q,W,Z.handler);else AX(`Ignoring compressed-file-data: ${Q.compressedSize} bytes`),await this.tokenizer.ignore(Q.compressedSize);if(AX(`Reading data-descriptor at pos=${this.tokenizer.position}`),Q.dataDescriptor){if((await this.tokenizer.readToken(TW)).signature!==134695760)throw Error(`Expected data-descriptor-signature at position ${this.tokenizer.position-TW.len}`)}}while(!$)}async iterateOverCentralDirectory(Y,X){for(let $ of Y){let Q=X($);if(Q.handler){this.tokenizer.setPosition($.relativeOffsetOfLocalHeader);let Z=await this.readLocalFileHeader();if(Z){await this.tokenizer.ignore(Z.extraFieldLength);let W=new Uint8Array($.compressedSize);await this.tokenizer.readBuffer(W),await this.inflate(Z,W,Q.handler)}}if(Q.stop)break}}inflate(Y,X,$){if(Y.compressedMethod===0)return $(X);AX(`Decompress filename=${Y.filename}, compressed-size=${X.length}`);let Q=qM(X);return $(Q)}async readLocalFileHeader(){let Y=await this.tokenizer.peekToken(M1);if(Y===T8.LocalFileHeader){let X=await this.tokenizer.readToken(IM);return X.filename=await this.tokenizer.readToken(new OY(X.filenameLength,"utf-8")),X}if(Y===T8.CentralFileHeader)return!1;if(Y===3759263696)throw Error("Encrypted ZIP");throw Error("Unexpected signature")}}function SL(Y,X){let $=Y.length,Q=X.length;if(Q>$)return-1;for(let Z=0;Z<=$-Q;Z++){let W=!0;for(let J=0;J<Q;J++)if(Y[Z+J]!==X[J]){W=!1;break}if(W)return Z}return-1}function PL(Y){let X=Y.reduce((Z,W)=>Z+W.length,0),$=new Uint8Array(X),Q=0;for(let Z of Y)$.set(Z,Q),Q+=Z.length;return $}var gM,AX,xW=262144,KL,cQ;var fM=T0(()=>{Y$();OM();bM();gM=JY(VM(),1);AX=gM.default("tokenizer:inflate"),KL=kM(T8.DataDescriptor),cQ=kM(T8.EndOfCentralDirectory)});function gW(Y){let{byteLength:X}=Y;if(X===6)return Y.getUint16(0)*4294967296+Y.getUint32(2);if(X===5)return Y.getUint8(0)*4294967296+Y.getUint32(1);if(X===4)return Y.getUint32(0);if(X===3)return Y.getUint8(0)*65536+Y.getUint16(1);if(X===2)return Y.getUint16(0);if(X===1)return Y.getUint8(0)}var nf,of,tf;var yM=T0(()=>{nf={utf8:new globalThis.TextDecoder("utf8")},of=new globalThis.TextEncoder,tf=Array.from({length:256},(Y,X)=>X.toString(16).padStart(2,"0"))});function vM(Y){return[...Y].map((X)=>X.charCodeAt(0))}function hM(Y,X=0){let $=Number.parseInt(new OY(6).get(Y,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN($))return!1;let Q=256;for(let Z=X;Z<X+148;Z++)Q+=Y[Z];for(let Z=X+156;Z<X+512;Z++)Q+=Y[Z];return $===Q}var dM;var mM=T0(()=>{Y$();dM={get:(Y,X)=>Y[X+3]&127|Y[X+2]<<7|Y[X+1]<<14|Y[X]<<21,len:4}});var uM,cM;var pM=T0(()=>{uM=["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ttc","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx","vtt","apk","drc","lz4","potx","xltx","dotx","xltm","ott","ots","otp","odg","otg","xlsm","docm","dotm","potm","pptm","jar","rm","ppsm","ppsx"],cM=["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.ms-powerpoint.slideshow.macroenabled.12","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/vnd.apache.arrow.file","video/mp4","audio/midi","video/matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","video/ogg","audio/ogg","audio/ogg; codecs=opus","application/ogg","audio/flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","font/collection","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","text/vtt","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/vnd.apache.parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio","application/vnd.android.package-archive","application/vnd.google.draco","application/x-lz4","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-excel.template.macroenabled.12","application/vnd.oasis.opendocument.text-template","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.oasis.opendocument.presentation-template","application/vnd.oasis.opendocument.graphics","application/vnd.oasis.opendocument.graphics-template","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.ms-word.document.macroenabled.12","application/vnd.ms-word.template.macroenabled.12","application/vnd.ms-powerpoint.template.macroenabled.12","application/vnd.ms-powerpoint.presentation.macroenabled.12","application/java-archive","application/vnd.rn-realmedia"]});async function iM(Y,X){return new H6(X).fromBuffer(Y)}async function lM(Y,X){return new H6(X).fromBlob(Y)}function kW(Y){switch(Y=Y.toLowerCase(),Y){case"application/epub+zip":return{ext:"epub",mime:Y};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:Y};case"application/vnd.oasis.opendocument.text-template":return{ext:"ott",mime:Y};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:Y};case"application/vnd.oasis.opendocument.spreadsheet-template":return{ext:"ots",mime:Y};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:Y};case"application/vnd.oasis.opendocument.presentation-template":return{ext:"otp",mime:Y};case"application/vnd.oasis.opendocument.graphics":return{ext:"odg",mime:Y};case"application/vnd.oasis.opendocument.graphics-template":return{ext:"otg",mime:Y};case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":return{ext:"ppsx",mime:Y};case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return{ext:"xlsx",mime:Y};case"application/vnd.ms-excel.sheet.macroenabled":return{ext:"xlsm",mime:"application/vnd.ms-excel.sheet.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":return{ext:"xltx",mime:Y};case"application/vnd.ms-excel.template.macroenabled":return{ext:"xltm",mime:"application/vnd.ms-excel.template.macroenabled.12"};case"application/vnd.ms-powerpoint.slideshow.macroenabled":return{ext:"ppsm",mime:"application/vnd.ms-powerpoint.slideshow.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return{ext:"docx",mime:Y};case"application/vnd.ms-word.document.macroenabled":return{ext:"docm",mime:"application/vnd.ms-word.document.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":return{ext:"dotx",mime:Y};case"application/vnd.ms-word.template.macroenabledtemplate":return{ext:"dotm",mime:"application/vnd.ms-word.template.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.presentationml.template":return{ext:"potx",mime:Y};case"application/vnd.ms-powerpoint.template.macroenabled":return{ext:"potm",mime:"application/vnd.ms-powerpoint.template.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return{ext:"pptx",mime:Y};case"application/vnd.ms-powerpoint.presentation.macroenabled":return{ext:"pptm",mime:"application/vnd.ms-powerpoint.presentation.macroenabled.12"};case"application/vnd.ms-visio.drawing":return{ext:"vsdx",mime:"application/vnd.visio"};case"application/vnd.ms-package.3dmanufacturing-3dmodel+xml":return{ext:"3mf",mime:"model/3mf"};default:}}function HX(Y,X,$){$={offset:0,...$};for(let[Q,Z]of X.entries())if($.mask){if(Z!==($.mask[Q]&Y[Q+$.offset]))return!1}else if(Z!==Y[Q+$.offset])return!1;return!0}async function nM(Y,X){return new H6(X).fromTokenizer(Y)}class H6{constructor(Y){this.options={mpegOffsetTolerance:0,...Y},this.detectors=[...Y?.customDetectors??[],{id:"core",detect:this.detectConfident},{id:"core.imprecise",detect:this.detectImprecise}],this.tokenizerOptions={abortSignal:Y?.signal}}async fromTokenizer(Y){let X=Y.position;for(let $ of this.detectors){let Q=await $.detect(Y);if(Q)return Q;if(X!==Y.position)return}}async fromBuffer(Y){if(!(Y instanceof Uint8Array||Y instanceof ArrayBuffer))throw TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof Y}\``);let X=Y instanceof Uint8Array?Y:new Uint8Array(Y);if(!(X?.length>1))return;return this.fromTokenizer(s7(X,this.tokenizerOptions))}async fromBlob(Y){return this.fromStream(Y.stream())}async fromStream(Y){let X=await yQ(Y,this.tokenizerOptions);try{return await this.fromTokenizer(X)}finally{await X.close()}}async toDetectionStream(Y,X){let{sampleSize:$=Z$}=X,Q,Z,W=Y.getReader({mode:"byob"});try{let{value:N,done:U}=await W.read(new Uint8Array($));if(Z=N,!U&&N)try{Q=await this.fromBuffer(N.subarray(0,$))}catch(G){if(!(G instanceof E0))throw G;Q=void 0}Z=N}finally{W.releaseLock()}let J=new TransformStream({async start(N){N.enqueue(Z)},transform(N,U){U.enqueue(N)}}),M=Y.pipeThrough(J);return M.fileType=Q,M}check(Y,X){return HX(this.buffer,Y,X)}checkString(Y,X){return this.check(vM(Y),X)}detectConfident=async(Y)=>{if(this.buffer=new Uint8Array(Z$),Y.fileInfo.size===void 0)Y.fileInfo.size=Number.MAX_SAFE_INTEGER;if(this.tokenizer=Y,await Y.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33])){if(await Y.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14}))return{ext:"eps",mime:"application/eps"};return{ext:"ps",mime:"application/postscript"}}if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.detectConfident(Y);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await Y.ignore(6);let X=await Y.readToken(dM);if(Y.position+X>Y.fileInfo.size)return{ext:"mp3",mime:"audio/mpeg"};return await Y.ignore(X),this.fromTokenizer(Y)}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255])){if(this.check([247],{offset:3}))return{ext:"jls",mime:"image/jls"};return{ext:"jpg",mime:"image/jpeg"}}if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){let X;return await new bW(Y).unzip(($)=>{switch($.filename){case"META-INF/mozilla.rsa":return X={ext:"xpi",mime:"application/x-xpinstall"},{stop:!0};case"META-INF/MANIFEST.MF":return X={ext:"jar",mime:"application/java-archive"},{stop:!0};case"mimetype":return{async handler(Q){let Z=new TextDecoder("utf-8").decode(Q).trim();X=kW(Z)},stop:!0};case"[Content_Types].xml":return{async handler(Q){let Z=new TextDecoder("utf-8").decode(Q),W=Z.indexOf('.main+xml"');if(W===-1){if(Z.includes('ContentType="application/vnd.ms-package.3dmanufacturing-3dmodel+xml"'))X=kW("application/vnd.ms-package.3dmanufacturing-3dmodel+xml")}else{Z=Z.slice(0,Math.max(0,W));let J=Z.lastIndexOf('"'),M=Z.slice(Math.max(0,J+1));X=kW(M)}},stop:!0};default:if(/classes\d*\.dex/.test($.filename))return X={ext:"apk",mime:"application/vnd.android.package-archive"},{stop:!0};return{}}}),X??{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await Y.ignore(28);let X=new Uint8Array(8);if(await Y.readBuffer(X),HX(X,[79,112,117,115,72,101,97,100]))return{ext:"opus",mime:"audio/ogg; codecs=opus"};if(HX(X,[128,116,104,101,111,114,97]))return{ext:"ogv",mime:"video/ogg"};if(HX(X,[1,118,105,100,101,111,0]))return{ext:"ogm",mime:"video/ogg"};if(HX(X,[127,70,76,65,67]))return{ext:"oga",mime:"audio/ogg"};if(HX(X,[83,112,101,101,120,32,32]))return{ext:"spx",mime:"audio/ogg"};if(HX(X,[1,118,111,114,98,105,115]))return{ext:"ogg",mime:"audio/ogg"};return{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:"zip",mime:"application/zip"};if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF"))return{ext:"pdf",mime:"application/pdf"};if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){let X=await this.readTiffHeader(!1);if(X)return X}if(this.check([77,77])){let X=await this.readTiffHeader(!0);if(X)return X}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function X(){let J=await Y.peekNumber(ZM),M=128,N=0;while((J&M)===0&&M!==0)++N,M>>=1;let U=new Uint8Array(N+1);return await Y.readBuffer(U),U}async function $(){let J=await X(),M=await X();M[0]^=128>>M.length-1;let N=Math.min(6,M.length),U=new DataView(J.buffer),G=new DataView(M.buffer,M.length-N,N);return{id:gW(U),len:gW(G)}}async function Q(J){while(J>0){let M=await $();if(M.id===17026)return(await Y.readToken(new OY(M.len))).replaceAll(/\00.*$/g,"");await Y.ignore(M.len),--J}}let Z=await $();switch(await Q(Z.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/matroska"};default:return}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1")||this.checkString("PARE"))return{ext:"parquet",mime:"application/vnd.apache.parquet"};if(this.checkString("ttcf"))return{ext:"ttc",mime:"font/collection"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([4,34,77,24]))return{ext:"lz4",mime:"application/x-lz4"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.checkString(".RMF"))return{ext:"rm",mime:"application/vnd.rn-realmedia"};if(this.checkString("DRACO"))return{ext:"drc",mime:"application/vnd.google.draco"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){let X=new OY(4,"latin1").get(this.buffer,2);if(X.match("^d*")&&X>=1000&&X<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>")){if(await Y.ignore(8),await Y.readToken(new OY(13,"ascii"))==="debian-binary")return{ext:"deb",mime:"application/x-deb"};return{ext:"ar",mime:"application/x-unix-archive"}}if(this.checkString("WEBVTT")&&[`
`,"\r","\t"," ","\x00"].some((X)=>this.checkString(X,{offset:6})))return{ext:"vtt",mime:"text/vtt"};if(this.check([137,80,78,71,13,10,26,10])){await Y.ignore(8);async function X(){return{length:await Y.readToken(JM),type:await Y.readToken(new OY(4,"latin1"))}}do{let $=await X();if($.length<0)return;switch($.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await Y.ignore($.length+4)}}while(Y.position+8<Y.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/vnd.apache.arrow.file"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.checkString("ftyp",{offset:4})&&(this.buffer[8]&96)!==0){let X=new OY(4,"latin1").get(this.buffer,8).replace("\x00"," ").trim();switch(X){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:if(X.startsWith("3g")){if(X.startsWith("3g2"))return{ext:"3g2",mime:"video/3gpp2"};return{ext:"3gp",mime:"video/3gpp"}}return{ext:"mp4",mime:"video/mp4"}}}if(this.check([82,73,70,70])){if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function X(){let $=new Uint8Array(16);return await Y.readBuffer($),{id:$,size:Number(await Y.readToken(MM))}}await Y.ignore(30);while(Y.position+24<Y.fileInfo.size){let $=await X(),Q=$.size-24;if(HX($.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){let Z=new Uint8Array(16);if(Q-=await Y.readBuffer(Z),HX(Z,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(HX(Z,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await Y.ignore(Q)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await Y.ignore(20),await Y.readToken(new OY(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255])){if(this.check([0,60,0,63,0,120,0,109,0,108],{offset:2}))return{ext:"xml",mime:"application/xml"};return}if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await Y.peekBuffer(this.buffer,{length:Math.min(256,Y.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("**ACE",{offset:7})&&this.checkString("**",{offset:12}))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){let X=new DataView(this.buffer.buffer).getUint32(12,!0);if(X>12&&this.buffer.length>=X+16)try{let $=new TextDecoder().decode(this.buffer.subarray(16,X+16));if(JSON.parse($).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \x00"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await Y.peekBuffer(this.buffer,{length:Math.min(512,Y.fileInfo.size),mayBeLess:!0}),this.checkString("ustar",{offset:257})&&(this.checkString("\x00",{offset:262})||this.checkString(" ",{offset:262}))||this.check([0,0,0,0,0,0],{offset:257})&&hM(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254])){if(this.check([60,0,63,0,120,0,109,0,108,0],{offset:2}))return{ext:"xml",mime:"application/xml"};if(this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2}))return{ext:"skp",mime:"application/vnd.sketchup.skp"};return}if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"}};detectImprecise=async(Y)=>{if(this.buffer=new Uint8Array(Z$),await Y.peekBuffer(this.buffer,{length:Math.min(8,Y.fileInfo.size),mayBeLess:!0}),this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(await Y.peekBuffer(this.buffer,{length:Math.min(2+this.options.mpegOffsetTolerance,Y.fileInfo.size),mayBeLess:!0}),this.buffer.length>=2+this.options.mpegOffsetTolerance)for(let X=0;X<=this.options.mpegOffsetTolerance;++X){let $=this.scanMpeg(X);if($)return $}};async readTiffTag(Y){let X=await this.tokenizer.readToken(Y?N6:p0);switch(this.tokenizer.ignore(10),X){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"};default:}}async readTiffIFD(Y){let X=await this.tokenizer.readToken(Y?N6:p0);for(let $=0;$<X;++$){let Q=await this.readTiffTag(Y);if(Q)return Q}}async readTiffHeader(Y){let X=(Y?N6:p0).get(this.buffer,2),$=(Y?WM:M1).get(this.buffer,4);if(X===42){if($>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if($>=8){let Z=(Y?N6:p0).get(this.buffer,8),W=(Y?N6:p0).get(this.buffer,10);if(Z===28&&W===254||Z===31&&W===11)return{ext:"nef",mime:"image/x-nikon-nef"}}}return await this.tokenizer.ignore($),await this.readTiffIFD(Y)??{ext:"tif",mime:"image/tiff"}}if(X===43)return{ext:"tif",mime:"image/tiff"}}scanMpeg(Y){if(this.check([255,224],{offset:Y,mask:[255,224]})){if(this.check([16],{offset:Y+1,mask:[22]})){if(this.check([8],{offset:Y+1,mask:[8]}))return{ext:"aac",mime:"audio/aac"};return{ext:"aac",mime:"audio/aac"}}if(this.check([2],{offset:Y+1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:Y+1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:Y+1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}}var Z$=4100,oM,tM;var fW=T0(()=>{Y$();vQ();fM();yM();mM();pM();oM=new Set(uM),tM=new Set(cM)});var sM={};wX(sM,{supportedMimeTypes:()=>tM,supportedExtensions:()=>oM,fileTypeStream:()=>EL,fileTypeFromTokenizer:()=>nM,fileTypeFromStream:()=>_L,fileTypeFromFile:()=>jL,fileTypeFromBuffer:()=>iM,fileTypeFromBlob:()=>lM,FileTypeParser:()=>W$});import{ReadableStream as FL}from"stream/web";import{pipeline as rM,PassThrough as CL,Readable as RL}from"stream";async function jL(Y,X){return new W$(X).fromFile(Y,X)}async function _L(Y,X){return new W$(X).fromStream(Y)}async function EL(Y,X={}){return new W$(X).toDetectionStream(Y,X)}var W$;var aM=T0(()=>{YM();fW();fW();W$=class W$ extends H6{async fromStream(Y){let X=await(Y instanceof FL?yQ(Y,this.tokenizerOptions):a7(Y,this.tokenizerOptions));try{return await super.fromTokenizer(X)}finally{await X.close()}}async fromFile(Y){let X=await e7(Y);try{return await super.fromTokenizer(X)}finally{await X.close()}}async toDetectionStream(Y,X={}){if(!(Y instanceof RL))return super.toDetectionStream(Y,X);let{sampleSize:$=Z$}=X;return new Promise((Q,Z)=>{Y.on("error",Z),Y.once("readable",()=>{(async()=>{try{let W=new CL,J=rM?rM(Y,W,()=>{}):Y.pipe(W),M=Y.read($)??Y.read()??new Uint8Array(0);try{W.fileType=await this.fromBuffer(M)}catch(N){if(N instanceof E0)W.fileType=void 0;else Z(N)}Q(J)}catch(W){Z(W)}})()})})}}});var K9=SY((Gh,L9)=>{var _6=gY("fs"),w9=gY("url"),GS=gY("child_process").spawn;L9.exports=P4;P4.XMLHttpRequest=P4;function P4(Y){Y=Y||{};var X=this,$=gY("http"),Q=gY("https"),Z,W,J={},M=!1,N={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},U=Object.assign({},N),G=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],A=["TRACE","TRACK","CONNECT"],O=!1,B=!1,z=!1,H={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null;var P=function(C){return M||C&&G.indexOf(C.toLowerCase())===-1},R=function(C){return C&&A.indexOf(C)===-1};this.open=function(C,g,c,f,y){if(this.abort(),B=!1,z=!1,!R(C))throw Error("SecurityError: Request method not allowed");J={method:C,url:g.toString(),async:typeof c!=="boolean"?!0:c,user:f||null,password:y||null},D(this.OPENED)},this.setDisableHeaderCheck=function(C){M=C},this.setRequestHeader=function(C,g){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!P(C))return console.warn('Refused to set unsafe header "'+C+'"'),!1;if(O)throw Error("INVALID_STATE_ERR: send flag is true");return U[C]=g,!0},this.getResponseHeader=function(C){if(typeof C==="string"&&this.readyState>this.OPENED&&W.headers[C.toLowerCase()]&&!B)return W.headers[C.toLowerCase()];return null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||B)return"";var C="";for(var g in W.headers)if(g!=="set-cookie"&&g!=="set-cookie2")C+=g+": "+W.headers[g]+`\r
`;return C.substr(0,C.length-2)},this.getRequestHeader=function(C){if(typeof C==="string"&&U[C])return U[C];return""},this.send=function(C){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(O)throw Error("INVALID_STATE_ERR: send has already been called");var g=!1,c=!1,f=w9.parse(J.url),y;switch(f.protocol){case"https:":g=!0;case"http:":y=f.hostname;break;case"file:":c=!0;break;case void 0:case"":y="localhost";break;default:throw Error("Protocol not supported.")}if(c){if(J.method!=="GET")throw Error("XMLHttpRequest: Only GET method is supported");if(J.async)_6.readFile(unescape(f.pathname),function(J0,Y1){if(J0)X.handleError(J0,J0.errno||-1);else X.status=200,X.responseText=Y1.toString("utf8"),X.response=Y1,D(X.DONE)});else try{this.response=_6.readFileSync(unescape(f.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,D(X.DONE)}catch(J0){this.handleError(J0,J0.errno||-1)}return}var v=f.port||(g?443:80),E=f.pathname+(f.search?f.search:"");if(U.Host=y,!(g&&v===443||v===80))U.Host+=":"+f.port;if(J.user){if(typeof J.password>"u")J.password="";var k=new Buffer(J.user+":"+J.password);U.Authorization="Basic "+k.toString("base64")}if(J.method==="GET"||J.method==="HEAD")C=null;else if(C){U["Content-Length"]=Buffer.isBuffer(C)?C.length:Buffer.byteLength(C);var b=Object.keys(U);if(!b.some(function(J0){return J0.toLowerCase()==="content-type"}))U["Content-Type"]="text/plain;charset=UTF-8"}else if(J.method==="POST")U["Content-Length"]=0;var u=Y.agent||!1,h={host:y,port:v,path:E,method:J.method,headers:U,agent:u};if(g)h.pfx=Y.pfx,h.key=Y.key,h.passphrase=Y.passphrase,h.cert=Y.cert,h.ca=Y.ca,h.ciphers=Y.ciphers,h.rejectUnauthorized=Y.rejectUnauthorized===!1?!1:!0;if(B=!1,J.async){var L0=g?Q.request:$.request;O=!0,X.dispatchEvent("readystatechange");var l=function(J0){if(W=J0,W.statusCode===302||W.statusCode===303||W.statusCode===307){J.url=W.headers.location;var Y1=w9.parse(J.url);y=Y1.hostname;var A1={hostname:Y1.hostname,port:Y1.port,path:Y1.path,method:W.statusCode===303?"GET":J.method,headers:U};if(g)A1.pfx=Y.pfx,A1.key=Y.key,A1.passphrase=Y.passphrase,A1.cert=Y.cert,A1.ca=Y.ca,A1.ciphers=Y.ciphers,A1.rejectUnauthorized=Y.rejectUnauthorized===!1?!1:!0;Z=L0(A1,l).on("error",$1),Z.end();return}D(X.HEADERS_RECEIVED),X.status=W.statusCode,W.on("data",function(F1){if(F1){var OX=Buffer.from(F1);X.response=Buffer.concat([X.response,OX])}if(O)D(X.LOADING)}),W.on("end",function(){if(O)O=!1,D(X.DONE),X.responseText=X.response.toString("utf8")}),W.on("error",function(F1){X.handleError(F1)})},$1=function(J0){if(Z.reusedSocket&&J0.code==="ECONNRESET")return L0(h,l).on("error",$1);X.handleError(J0)};if(Z=L0(h,l).on("error",$1),Y.autoUnref)Z.on("socket",(J0)=>{J0.unref()});if(C)Z.write(C);Z.end(),X.dispatchEvent("loadstart")}else{var l1=".node-xmlhttprequest-content-"+process.pid,KY=".node-xmlhttprequest-sync-"+process.pid;_6.writeFileSync(KY,"","utf8");var P1="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(g?"s":"")+".request;var options = "+JSON.stringify(h)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+l1+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+KY+"');});response.on('error', function(error) {fs.writeFileSync('"+l1+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+KY+"');});}).on('error', function(error) {fs.writeFileSync('"+l1+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+KY+"');});"+(C?"req.write('"+JSON.stringify(C).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",WY=GS(process.argv[0],["-e",P1]),l0;while(_6.existsSync(KY));if(X.responseText=_6.readFileSync(l1,"utf8"),WY.stdin.end(),_6.unlinkSync(l1),X.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var Q1=JSON.parse(X.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));X.handleError(Q1,503)}else{X.status=X.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var N1=JSON.parse(X.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));W={statusCode:X.status,headers:N1.data.headers},X.responseText=N1.data.text,X.response=Buffer.from(N1.data.data,"base64"),D(X.DONE,!0)}}},this.handleError=function(C,g){this.status=g||0,this.statusText=C,this.responseText=C.stack,B=!0,D(this.DONE)},this.abort=function(){if(Z)Z.abort(),Z=null;if(U=Object.assign({},N),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),B=z=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||O)&&this.readyState!==this.DONE)O=!1,D(this.DONE);this.readyState=this.UNSENT},this.addEventListener=function(C,g){if(!(C in H))H[C]=[];H[C].push(g)},this.removeEventListener=function(C,g){if(C in H)H[C]=H[C].filter(function(c){return c!==g})},this.dispatchEvent=function(C){if(typeof X["on"+C]==="function")if(this.readyState===this.DONE&&J.async)setTimeout(function(){X["on"+C]()},0);else X["on"+C]();if(C in H)for(let g=0,c=H[C].length;g<c;g++)if(this.readyState===this.DONE)setTimeout(function(){H[C][g].call(X)},0);else H[C][g].call(X)};var D=function(C){if(X.readyState===C||X.readyState===X.UNSENT&&z)return;if(X.readyState=C,J.async||X.readyState<X.OPENED||X.readyState===X.DONE)X.dispatchEvent("readystatechange");if(X.readyState===X.DONE){let g;if(z)g="abort";else if(B)g="error";else g="load";X.dispatchEvent(g),X.dispatchEvent("loadend")}}}});var j4=SY((Ch,k9)=>{function OS(Y){$.debug=$,$.default=$,$.coerce=N,$.disable=W,$.enable=Z,$.enabled=J,$.humanize=RW(),$.destroy=U,Object.keys(Y).forEach((G)=>{$[G]=Y[G]}),$.names=[],$.skips=[],$.formatters={};function X(G){let A=0;for(let O=0;O<G.length;O++)A=(A<<5)-A+G.charCodeAt(O),A|=0;return $.colors[Math.abs(A)%$.colors.length]}$.selectColor=X;function $(G){let A,O=null,B,z;function H(...P){if(!H.enabled)return;let R=H,D=Number(new Date),C=D-(A||D);if(R.diff=C,R.prev=A,R.curr=D,A=D,P[0]=$.coerce(P[0]),typeof P[0]!=="string")P.unshift("%O");let g=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(f,y)=>{if(f==="%%")return"%";g++;let v=$.formatters[y];if(typeof v==="function"){let E=P[g];f=v.call(R,E),P.splice(g,1),g--}return f}),$.formatArgs.call(R,P),(R.log||$.log).apply(R,P)}if(H.namespace=G,H.useColors=$.useColors(),H.color=$.selectColor(G),H.extend=Q,H.destroy=$.destroy,Object.defineProperty(H,"enabled",{enumerable:!0,configurable:!1,get:()=>{if(O!==null)return O;if(B!==$.namespaces)B=$.namespaces,z=$.enabled(G);return z},set:(P)=>{O=P}}),typeof $.init==="function")$.init(H);return H}function Q(G,A){let O=$(this.namespace+(typeof A>"u"?":":A)+G);return O.log=this.log,O}function Z(G){$.save(G),$.namespaces=G,$.names=[],$.skips=[];let A,O=(typeof G==="string"?G:"").split(/[\s,]+/),B=O.length;for(A=0;A<B;A++){if(!O[A])continue;if(G=O[A].replace(/\*/g,".*?"),G[0]==="-")$.skips.push(new RegExp("^"+G.slice(1)+"$"));else $.names.push(new RegExp("^"+G+"$"))}}function W(){let G=[...$.names.map(M),...$.skips.map(M).map((A)=>"-"+A)].join(",");return $.enable(""),G}function J(G){if(G[G.length-1]==="*")return!0;let A,O;for(A=0,O=$.skips.length;A<O;A++)if($.skips[A].test(G))return!1;for(A=0,O=$.names.length;A<O;A++)if($.names[A].test(G))return!0;return!1}function M(G){return G.toString().substring(2,G.toString().length-2).replace(/\.\*\?$/,"*")}function N(G){if(G instanceof Error)return G.stack||G.message;return G}function U(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return $.enable($.load()),$}k9.exports=OS});var y9=SY((f9,KZ)=>{f9.formatArgs=wS;f9.save=LS;f9.load=KS;f9.useColors=DS;f9.storage=SS();f9.destroy=(()=>{let Y=!1;return()=>{if(!Y)Y=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}})();f9.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function DS(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let Y;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(Y=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(Y[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function wS(Y){if(Y[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Y[0]+(this.useColors?"%c ":" ")+"+"+KZ.exports.humanize(this.diff),!this.useColors)return;let X="color: "+this.color;Y.splice(1,0,X,"color: inherit");let $=0,Q=0;Y[0].replace(/%[a-zA-Z%]/g,(Z)=>{if(Z==="%%")return;if($++,Z==="%c")Q=$}),Y.splice(Q,0,X)}f9.log=console.debug||console.log||(()=>{});function LS(Y){try{if(Y)f9.storage.setItem("debug",Y);else f9.storage.removeItem("debug")}catch(X){}}function KS(){let Y;try{Y=f9.storage.getItem("debug")}catch(X){}if(!Y&&typeof process<"u"&&"env"in process)Y=process.env.DEBUG;return Y}function SS(){try{return localStorage}catch(Y){}}KZ.exports=j4()(f9);var{formatters:PS}=KZ.exports;PS.j=function(Y){try{return JSON.stringify(Y)}catch(X){return"[UnexpectedJSONParseError]: "+X.message}}});var m9=SY((h9,PZ)=>{var IS=gY("tty"),SZ=gY("util");h9.init=yS;h9.log=gS;h9.formatArgs=xS;h9.save=kS;h9.load=fS;h9.useColors=TS;h9.destroy=SZ.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");h9.colors=[6,2,3,4,5,1];try{let Y=VW();if(Y&&(Y.stderr||Y).level>=2)h9.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}catch(Y){}h9.inspectOpts=Object.keys(process.env).filter((Y)=>{return/^debug_/i.test(Y)}).reduce((Y,X)=>{let $=X.substring(6).toLowerCase().replace(/_([a-z])/g,(Z,W)=>{return W.toUpperCase()}),Q=process.env[X];if(/^(yes|on|true|enabled)$/i.test(Q))Q=!0;else if(/^(no|off|false|disabled)$/i.test(Q))Q=!1;else if(Q==="null")Q=null;else Q=Number(Q);return Y[$]=Q,Y},{});function TS(){return"colors"in h9.inspectOpts?Boolean(h9.inspectOpts.colors):IS.isatty(process.stderr.fd)}function xS(Y){let{namespace:X,useColors:$}=this;if($){let Q=this.color,Z="\x1B[3"+(Q<8?Q:"8;5;"+Q),W=`  ${Z};1m${X} \x1B[0m`;Y[0]=W+Y[0].split(`
`).join(`
`+W),Y.push(Z+"m+"+PZ.exports.humanize(this.diff)+"\x1B[0m")}else Y[0]=bS()+X+" "+Y[0]}function bS(){if(h9.inspectOpts.hideDate)return"";return new Date().toISOString()+" "}function gS(...Y){return process.stderr.write(SZ.formatWithOptions(h9.inspectOpts,...Y)+`
`)}function kS(Y){if(Y)process.env.DEBUG=Y;else delete process.env.DEBUG}function fS(){return process.env.DEBUG}function yS(Y){Y.inspectOpts={};let X=Object.keys(h9.inspectOpts);for(let $=0;$<X.length;$++)Y.inspectOpts[X[$]]=h9.inspectOpts[X[$]]}PZ.exports=j4()(h9);var{formatters:v9}=PZ.exports;v9.o=function(Y){return this.inspectOpts.colors=this.useColors,SZ.inspect(Y,this.inspectOpts).split(`
`).map((X)=>X.trim()).join(" ")};v9.O=function(Y){return this.inspectOpts.colors=this.useColors,SZ.inspect(Y,this.inspectOpts)}});var xY=SY((_h,_4)=>{if(typeof process>"u"||process.type==="renderer"||!1||process.__nwjs)_4.exports=y9();else _4.exports=m9()});var k1={};wX(k1,{IsUndefined:()=>W1,IsUint8Array:()=>KX,IsSymbol:()=>VZ,IsString:()=>j0,IsRegExp:()=>T6,IsObject:()=>K0,IsNumber:()=>MY,IsNull:()=>EZ,IsIterator:()=>_Z,IsFunction:()=>jZ,IsDate:()=>q8,IsBoolean:()=>LX,IsBigInt:()=>I6,IsAsyncIterator:()=>RZ,IsArray:()=>Z1,HasPropertyKey:()=>o$});function o$(Y,X){return X in Y}function RZ(Y){return K0(Y)&&!Z1(Y)&&!KX(Y)&&Symbol.asyncIterator in Y}function Z1(Y){return Array.isArray(Y)}function I6(Y){return typeof Y==="bigint"}function LX(Y){return typeof Y==="boolean"}function q8(Y){return Y instanceof globalThis.Date}function jZ(Y){return typeof Y==="function"}function _Z(Y){return K0(Y)&&!Z1(Y)&&!KX(Y)&&Symbol.iterator in Y}function EZ(Y){return Y===null}function MY(Y){return typeof Y==="number"}function K0(Y){return typeof Y==="object"&&Y!==null}function T6(Y){return Y instanceof globalThis.RegExp}function j0(Y){return typeof Y==="string"}function VZ(Y){return typeof Y==="symbol"}function KX(Y){return Y instanceof globalThis.Uint8Array}function W1(Y){return Y===void 0}function FG(Y){return Y.map((X)=>t$(X))}function CG(Y){return new Date(Y.getTime())}function RG(Y){return new Uint8Array(Y)}function jG(Y){return new RegExp(Y.source,Y.flags)}function _G(Y){let X={};for(let $ of Object.getOwnPropertyNames(Y))X[$]=t$(Y[$]);for(let $ of Object.getOwnPropertySymbols(Y))X[$]=t$(Y[$]);return X}function t$(Y){return Z1(Y)?FG(Y):q8(Y)?CG(Y):KX(Y)?RG(Y):T6(Y)?jG(Y):K0(Y)?_G(Y):Y}function f0(Y){return t$(Y)}function f8(Y,X){return X===void 0?f0(Y):f0({...X,...Y})}function r$(Y){return t(Y)&&globalThis.Symbol.asyncIterator in Y}function s$(Y){return t(Y)&&globalThis.Symbol.iterator in Y}function IZ(Y){return t(Y)&&(globalThis.Object.getPrototypeOf(Y)===Object.prototype||globalThis.Object.getPrototypeOf(Y)===null)}function a$(Y){return Y instanceof globalThis.Promise}function d1(Y){return Y instanceof Date&&globalThis.Number.isFinite(Y.getTime())}function u4(Y){return Y instanceof globalThis.Map}function c4(Y){return Y instanceof globalThis.Set}function PY(Y){return globalThis.ArrayBuffer.isView(Y)}function y8(Y){return Y instanceof globalThis.Uint8Array}function o(Y,X){return X in Y}function t(Y){return Y!==null&&typeof Y==="object"}function i(Y){return globalThis.Array.isArray(Y)&&!globalThis.ArrayBuffer.isView(Y)}function y0(Y){return Y===void 0}function SX(Y){return Y===null}function MX(Y){return typeof Y==="boolean"}function p(Y){return typeof Y==="number"}function e$(Y){return globalThis.Number.isInteger(Y)}function I1(Y){return typeof Y==="bigint"}function M0(Y){return typeof Y==="string"}function nX(Y){return typeof Y==="function"}function PX(Y){return typeof Y==="symbol"}function NY(Y){return I1(Y)||MX(Y)||SX(Y)||p(Y)||M0(Y)||PX(Y)||y0(Y)}var x0;(function(Y){Y.InstanceMode="default",Y.ExactOptionalPropertyTypes=!1,Y.AllowArrayObject=!1,Y.AllowNaN=!1,Y.AllowNullVoid=!1;function X(J,M){return Y.ExactOptionalPropertyTypes?M in J:J[M]!==void 0}Y.IsExactOptionalProperty=X;function $(J){let M=t(J);return Y.AllowArrayObject?M:M&&!i(J)}Y.IsObjectLike=$;function Q(J){return $(J)&&!(J instanceof Date)&&!(J instanceof Uint8Array)}Y.IsRecordLike=Q;function Z(J){return Y.AllowNaN?p(J):Number.isFinite(J)}Y.IsNumberLike=Z;function W(J){let M=y0(J);return Y.AllowNullVoid?M||J===null:M}Y.IsVoidLike=W})(x0||(x0={}));function EG(Y){return globalThis.Object.freeze(Y).map((X)=>x6(X))}function VG(Y){return Y}function IG(Y){return Y}function TG(Y){return Y}function xG(Y){let X={};for(let $ of Object.getOwnPropertyNames(Y))X[$]=x6(Y[$]);for(let $ of Object.getOwnPropertySymbols(Y))X[$]=x6(Y[$]);return globalThis.Object.freeze(X)}function x6(Y){return Z1(Y)?EG(Y):q8(Y)?VG(Y):KX(Y)?IG(Y):T6(Y)?TG(Y):K0(Y)?xG(Y):Y}function I(Y,X){let $=X!==void 0?{...X,...Y}:Y;switch(x0.InstanceMode){case"freeze":return x6($);case"clone":return f0($);default:return $}}class n extends Error{constructor(Y){super(Y)}}var R0=Symbol.for("TypeBox.Transform"),kY=Symbol.for("TypeBox.Readonly"),H1=Symbol.for("TypeBox.Optional"),FY=Symbol.for("TypeBox.Hint"),S=Symbol.for("TypeBox.Kind");function v8(Y){return K0(Y)&&Y[kY]==="Readonly"}function n1(Y){return K0(Y)&&Y[H1]==="Optional"}function TZ(Y){return Q0(Y,"Any")}function xZ(Y){return Q0(Y,"Argument")}function fY(Y){return Q0(Y,"Array")}function O8(Y){return Q0(Y,"AsyncIterator")}function D8(Y){return Q0(Y,"BigInt")}function FX(Y){return Q0(Y,"Boolean")}function yY(Y){return Q0(Y,"Computed")}function vY(Y){return Q0(Y,"Constructor")}function bG(Y){return Q0(Y,"Date")}function hY(Y){return Q0(Y,"Function")}function dY(Y){return Q0(Y,"Integer")}function o0(Y){return Q0(Y,"Intersect")}function w8(Y){return Q0(Y,"Iterator")}function Q0(Y,X){return K0(Y)&&S in Y&&Y[S]===X}function YQ(Y){return LX(Y)||MY(Y)||j0(Y)}function GY(Y){return Q0(Y,"Literal")}function UY(Y){return Q0(Y,"MappedKey")}function v0(Y){return Q0(Y,"MappedResult")}function oX(Y){return Q0(Y,"Never")}function gG(Y){return Q0(Y,"Not")}function b6(Y){return Q0(Y,"Null")}function mY(Y){return Q0(Y,"Number")}function J1(Y){return Q0(Y,"Object")}function L8(Y){return Q0(Y,"Promise")}function K8(Y){return Q0(Y,"Record")}function X1(Y){return Q0(Y,"Ref")}function bZ(Y){return Q0(Y,"RegExp")}function CX(Y){return Q0(Y,"String")}function g6(Y){return Q0(Y,"Symbol")}function BY(Y){return Q0(Y,"TemplateLiteral")}function kG(Y){return Q0(Y,"This")}function H0(Y){return K0(Y)&&R0 in Y}function AY(Y){return Q0(Y,"Tuple")}function RX(Y){return Q0(Y,"Undefined")}function N0(Y){return Q0(Y,"Union")}function fG(Y){return Q0(Y,"Uint8Array")}function yG(Y){return Q0(Y,"Unknown")}function vG(Y){return Q0(Y,"Unsafe")}function hG(Y){return Q0(Y,"Void")}function tX(Y){return K0(Y)&&S in Y&&j0(Y[S])}function u0(Y){return TZ(Y)||xZ(Y)||fY(Y)||FX(Y)||D8(Y)||O8(Y)||yY(Y)||vY(Y)||bG(Y)||hY(Y)||dY(Y)||o0(Y)||w8(Y)||GY(Y)||UY(Y)||v0(Y)||oX(Y)||gG(Y)||b6(Y)||mY(Y)||J1(Y)||L8(Y)||K8(Y)||X1(Y)||bZ(Y)||CX(Y)||g6(Y)||BY(Y)||kG(Y)||AY(Y)||RX(Y)||N0(Y)||fG(Y)||yG(Y)||vG(Y)||hG(Y)||tX(Y)}var K={};wX(K,{TypeGuardUnknownTypeError:()=>p4,IsVoid:()=>T5,IsUnsafe:()=>I5,IsUnknown:()=>V5,IsUnionLiteral:()=>oG,IsUnion:()=>fZ,IsUndefined:()=>_5,IsUint8Array:()=>E5,IsTuple:()=>j5,IsTransform:()=>R5,IsThis:()=>C5,IsTemplateLiteral:()=>F5,IsSymbol:()=>P5,IsString:()=>S5,IsSchema:()=>h0,IsRegExp:()=>K5,IsRef:()=>L5,IsRecursive:()=>nG,IsRecord:()=>w5,IsReadonly:()=>cG,IsProperties:()=>XQ,IsPromise:()=>D5,IsOptional:()=>pG,IsObject:()=>O5,IsNumber:()=>q5,IsNull:()=>z5,IsNot:()=>H5,IsNever:()=>A5,IsMappedResult:()=>B5,IsMappedKey:()=>U5,IsLiteralValue:()=>G5,IsLiteralString:()=>M5,IsLiteralNumber:()=>N5,IsLiteralBoolean:()=>lG,IsLiteral:()=>f6,IsKindOf:()=>a,IsKind:()=>x5,IsIterator:()=>J5,IsIntersect:()=>W5,IsInteger:()=>Z5,IsImport:()=>iG,IsFunction:()=>Q5,IsDate:()=>$5,IsConstructor:()=>X5,IsComputed:()=>Y5,IsBoolean:()=>e4,IsBigInt:()=>a4,IsAsyncIterator:()=>s4,IsArray:()=>r4,IsArgument:()=>t4,IsAny:()=>o4});class p4 extends n{}var dG=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function i4(Y){try{return new RegExp(Y),!0}catch{return!1}}function gZ(Y){if(!j0(Y))return!1;for(let X=0;X<Y.length;X++){let $=Y.charCodeAt(X);if($>=7&&$<=13||$===27||$===127)return!1}return!0}function l4(Y){return kZ(Y)||h0(Y)}function k6(Y){return W1(Y)||I6(Y)}function _0(Y){return W1(Y)||MY(Y)}function kZ(Y){return W1(Y)||LX(Y)}function S0(Y){return W1(Y)||j0(Y)}function mG(Y){return W1(Y)||j0(Y)&&gZ(Y)&&i4(Y)}function uG(Y){return W1(Y)||j0(Y)&&gZ(Y)}function n4(Y){return W1(Y)||h0(Y)}function cG(Y){return K0(Y)&&Y[kY]==="Readonly"}function pG(Y){return K0(Y)&&Y[H1]==="Optional"}function o4(Y){return a(Y,"Any")&&S0(Y.$id)}function t4(Y){return a(Y,"Argument")&&MY(Y.index)}function r4(Y){return a(Y,"Array")&&Y.type==="array"&&S0(Y.$id)&&h0(Y.items)&&_0(Y.minItems)&&_0(Y.maxItems)&&kZ(Y.uniqueItems)&&n4(Y.contains)&&_0(Y.minContains)&&_0(Y.maxContains)}function s4(Y){return a(Y,"AsyncIterator")&&Y.type==="AsyncIterator"&&S0(Y.$id)&&h0(Y.items)}function a4(Y){return a(Y,"BigInt")&&Y.type==="bigint"&&S0(Y.$id)&&k6(Y.exclusiveMaximum)&&k6(Y.exclusiveMinimum)&&k6(Y.maximum)&&k6(Y.minimum)&&k6(Y.multipleOf)}function e4(Y){return a(Y,"Boolean")&&Y.type==="boolean"&&S0(Y.$id)}function Y5(Y){return a(Y,"Computed")&&j0(Y.target)&&Z1(Y.parameters)&&Y.parameters.every((X)=>h0(X))}function X5(Y){return a(Y,"Constructor")&&Y.type==="Constructor"&&S0(Y.$id)&&Z1(Y.parameters)&&Y.parameters.every((X)=>h0(X))&&h0(Y.returns)}function $5(Y){return a(Y,"Date")&&Y.type==="Date"&&S0(Y.$id)&&_0(Y.exclusiveMaximumTimestamp)&&_0(Y.exclusiveMinimumTimestamp)&&_0(Y.maximumTimestamp)&&_0(Y.minimumTimestamp)&&_0(Y.multipleOfTimestamp)}function Q5(Y){return a(Y,"Function")&&Y.type==="Function"&&S0(Y.$id)&&Z1(Y.parameters)&&Y.parameters.every((X)=>h0(X))&&h0(Y.returns)}function iG(Y){return a(Y,"Import")&&o$(Y,"$defs")&&K0(Y.$defs)&&XQ(Y.$defs)&&o$(Y,"$ref")&&j0(Y.$ref)&&Y.$ref in Y.$defs}function Z5(Y){return a(Y,"Integer")&&Y.type==="integer"&&S0(Y.$id)&&_0(Y.exclusiveMaximum)&&_0(Y.exclusiveMinimum)&&_0(Y.maximum)&&_0(Y.minimum)&&_0(Y.multipleOf)}function XQ(Y){return K0(Y)&&Object.entries(Y).every(([X,$])=>gZ(X)&&h0($))}function W5(Y){return a(Y,"Intersect")&&(j0(Y.type)&&Y.type!=="object"?!1:!0)&&Z1(Y.allOf)&&Y.allOf.every((X)=>h0(X)&&!R5(X))&&S0(Y.type)&&(kZ(Y.unevaluatedProperties)||n4(Y.unevaluatedProperties))&&S0(Y.$id)}function J5(Y){return a(Y,"Iterator")&&Y.type==="Iterator"&&S0(Y.$id)&&h0(Y.items)}function a(Y,X){return K0(Y)&&S in Y&&Y[S]===X}function M5(Y){return f6(Y)&&j0(Y.const)}function N5(Y){return f6(Y)&&MY(Y.const)}function lG(Y){return f6(Y)&&LX(Y.const)}function f6(Y){return a(Y,"Literal")&&S0(Y.$id)&&G5(Y.const)}function G5(Y){return LX(Y)||MY(Y)||j0(Y)}function U5(Y){return a(Y,"MappedKey")&&Z1(Y.keys)&&Y.keys.every((X)=>MY(X)||j0(X))}function B5(Y){return a(Y,"MappedResult")&&XQ(Y.properties)}function A5(Y){return a(Y,"Never")&&K0(Y.not)&&Object.getOwnPropertyNames(Y.not).length===0}function H5(Y){return a(Y,"Not")&&h0(Y.not)}function z5(Y){return a(Y,"Null")&&Y.type==="null"&&S0(Y.$id)}function q5(Y){return a(Y,"Number")&&Y.type==="number"&&S0(Y.$id)&&_0(Y.exclusiveMaximum)&&_0(Y.exclusiveMinimum)&&_0(Y.maximum)&&_0(Y.minimum)&&_0(Y.multipleOf)}function O5(Y){return a(Y,"Object")&&Y.type==="object"&&S0(Y.$id)&&XQ(Y.properties)&&l4(Y.additionalProperties)&&_0(Y.minProperties)&&_0(Y.maxProperties)}function D5(Y){return a(Y,"Promise")&&Y.type==="Promise"&&S0(Y.$id)&&h0(Y.item)}function w5(Y){return a(Y,"Record")&&Y.type==="object"&&S0(Y.$id)&&l4(Y.additionalProperties)&&K0(Y.patternProperties)&&((X)=>{let $=Object.getOwnPropertyNames(X.patternProperties);return $.length===1&&i4($[0])&&K0(X.patternProperties)&&h0(X.patternProperties[$[0]])})(Y)}function nG(Y){return K0(Y)&&FY in Y&&Y[FY]==="Recursive"}function L5(Y){return a(Y,"Ref")&&S0(Y.$id)&&j0(Y.$ref)}function K5(Y){return a(Y,"RegExp")&&S0(Y.$id)&&j0(Y.source)&&j0(Y.flags)&&_0(Y.maxLength)&&_0(Y.minLength)}function S5(Y){return a(Y,"String")&&Y.type==="string"&&S0(Y.$id)&&_0(Y.minLength)&&_0(Y.maxLength)&&mG(Y.pattern)&&uG(Y.format)}function P5(Y){return a(Y,"Symbol")&&Y.type==="symbol"&&S0(Y.$id)}function F5(Y){return a(Y,"TemplateLiteral")&&Y.type==="string"&&j0(Y.pattern)&&Y.pattern[0]==="^"&&Y.pattern[Y.pattern.length-1]==="$"}function C5(Y){return a(Y,"This")&&S0(Y.$id)&&j0(Y.$ref)}function R5(Y){return K0(Y)&&R0 in Y}function j5(Y){return a(Y,"Tuple")&&Y.type==="array"&&S0(Y.$id)&&MY(Y.minItems)&&MY(Y.maxItems)&&Y.minItems===Y.maxItems&&(W1(Y.items)&&W1(Y.additionalItems)&&Y.minItems===0||Z1(Y.items)&&Y.items.every((X)=>h0(X)))}function _5(Y){return a(Y,"Undefined")&&Y.type==="undefined"&&S0(Y.$id)}function oG(Y){return fZ(Y)&&Y.anyOf.every((X)=>M5(X)||N5(X))}function fZ(Y){return a(Y,"Union")&&S0(Y.$id)&&K0(Y)&&Z1(Y.anyOf)&&Y.anyOf.every((X)=>h0(X))}function E5(Y){return a(Y,"Uint8Array")&&Y.type==="Uint8Array"&&S0(Y.$id)&&_0(Y.minByteLength)&&_0(Y.maxByteLength)}function V5(Y){return a(Y,"Unknown")&&S0(Y.$id)}function I5(Y){return a(Y,"Unsafe")}function T5(Y){return a(Y,"Void")&&Y.type==="void"&&S0(Y.$id)}function x5(Y){return K0(Y)&&S in Y&&j0(Y[S])&&!dG.includes(Y[S])}function h0(Y){return K0(Y)&&(o4(Y)||t4(Y)||r4(Y)||e4(Y)||a4(Y)||s4(Y)||Y5(Y)||X5(Y)||$5(Y)||Q5(Y)||Z5(Y)||W5(Y)||J5(Y)||f6(Y)||U5(Y)||B5(Y)||A5(Y)||H5(Y)||z5(Y)||q5(Y)||O5(Y)||D5(Y)||w5(Y)||L5(Y)||K5(Y)||S5(Y)||P5(Y)||F5(Y)||C5(Y)||j5(Y)||_5(Y)||fZ(Y)||E5(Y)||V5(Y)||I5(Y)||T5(Y)||x5(Y))}var b5="(true|false)",$Q="(0|[1-9][0-9]*)",g5="(.*)";var rX="^(0|[1-9][0-9]*)$",sX="^(.*)$",k5="^(?!.*)$";var w0={};wX(w0,{Set:()=>eG,Has:()=>aG,Get:()=>Y2,Entries:()=>tG,Delete:()=>sG,Clear:()=>rG});var h8=new Map;function tG(){return new Map(h8)}function rG(){return h8.clear()}function sG(Y){return h8.delete(Y)}function aG(Y){return h8.has(Y)}function eG(Y,X){h8.set(Y,X)}function Y2(Y){return h8.get(Y)}var z1={};wX(z1,{Set:()=>W2,Has:()=>Z2,Get:()=>J2,Entries:()=>X2,Delete:()=>Q2,Clear:()=>$2});var d8=new Map;function X2(){return new Map(d8)}function $2(){return d8.clear()}function Q2(Y){return d8.delete(Y)}function Z2(Y){return d8.has(Y)}function W2(Y,X){d8.set(Y,X)}function J2(Y){return d8.get(Y)}function f5(Y,X){return Y.includes(X)}function y5(Y){return[...new Set(Y)]}function M2(Y,X){return Y.filter(($)=>X.includes($))}function N2(Y,X){return Y.reduce(($,Q)=>{return M2($,Q)},X)}function v5(Y){return Y.length===1?Y[0]:Y.length>1?N2(Y.slice(1),Y[0]):[]}function h5(Y){let X=[];for(let $ of Y)X.push(...$);return X}function aX(Y){return I({[S]:"Any"},Y)}function m8(Y,X){return I({[S]:"Array",type:"array",items:Y},X)}function d5(Y){return I({[S]:"Argument",index:Y})}function u8(Y,X){return I({[S]:"AsyncIterator",type:"AsyncIterator",items:Y},X)}function b0(Y,X,$){return I({[S]:"Computed",target:Y,parameters:X},$)}function G2(Y,X){let{[X]:$,...Q}=Y;return Q}function t0(Y,X){return X.reduce(($,Q)=>G2($,Q),Y)}function r(Y){return I({[S]:"Never",not:{}},Y)}function U0(Y){return I({[S]:"MappedResult",properties:Y})}function c8(Y,X,$){return I({[S]:"Constructor",type:"Constructor",parameters:Y,returns:X},$)}function NX(Y,X,$){return I({[S]:"Function",type:"Function",parameters:Y,returns:X},$)}function y6(Y,X){return I({[S]:"Union",anyOf:Y},X)}function U2(Y){return Y.some((X)=>n1(X))}function m5(Y){return Y.map((X)=>n1(X)?B2(X):X)}function B2(Y){return t0(Y,[H1])}function A2(Y,X){return U2(Y)?f1(y6(m5(Y),X)):y6(m5(Y),X)}function GX(Y,X){return Y.length===1?I(Y[0],X):Y.length===0?r(X):A2(Y,X)}function z0(Y,X){return Y.length===0?r(X):Y.length===1?I(Y[0],X):y6(Y,X)}class yZ extends n{}function H2(Y){return Y.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function vZ(Y,X,$){return Y[X]===$&&Y.charCodeAt(X-1)!==92}function _X(Y,X){return vZ(Y,X,"(")}function v6(Y,X){return vZ(Y,X,")")}function u5(Y,X){return vZ(Y,X,"|")}function z2(Y){if(!(_X(Y,0)&&v6(Y,Y.length-1)))return!1;let X=0;for(let $=0;$<Y.length;$++){if(_X(Y,$))X+=1;if(v6(Y,$))X-=1;if(X===0&&$!==Y.length-1)return!1}return!0}function q2(Y){return Y.slice(1,Y.length-1)}function O2(Y){let X=0;for(let $=0;$<Y.length;$++){if(_X(Y,$))X+=1;if(v6(Y,$))X-=1;if(u5(Y,$)&&X===0)return!0}return!1}function D2(Y){for(let X=0;X<Y.length;X++)if(_X(Y,X))return!0;return!1}function w2(Y){let[X,$]=[0,0],Q=[];for(let W=0;W<Y.length;W++){if(_X(Y,W))X+=1;if(v6(Y,W))X-=1;if(u5(Y,W)&&X===0){let J=Y.slice($,W);if(J.length>0)Q.push(p8(J));$=W+1}}let Z=Y.slice($);if(Z.length>0)Q.push(p8(Z));if(Q.length===0)return{type:"const",const:""};if(Q.length===1)return Q[0];return{type:"or",expr:Q}}function L2(Y){function X(Z,W){if(!_X(Z,W))throw new yZ("TemplateLiteralParser: Index must point to open parens");let J=0;for(let M=W;M<Z.length;M++){if(_X(Z,M))J+=1;if(v6(Z,M))J-=1;if(J===0)return[W,M]}throw new yZ("TemplateLiteralParser: Unclosed group parens in expression")}function $(Z,W){for(let J=W;J<Z.length;J++)if(_X(Z,J))return[W,J];return[W,Z.length]}let Q=[];for(let Z=0;Z<Y.length;Z++)if(_X(Y,Z)){let[W,J]=X(Y,Z),M=Y.slice(W,J+1);Q.push(p8(M)),Z=J}else{let[W,J]=$(Y,Z),M=Y.slice(W,J);if(M.length>0)Q.push(p8(M));Z=J-1}return Q.length===0?{type:"const",const:""}:Q.length===1?Q[0]:{type:"and",expr:Q}}function p8(Y){return z2(Y)?p8(q2(Y)):O2(Y)?w2(Y):D2(Y)?L2(Y):{type:"const",const:H2(Y)}}function i8(Y){return p8(Y.slice(1,Y.length-1))}class c5 extends n{}function K2(Y){return Y.type==="or"&&Y.expr.length===2&&Y.expr[0].type==="const"&&Y.expr[0].const==="0"&&Y.expr[1].type==="const"&&Y.expr[1].const==="[1-9][0-9]*"}function S2(Y){return Y.type==="or"&&Y.expr.length===2&&Y.expr[0].type==="const"&&Y.expr[0].const==="true"&&Y.expr[1].type==="const"&&Y.expr[1].const==="false"}function P2(Y){return Y.type==="const"&&Y.const===".*"}function S8(Y){return K2(Y)||P2(Y)?!1:S2(Y)?!0:Y.type==="and"?Y.expr.every((X)=>S8(X)):Y.type==="or"?Y.expr.every((X)=>S8(X)):Y.type==="const"?!0:(()=>{throw new c5("Unknown expression type")})()}function QQ(Y){let X=i8(Y.pattern);return S8(X)}class p5 extends n{}function*i5(Y){if(Y.length===1)return yield*Y[0];for(let X of Y[0])for(let $ of i5(Y.slice(1)))yield`${X}${$}`}function*F2(Y){return yield*i5(Y.expr.map((X)=>[...h6(X)]))}function*C2(Y){for(let X of Y.expr)yield*h6(X)}function*R2(Y){return yield Y.const}function*h6(Y){return Y.type==="and"?yield*F2(Y):Y.type==="or"?yield*C2(Y):Y.type==="const"?yield*R2(Y):(()=>{throw new p5("Unknown expression")})()}function l8(Y){let X=i8(Y.pattern);return S8(X)?[...h6(X)]:[]}function Z0(Y,X){return I({[S]:"Literal",const:Y,type:typeof Y},X)}function ZQ(Y){return I({[S]:"Boolean",type:"boolean"},Y)}function n8(Y){return I({[S]:"BigInt",type:"bigint"},Y)}function CY(Y){return I({[S]:"Number",type:"number"},Y)}function m1(Y){return I({[S]:"String",type:"string"},Y)}function*j2(Y){let X=Y.trim().replace(/"|'/g,"");return X==="boolean"?yield ZQ():X==="number"?yield CY():X==="bigint"?yield n8():X==="string"?yield m1():yield(()=>{let $=X.split("|").map((Q)=>Z0(Q.trim()));return $.length===0?r():$.length===1?$[0]:GX($)})()}function*_2(Y){if(Y[1]!=="{"){let X=Z0("$"),$=hZ(Y.slice(1));return yield*[X,...$]}for(let X=2;X<Y.length;X++)if(Y[X]==="}"){let $=j2(Y.slice(2,X)),Q=hZ(Y.slice(X+1));return yield*[...$,...Q]}yield Z0(Y)}function*hZ(Y){for(let X=0;X<Y.length;X++)if(Y[X]==="$"){let $=Z0(Y.slice(0,X)),Q=_2(Y.slice(X));return yield*[$,...Q]}yield Z0(Y)}function l5(Y){return[...hZ(Y)]}class n5 extends n{}function E2(Y){return Y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o5(Y,X){return BY(Y)?Y.pattern.slice(1,Y.pattern.length-1):N0(Y)?`(${Y.anyOf.map(($)=>o5($,X)).join("|")})`:mY(Y)?`${X}${$Q}`:dY(Y)?`${X}${$Q}`:D8(Y)?`${X}${$Q}`:CX(Y)?`${X}${g5}`:GY(Y)?`${X}${E2(Y.const.toString())}`:FX(Y)?`${X}${b5}`:(()=>{throw new n5(`Unexpected Kind '${Y[S]}'`)})()}function dZ(Y){return`^${Y.map((X)=>o5(X,"")).join("")}$`}function P8(Y){let $=l8(Y).map((Q)=>Z0(Q));return GX($)}function WQ(Y,X){let $=j0(Y)?dZ(l5(Y)):dZ(Y);return I({[S]:"TemplateLiteral",type:"string",pattern:$},X)}function V2(Y){return l8(Y).map(($)=>$.toString())}function I2(Y){let X=[];for(let $ of Y)X.push(...o1($));return X}function T2(Y){return[Y.toString()]}function o1(Y){return[...new Set(BY(Y)?V2(Y):N0(Y)?I2(Y.anyOf):GY(Y)?T2(Y.const):mY(Y)?["[number]"]:dY(Y)?["[number]"]:[])]}function x2(Y,X,$){let Q={};for(let Z of Object.getOwnPropertyNames(X))Q[Z]=eX(Y,o1(X[Z]),$);return Q}function b2(Y,X,$){return x2(Y,X.properties,$)}function t5(Y,X,$){let Q=b2(Y,X,$);return U0(Q)}function s5(Y,X){return Y.map(($)=>a5($,X))}function g2(Y){return Y.filter((X)=>!oX(X))}function k2(Y,X){return JQ(g2(s5(Y,X)))}function f2(Y){return Y.some((X)=>oX(X))?[]:Y}function y2(Y,X){return GX(f2(s5(Y,X)))}function v2(Y,X){return X in Y?Y[X]:X==="[number]"?GX(Y):r()}function h2(Y,X){return X==="[number]"?Y:r()}function d2(Y,X){return X in Y?Y[X]:r()}function a5(Y,X){return o0(Y)?k2(Y.allOf,X):N0(Y)?y2(Y.anyOf,X):AY(Y)?v2(Y.items??[],X):fY(Y)?h2(Y.items,X):J1(Y)?d2(Y.properties,X):r()}function d6(Y,X){return X.map(($)=>a5(Y,$))}function r5(Y,X){return GX(d6(Y,X))}function eX(Y,X,$){if(X1(Y)||X1(X)){if(!u0(Y)||!u0(X))throw new n("Index types using Ref parameters require both Type and Key to be of TSchema");return b0("Index",[Y,X])}if(v0(X))return t5(Y,X,$);if(UY(X))return e5(Y,X,$);return I(u0(X)?r5(Y,o1(X)):r5(Y,X),$)}function m2(Y,X,$){return{[X]:eX(Y,[X],f0($))}}function u2(Y,X,$){return X.reduce((Q,Z)=>{return{...Q,...m2(Y,Z,$)}},{})}function c2(Y,X,$){return u2(Y,X.keys,$)}function e5(Y,X,$){let Q=c2(Y,X,$);return U0(Q)}function o8(Y,X){return I({[S]:"Iterator",type:"Iterator",items:Y},X)}function p2(Y){let X=[];for(let $ in Y)if(!n1(Y[$]))X.push($);return X}function i2(Y,X){let $=p2(Y),Q=$.length>0?{[S]:"Object",type:"object",properties:Y,required:$}:{[S]:"Object",type:"object",properties:Y};return I(Q,X)}var q0=i2;function MQ(Y,X){return I({[S]:"Promise",type:"Promise",item:Y},X)}function l2(Y){return I(t0(Y,[kY]))}function n2(Y){return I({...Y,[kY]:"Readonly"})}function o2(Y,X){return X===!1?l2(Y):n2(Y)}function t1(Y,X){let $=X??!0;return v0(Y)?YJ(Y,$):o2(Y,$)}function t2(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=t1(Y[Q],X);return $}function r2(Y,X){return t2(Y.properties,X)}function YJ(Y,X){let $=r2(Y,X);return U0($)}function RY(Y,X){return I(Y.length>0?{[S]:"Tuple",type:"array",items:Y,additionalItems:!1,minItems:Y.length,maxItems:Y.length}:{[S]:"Tuple",type:"array",minItems:Y.length,maxItems:Y.length},X)}function XJ(Y,X){return Y in X?jY(Y,X[Y]):U0(X)}function s2(Y){return{[Y]:Z0(Y)}}function a2(Y){let X={};for(let $ of Y)X[$]=Z0($);return X}function e2(Y,X){return f5(X,Y)?s2(Y):a2(X)}function YU(Y,X){let $=e2(Y,X);return XJ(Y,$)}function m6(Y,X){return X.map(($)=>jY(Y,$))}function XU(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(X))$[Q]=jY(Y,X[Q]);return $}function jY(Y,X){let $={...X};return n1(X)?f1(jY(Y,t0(X,[H1]))):v8(X)?t1(jY(Y,t0(X,[kY]))):v0(X)?XJ(Y,X.properties):UY(X)?YU(Y,X.keys):vY(X)?c8(m6(Y,X.parameters),jY(Y,X.returns),$):hY(X)?NX(m6(Y,X.parameters),jY(Y,X.returns),$):O8(X)?u8(jY(Y,X.items),$):w8(X)?o8(jY(Y,X.items),$):o0(X)?y1(m6(Y,X.allOf),$):N0(X)?z0(m6(Y,X.anyOf),$):AY(X)?RY(m6(Y,X.items??[]),$):J1(X)?q0(XU(Y,X.properties),$):fY(X)?m8(jY(Y,X.items),$):L8(X)?MQ(jY(Y,X.item),$):X}function $U(Y,X){let $={};for(let Q of Y)$[Q]=jY(Q,X);return $}function $J(Y,X,$){let Q=u0(Y)?o1(Y):Y,Z=X({[S]:"MappedKey",keys:Q}),W=$U(Q,Z);return q0(W,$)}function QU(Y){return I(t0(Y,[H1]))}function ZU(Y){return I({...Y,[H1]:"Optional"})}function WU(Y,X){return X===!1?QU(Y):ZU(Y)}function f1(Y,X){let $=X??!0;return v0(Y)?QJ(Y,$):WU(Y,$)}function JU(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=f1(Y[Q],X);return $}function MU(Y,X){return JU(Y.properties,X)}function QJ(Y,X){let $=MU(Y,X);return U0($)}function u6(Y,X={}){let $=Y.every((Z)=>J1(Z)),Q=u0(X.unevaluatedProperties)?{unevaluatedProperties:X.unevaluatedProperties}:{};return I(X.unevaluatedProperties===!1||u0(X.unevaluatedProperties)||$?{...Q,[S]:"Intersect",type:"object",allOf:Y}:{...Q,[S]:"Intersect",allOf:Y},X)}function NU(Y){return Y.every((X)=>n1(X))}function GU(Y){return t0(Y,[H1])}function ZJ(Y){return Y.map((X)=>n1(X)?GU(X):X)}function UU(Y,X){return NU(Y)?f1(u6(ZJ(Y),X)):u6(ZJ(Y),X)}function JQ(Y,X={}){if(Y.length===1)return I(Y[0],X);if(Y.length===0)return r(X);if(Y.some(($)=>H0($)))throw Error("Cannot intersect transform types");return UU(Y,X)}function y1(Y,X){if(Y.length===1)return I(Y[0],X);if(Y.length===0)return r(X);if(Y.some(($)=>H0($)))throw Error("Cannot intersect transform types");return u6(Y,X)}function _Y(...Y){let[X,$]=typeof Y[0]==="string"?[Y[0],Y[1]]:[Y[0].$id,Y[1]];if(typeof X!=="string")throw new n("Ref: $ref must be a string");return I({[S]:"Ref",$ref:X},$)}function BU(Y,X){return b0("Awaited",[b0(Y,X)])}function AU(Y){return b0("Awaited",[_Y(Y)])}function HU(Y){return y1(WJ(Y))}function zU(Y){return z0(WJ(Y))}function qU(Y){return t8(Y)}function WJ(Y){return Y.map((X)=>t8(X))}function t8(Y,X){return I(yY(Y)?BU(Y.target,Y.parameters):o0(Y)?HU(Y.allOf):N0(Y)?zU(Y.anyOf):L8(Y)?qU(Y.item):X1(Y)?AU(Y.$ref):Y,X)}function JJ(Y){let X=[];for(let $ of Y)X.push(r1($));return X}function OU(Y){let X=JJ(Y);return h5(X)}function DU(Y){let X=JJ(Y);return v5(X)}function wU(Y){return Y.map((X,$)=>$.toString())}function LU(Y){return["[number]"]}function KU(Y){return globalThis.Object.getOwnPropertyNames(Y)}function SU(Y){if(!mZ)return[];return globalThis.Object.getOwnPropertyNames(Y).map(($)=>{return $[0]==="^"&&$[$.length-1]==="$"?$.slice(1,$.length-1):$})}function r1(Y){return o0(Y)?OU(Y.allOf):N0(Y)?DU(Y.anyOf):AY(Y)?wU(Y.items??[]):fY(Y)?LU(Y.items):J1(Y)?KU(Y.properties):K8(Y)?SU(Y.patternProperties):[]}var mZ=!1;function EX(Y){mZ=!0;let X=r1(Y);return mZ=!1,`^(${X.map((Q)=>`(${Q})`).join("|")})$`}function PU(Y,X){return b0("KeyOf",[b0(Y,X)])}function FU(Y){return b0("KeyOf",[_Y(Y)])}function CU(Y,X){let $=r1(Y),Q=RU($),Z=GX(Q);return I(Z,X)}function RU(Y){return Y.map((X)=>X==="[number]"?CY():Z0(X))}function r8(Y,X){return yY(Y)?PU(Y.target,Y.parameters):X1(Y)?FU(Y.$ref):v0(Y)?MJ(Y,X):CU(Y,X)}function jU(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=r8(Y[Q],f0(X));return $}function _U(Y,X){return jU(Y.properties,X)}function MJ(Y,X){let $=_U(Y,X);return U0($)}function NQ(Y){let X=r1(Y),$=d6(Y,X);return X.map((Q,Z)=>[X[Z],$[Z]])}function EU(Y){let X=[];for(let $ of Y)X.push(...r1($));return y5(X)}function VU(Y){return Y.filter((X)=>!oX(X))}function IU(Y,X){let $=[];for(let Q of Y)$.push(...d6(Q,[X]));return VU($)}function TU(Y,X){let $={};for(let Q of X)$[Q]=JQ(IU(Y,Q));return $}function NJ(Y,X){let $=EU(Y),Q=TU(Y,$);return q0(Q,X)}function GQ(Y){return I({[S]:"Date",type:"Date"},Y)}function UQ(Y){return I({[S]:"Null",type:"null"},Y)}function BQ(Y){return I({[S]:"Symbol",type:"symbol"},Y)}function AQ(Y){return I({[S]:"Undefined",type:"undefined"},Y)}function HQ(Y){return I({[S]:"Uint8Array",type:"Uint8Array"},Y)}function uY(Y){return I({[S]:"Unknown"},Y)}function xU(Y){return Y.map((X)=>uZ(X,!1))}function bU(Y){let X={};for(let $ of globalThis.Object.getOwnPropertyNames(Y))X[$]=t1(uZ(Y[$],!1));return X}function zQ(Y,X){return X===!0?Y:t1(Y)}function uZ(Y,X){return RZ(Y)?zQ(aX(),X):_Z(Y)?zQ(aX(),X):Z1(Y)?t1(RY(xU(Y))):KX(Y)?HQ():q8(Y)?GQ():K0(Y)?zQ(q0(bU(Y)),X):jZ(Y)?zQ(NX([],uY()),X):W1(Y)?AQ():EZ(Y)?UQ():VZ(Y)?BQ():I6(Y)?n8():MY(Y)?Z0(Y):LX(Y)?Z0(Y):j0(Y)?Z0(Y):q0({})}function GJ(Y,X){return I(uZ(Y,!0),X)}function UJ(Y,X){return vY(Y)?RY(Y.parameters,X):r(X)}function BJ(Y,X){if(W1(Y))throw Error("Enum undefined or empty");let $=globalThis.Object.getOwnPropertyNames(Y).filter((W)=>isNaN(W)).map((W)=>Y[W]),Z=[...new Set($)].map((W)=>Z0(W));return z0(Z,{...X,[FY]:"Enum"})}class OJ extends n{}var T;(function(Y){Y[Y.Union=0]="Union",Y[Y.True=1]="True",Y[Y.False=2]="False"})(T||(T={}));function EY(Y){return Y===T.False?Y:T.True}function s8(Y){throw new OJ(Y)}function G1(Y){return K.IsNever(Y)||K.IsIntersect(Y)||K.IsUnion(Y)||K.IsUnknown(Y)||K.IsAny(Y)}function U1(Y,X){return K.IsNever(X)?LJ(Y,X):K.IsIntersect(X)?qQ(Y,X):K.IsUnion(X)?nZ(Y,X):K.IsUnknown(X)?FJ(Y,X):K.IsAny(X)?lZ(Y,X):s8("StructuralRight")}function lZ(Y,X){return T.True}function gU(Y,X){return K.IsIntersect(X)?qQ(Y,X):K.IsUnion(X)&&X.anyOf.some(($)=>K.IsAny($)||K.IsUnknown($))?T.True:K.IsUnion(X)?T.Union:K.IsUnknown(X)?T.True:K.IsAny(X)?T.True:T.Union}function kU(Y,X){return K.IsUnknown(Y)?T.False:K.IsAny(Y)?T.Union:K.IsNever(Y)?T.True:T.False}function fU(Y,X){return K.IsObject(X)&&OQ(X)?T.True:G1(X)?U1(Y,X):!K.IsArray(X)?T.False:EY(P0(Y.items,X.items))}function yU(Y,X){return G1(X)?U1(Y,X):!K.IsAsyncIterator(X)?T.False:EY(P0(Y.items,X.items))}function vU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsBigInt(X)?T.True:T.False}function DJ(Y,X){return K.IsLiteralBoolean(Y)?T.True:K.IsBoolean(Y)?T.True:T.False}function hU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsBoolean(X)?T.True:T.False}function dU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):!K.IsConstructor(X)?T.False:Y.parameters.length>X.parameters.length?T.False:!Y.parameters.every(($,Q)=>EY(P0(X.parameters[Q],$))===T.True)?T.False:EY(P0(Y.returns,X.returns))}function mU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsDate(X)?T.True:T.False}function uU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):!K.IsFunction(X)?T.False:Y.parameters.length>X.parameters.length?T.False:!Y.parameters.every(($,Q)=>EY(P0(X.parameters[Q],$))===T.True)?T.False:EY(P0(Y.returns,X.returns))}function wJ(Y,X){return K.IsLiteral(Y)&&k1.IsNumber(Y.const)?T.True:K.IsNumber(Y)||K.IsInteger(Y)?T.True:T.False}function cU(Y,X){return K.IsInteger(X)||K.IsNumber(X)?T.True:G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):T.False}function qQ(Y,X){return X.allOf.every(($)=>P0(Y,$)===T.True)?T.True:T.False}function pU(Y,X){return Y.allOf.some(($)=>P0($,X)===T.True)?T.True:T.False}function iU(Y,X){return G1(X)?U1(Y,X):!K.IsIterator(X)?T.False:EY(P0(Y.items,X.items))}function lU(Y,X){return K.IsLiteral(X)&&X.const===Y.const?T.True:G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsString(X)?PJ(Y,X):K.IsNumber(X)?KJ(Y,X):K.IsInteger(X)?wJ(Y,X):K.IsBoolean(X)?DJ(Y,X):T.False}function LJ(Y,X){return T.False}function nU(Y,X){return T.True}function AJ(Y){let[X,$]=[Y,0];while(!0){if(!K.IsNot(X))break;X=X.not,$+=1}return $%2===0?X:uY()}function oU(Y,X){return K.IsNot(Y)?P0(AJ(Y),X):K.IsNot(X)?P0(Y,AJ(X)):s8("Invalid fallthrough for Not")}function tU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsNull(X)?T.True:T.False}function KJ(Y,X){return K.IsLiteralNumber(Y)?T.True:K.IsNumber(Y)||K.IsInteger(Y)?T.True:T.False}function rU(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsInteger(X)||K.IsNumber(X)?T.True:T.False}function s1(Y,X){return Object.getOwnPropertyNames(Y.properties).length===X}function HJ(Y){return OQ(Y)}function zJ(Y){return s1(Y,0)||s1(Y,1)&&"description"in Y.properties&&K.IsUnion(Y.properties.description)&&Y.properties.description.anyOf.length===2&&(K.IsString(Y.properties.description.anyOf[0])&&K.IsUndefined(Y.properties.description.anyOf[1])||K.IsString(Y.properties.description.anyOf[1])&&K.IsUndefined(Y.properties.description.anyOf[0]))}function cZ(Y){return s1(Y,0)}function qJ(Y){return s1(Y,0)}function sU(Y){return s1(Y,0)}function aU(Y){return s1(Y,0)}function eU(Y){return OQ(Y)}function YB(Y){let X=CY();return s1(Y,0)||s1(Y,1)&&"length"in Y.properties&&EY(P0(Y.properties.length,X))===T.True}function XB(Y){return s1(Y,0)}function OQ(Y){let X=CY();return s1(Y,0)||s1(Y,1)&&"length"in Y.properties&&EY(P0(Y.properties.length,X))===T.True}function $B(Y){let X=NX([aX()],aX());return s1(Y,0)||s1(Y,1)&&"then"in Y.properties&&EY(P0(Y.properties.then,X))===T.True}function SJ(Y,X){return P0(Y,X)===T.False?T.False:K.IsOptional(Y)&&!K.IsOptional(X)?T.False:T.True}function v1(Y,X){return K.IsUnknown(Y)?T.False:K.IsAny(Y)?T.Union:K.IsNever(Y)||K.IsLiteralString(Y)&&HJ(X)||K.IsLiteralNumber(Y)&&cZ(X)||K.IsLiteralBoolean(Y)&&qJ(X)||K.IsSymbol(Y)&&zJ(X)||K.IsBigInt(Y)&&sU(X)||K.IsString(Y)&&HJ(X)||K.IsSymbol(Y)&&zJ(X)||K.IsNumber(Y)&&cZ(X)||K.IsInteger(Y)&&cZ(X)||K.IsBoolean(Y)&&qJ(X)||K.IsUint8Array(Y)&&eU(X)||K.IsDate(Y)&&aU(X)||K.IsConstructor(Y)&&XB(X)||K.IsFunction(Y)&&YB(X)?T.True:K.IsRecord(Y)&&K.IsString(pZ(Y))?(()=>{return X[FY]==="Record"?T.True:T.False})():K.IsRecord(Y)&&K.IsNumber(pZ(Y))?(()=>{return s1(X,0)?T.True:T.False})():T.False}function QB(Y,X){return G1(X)?U1(Y,X):K.IsRecord(X)?VY(Y,X):!K.IsObject(X)?T.False:(()=>{for(let $ of Object.getOwnPropertyNames(X.properties)){if(!($ in Y.properties)&&!K.IsOptional(X.properties[$]))return T.False;if(K.IsOptional(X.properties[$]))return T.True;if(SJ(Y.properties[$],X.properties[$])===T.False)return T.False}return T.True})()}function ZB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)&&$B(X)?T.True:!K.IsPromise(X)?T.False:EY(P0(Y.item,X.item))}function pZ(Y){return rX in Y.patternProperties?CY():(sX in Y.patternProperties)?m1():s8("Unknown record key pattern")}function iZ(Y){return rX in Y.patternProperties?Y.patternProperties[rX]:(sX in Y.patternProperties)?Y.patternProperties[sX]:s8("Unable to get record value schema")}function VY(Y,X){let[$,Q]=[pZ(X),iZ(X)];return K.IsLiteralString(Y)&&K.IsNumber($)&&EY(P0(Y,Q))===T.True?T.True:K.IsUint8Array(Y)&&K.IsNumber($)?P0(Y,Q):K.IsString(Y)&&K.IsNumber($)?P0(Y,Q):K.IsArray(Y)&&K.IsNumber($)?P0(Y,Q):K.IsObject(Y)?(()=>{for(let Z of Object.getOwnPropertyNames(Y.properties))if(SJ(Q,Y.properties[Z])===T.False)return T.False;return T.True})():T.False}function WB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):!K.IsRecord(X)?T.False:P0(iZ(Y),iZ(X))}function JB(Y,X){let $=K.IsRegExp(Y)?m1():Y,Q=K.IsRegExp(X)?m1():X;return P0($,Q)}function PJ(Y,X){return K.IsLiteral(Y)&&k1.IsString(Y.const)?T.True:K.IsString(Y)?T.True:T.False}function MB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsString(X)?T.True:T.False}function NB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsSymbol(X)?T.True:T.False}function GB(Y,X){return K.IsTemplateLiteral(Y)?P0(P8(Y),X):K.IsTemplateLiteral(X)?P0(Y,P8(X)):s8("Invalid fallthrough for TemplateLiteral")}function UB(Y,X){return K.IsArray(X)&&Y.items!==void 0&&Y.items.every(($)=>P0($,X.items)===T.True)}function BB(Y,X){return K.IsNever(Y)?T.True:K.IsUnknown(Y)?T.False:K.IsAny(Y)?T.Union:T.False}function AB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)&&OQ(X)?T.True:K.IsArray(X)&&UB(Y,X)?T.True:!K.IsTuple(X)?T.False:k1.IsUndefined(Y.items)&&!k1.IsUndefined(X.items)||!k1.IsUndefined(Y.items)&&k1.IsUndefined(X.items)?T.False:k1.IsUndefined(Y.items)&&!k1.IsUndefined(X.items)?T.True:Y.items.every(($,Q)=>P0($,X.items[Q])===T.True)?T.True:T.False}function HB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsUint8Array(X)?T.True:T.False}function zB(Y,X){return G1(X)?U1(Y,X):K.IsObject(X)?v1(Y,X):K.IsRecord(X)?VY(Y,X):K.IsVoid(X)?DB(Y,X):K.IsUndefined(X)?T.True:T.False}function nZ(Y,X){return X.anyOf.some(($)=>P0(Y,$)===T.True)?T.True:T.False}function qB(Y,X){return Y.anyOf.every(($)=>P0($,X)===T.True)?T.True:T.False}function FJ(Y,X){return T.True}function OB(Y,X){return K.IsNever(X)?LJ(Y,X):K.IsIntersect(X)?qQ(Y,X):K.IsUnion(X)?nZ(Y,X):K.IsAny(X)?lZ(Y,X):K.IsString(X)?PJ(Y,X):K.IsNumber(X)?KJ(Y,X):K.IsInteger(X)?wJ(Y,X):K.IsBoolean(X)?DJ(Y,X):K.IsArray(X)?kU(Y,X):K.IsTuple(X)?BB(Y,X):K.IsObject(X)?v1(Y,X):K.IsUnknown(X)?T.True:T.False}function DB(Y,X){return K.IsUndefined(Y)?T.True:K.IsUndefined(Y)?T.True:T.False}function wB(Y,X){return K.IsIntersect(X)?qQ(Y,X):K.IsUnion(X)?nZ(Y,X):K.IsUnknown(X)?FJ(Y,X):K.IsAny(X)?lZ(Y,X):K.IsObject(X)?v1(Y,X):K.IsVoid(X)?T.True:T.False}function P0(Y,X){return K.IsTemplateLiteral(Y)||K.IsTemplateLiteral(X)?GB(Y,X):K.IsRegExp(Y)||K.IsRegExp(X)?JB(Y,X):K.IsNot(Y)||K.IsNot(X)?oU(Y,X):K.IsAny(Y)?gU(Y,X):K.IsArray(Y)?fU(Y,X):K.IsBigInt(Y)?vU(Y,X):K.IsBoolean(Y)?hU(Y,X):K.IsAsyncIterator(Y)?yU(Y,X):K.IsConstructor(Y)?dU(Y,X):K.IsDate(Y)?mU(Y,X):K.IsFunction(Y)?uU(Y,X):K.IsInteger(Y)?cU(Y,X):K.IsIntersect(Y)?pU(Y,X):K.IsIterator(Y)?iU(Y,X):K.IsLiteral(Y)?lU(Y,X):K.IsNever(Y)?nU(Y,X):K.IsNull(Y)?tU(Y,X):K.IsNumber(Y)?rU(Y,X):K.IsObject(Y)?QB(Y,X):K.IsRecord(Y)?WB(Y,X):K.IsString(Y)?MB(Y,X):K.IsSymbol(Y)?NB(Y,X):K.IsTuple(Y)?AB(Y,X):K.IsPromise(Y)?ZB(Y,X):K.IsUint8Array(Y)?HB(Y,X):K.IsUndefined(Y)?zB(Y,X):K.IsUnion(Y)?qB(Y,X):K.IsUnknown(Y)?OB(Y,X):K.IsVoid(Y)?wB(Y,X):s8(`Unknown left type operand '${Y[S]}'`)}function Y8(Y,X){return P0(Y,X)}function LB(Y,X,$,Q,Z){let W={};for(let J of globalThis.Object.getOwnPropertyNames(Y))W[J]=a8(Y[J],X,$,Q,f0(Z));return W}function KB(Y,X,$,Q,Z){return LB(Y.properties,X,$,Q,Z)}function CJ(Y,X,$,Q,Z){let W=KB(Y,X,$,Q,Z);return U0(W)}function SB(Y,X,$,Q){let Z=Y8(Y,X);return Z===T.Union?z0([$,Q]):Z===T.True?$:Q}function a8(Y,X,$,Q,Z){return v0(Y)?CJ(Y,X,$,Q,Z):UY(Y)?I(RJ(Y,X,$,Q,Z)):I(SB(Y,X,$,Q),Z)}function PB(Y,X,$,Q,Z){return{[Y]:a8(Z0(Y),X,$,Q,f0(Z))}}function FB(Y,X,$,Q,Z){return Y.reduce((W,J)=>{return{...W,...PB(J,X,$,Q,Z)}},{})}function CB(Y,X,$,Q,Z){return FB(Y.keys,X,$,Q,Z)}function RJ(Y,X,$,Q,Z){let W=CB(Y,X,$,Q,Z);return U0(W)}function RB(Y){return Y.allOf.every((X)=>VX(X))}function jB(Y){return Y.anyOf.some((X)=>VX(X))}function _B(Y){return!VX(Y.not)}function VX(Y){return Y[S]==="Intersect"?RB(Y):Y[S]==="Union"?jB(Y):Y[S]==="Not"?_B(Y):Y[S]==="Undefined"?!0:!1}function jJ(Y,X){return e8(P8(Y),X)}function EB(Y,X){let $=Y.filter((Q)=>Y8(Q,X)===T.False);return $.length===1?$[0]:z0($)}function e8(Y,X,$={}){if(BY(Y))return I(jJ(Y,X),$);if(v0(Y))return I(_J(Y,X),$);return I(N0(Y)?EB(Y.anyOf,X):Y8(Y,X)!==T.False?r():Y,$)}function VB(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=e8(Y[Q],X);return $}function IB(Y,X){return VB(Y.properties,X)}function _J(Y,X){let $=IB(Y,X);return U0($)}function EJ(Y,X){return Y6(P8(Y),X)}function TB(Y,X){let $=Y.filter((Q)=>Y8(Q,X)!==T.False);return $.length===1?$[0]:z0($)}function Y6(Y,X,$){if(BY(Y))return I(EJ(Y,X),$);if(v0(Y))return I(VJ(Y,X),$);return I(N0(Y)?TB(Y.anyOf,X):Y8(Y,X)!==T.False?Y:r(),$)}function xB(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=Y6(Y[Q],X);return $}function bB(Y,X){return xB(Y.properties,X)}function VJ(Y,X){let $=bB(Y,X);return U0($)}function IJ(Y,X){return vY(Y)?I(Y.returns,X):r(X)}function DQ(Y){return t1(f1(Y))}function F8(Y,X,$){return I({[S]:"Record",type:"object",patternProperties:{[Y]:X}},$)}function oZ(Y,X,$){let Q={};for(let Z of Y)Q[Z]=X;return q0(Q,{...$,[FY]:"Record"})}function gB(Y,X,$){return QQ(Y)?oZ(o1(Y),X,$):F8(Y.pattern,X,$)}function kB(Y,X,$){return oZ(o1(z0(Y)),X,$)}function fB(Y,X,$){return oZ([Y.toString()],X,$)}function yB(Y,X,$){return F8(Y.source,X,$)}function vB(Y,X,$){let Q=W1(Y.pattern)?sX:Y.pattern;return F8(Q,X,$)}function hB(Y,X,$){return F8(sX,X,$)}function dB(Y,X,$){return F8(k5,X,$)}function mB(Y,X,$){return q0({true:X,false:X},$)}function uB(Y,X,$){return F8(rX,X,$)}function cB(Y,X,$){return F8(rX,X,$)}function wQ(Y,X,$={}){return N0(Y)?kB(Y.anyOf,X,$):BY(Y)?gB(Y,X,$):GY(Y)?fB(Y.const,X,$):FX(Y)?mB(Y,X,$):dY(Y)?uB(Y,X,$):mY(Y)?cB(Y,X,$):bZ(Y)?yB(Y,X,$):CX(Y)?vB(Y,X,$):TZ(Y)?hB(Y,X,$):oX(Y)?dB(Y,X,$):r($)}function LQ(Y){return globalThis.Object.getOwnPropertyNames(Y.patternProperties)[0]}function TJ(Y){let X=LQ(Y);return X===sX?m1():X===rX?CY():m1({pattern:X})}function KQ(Y){return Y.patternProperties[LQ(Y)]}function pB(Y,X){return X.parameters=c6(Y,X.parameters),X.returns=cY(Y,X.returns),X}function iB(Y,X){return X.parameters=c6(Y,X.parameters),X.returns=cY(Y,X.returns),X}function lB(Y,X){return X.allOf=c6(Y,X.allOf),X}function nB(Y,X){return X.anyOf=c6(Y,X.anyOf),X}function oB(Y,X){if(W1(X.items))return X;return X.items=c6(Y,X.items),X}function tB(Y,X){return X.items=cY(Y,X.items),X}function rB(Y,X){return X.items=cY(Y,X.items),X}function sB(Y,X){return X.items=cY(Y,X.items),X}function aB(Y,X){return X.item=cY(Y,X.item),X}function eB(Y,X){let $=QA(Y,X.properties);return{...X,...q0($)}}function YA(Y,X){let $=cY(Y,TJ(X)),Q=cY(Y,KQ(X)),Z=wQ($,Q);return{...X,...Z}}function XA(Y,X){return X.index in Y?Y[X.index]:uY()}function $A(Y,X){let $=v8(X),Q=n1(X),Z=cY(Y,X);return $&&Q?DQ(Z):$&&!Q?t1(Z):!$&&Q?f1(Z):Z}function QA(Y,X){return globalThis.Object.getOwnPropertyNames(X).reduce(($,Q)=>{return{...$,[Q]:$A(Y,X[Q])}},{})}function c6(Y,X){return X.map(($)=>cY(Y,$))}function cY(Y,X){return vY(X)?pB(Y,X):hY(X)?iB(Y,X):o0(X)?lB(Y,X):N0(X)?nB(Y,X):AY(X)?oB(Y,X):fY(X)?tB(Y,X):O8(X)?rB(Y,X):w8(X)?sB(Y,X):L8(X)?aB(Y,X):J1(X)?eB(Y,X):K8(X)?YA(Y,X):xZ(X)?XA(Y,X):X}function xJ(Y,X){return cY(X,f8(Y))}function bJ(Y){return I({[S]:"Integer",type:"integer"},Y)}function ZA(Y,X,$){return{[Y]:pY(Z0(Y),X,f0($))}}function WA(Y,X,$){return Y.reduce((Z,W)=>{return{...Z,...ZA(W,X,$)}},{})}function JA(Y,X,$){return WA(Y.keys,X,$)}function gJ(Y,X,$){let Q=JA(Y,X,$);return U0(Q)}function MA(Y){let[X,$]=[Y.slice(0,1),Y.slice(1)];return[X.toLowerCase(),$].join("")}function NA(Y){let[X,$]=[Y.slice(0,1),Y.slice(1)];return[X.toUpperCase(),$].join("")}function GA(Y){return Y.toUpperCase()}function UA(Y){return Y.toLowerCase()}function BA(Y,X,$){let Q=i8(Y.pattern);if(!S8(Q))return{...Y,pattern:kJ(Y.pattern,X)};let J=[...h6(Q)].map((U)=>Z0(U)),M=fJ(J,X),N=z0(M);return WQ([N],$)}function kJ(Y,X){return typeof Y==="string"?X==="Uncapitalize"?MA(Y):X==="Capitalize"?NA(Y):X==="Uppercase"?GA(Y):X==="Lowercase"?UA(Y):Y:Y.toString()}function fJ(Y,X){return Y.map(($)=>pY($,X))}function pY(Y,X,$={}){return UY(Y)?gJ(Y,X,$):BY(Y)?BA(Y,X,$):N0(Y)?z0(fJ(Y.anyOf,X),$):GY(Y)?Z0(kJ(Y.const,X),$):I(Y,$)}function yJ(Y,X={}){return pY(Y,"Capitalize",X)}function vJ(Y,X={}){return pY(Y,"Lowercase",X)}function hJ(Y,X={}){return pY(Y,"Uncapitalize",X)}function dJ(Y,X={}){return pY(Y,"Uppercase",X)}function AA(Y,X,$){let Q={};for(let Z of globalThis.Object.getOwnPropertyNames(Y))Q[Z]=X8(Y[Z],X,f0($));return Q}function HA(Y,X,$){return AA(Y.properties,X,$)}function mJ(Y,X,$){let Q=HA(Y,X,$);return U0(Q)}function zA(Y,X){return Y.map(($)=>tZ($,X))}function qA(Y,X){return Y.map(($)=>tZ($,X))}function OA(Y,X){let{[X]:$,...Q}=Y;return Q}function DA(Y,X){return X.reduce(($,Q)=>OA($,Q),Y)}function wA(Y,X){let $=t0(Y,[R0,"$id","required","properties"]),Q=DA(Y.properties,X);return q0(Q,$)}function LA(Y){let X=Y.reduce(($,Q)=>YQ(Q)?[...$,Z0(Q)]:$,[]);return z0(X)}function tZ(Y,X){return o0(Y)?y1(zA(Y.allOf,X)):N0(Y)?z0(qA(Y.anyOf,X)):J1(Y)?wA(Y,X):q0({})}function X8(Y,X,$){let Q=Z1(X)?LA(X):X,Z=u0(X)?o1(X):X,W=X1(Y),J=X1(X);return v0(Y)?mJ(Y,Z,$):UY(X)?uJ(Y,X,$):W&&J?b0("Omit",[Y,Q],$):!W&&J?b0("Omit",[Y,Q],$):W&&!J?b0("Omit",[Y,Q],$):I({...tZ(Y,Z),...$})}function KA(Y,X,$){return{[X]:X8(Y,[X],f0($))}}function SA(Y,X,$){return X.reduce((Q,Z)=>{return{...Q,...KA(Y,Z,$)}},{})}function PA(Y,X,$){return SA(Y,X.keys,$)}function uJ(Y,X,$){let Q=PA(Y,X,$);return U0(Q)}function FA(Y,X,$){let Q={};for(let Z of globalThis.Object.getOwnPropertyNames(Y))Q[Z]=$8(Y[Z],X,f0($));return Q}function CA(Y,X,$){return FA(Y.properties,X,$)}function cJ(Y,X,$){let Q=CA(Y,X,$);return U0(Q)}function RA(Y,X){return Y.map(($)=>rZ($,X))}function jA(Y,X){return Y.map(($)=>rZ($,X))}function _A(Y,X){let $={};for(let Q of X)if(Q in Y)$[Q]=Y[Q];return $}function EA(Y,X){let $=t0(Y,[R0,"$id","required","properties"]),Q=_A(Y.properties,X);return q0(Q,$)}function VA(Y){let X=Y.reduce(($,Q)=>YQ(Q)?[...$,Z0(Q)]:$,[]);return z0(X)}function rZ(Y,X){return o0(Y)?y1(RA(Y.allOf,X)):N0(Y)?z0(jA(Y.anyOf,X)):J1(Y)?EA(Y,X):q0({})}function $8(Y,X,$){let Q=Z1(X)?VA(X):X,Z=u0(X)?o1(X):X,W=X1(Y),J=X1(X);return v0(Y)?cJ(Y,Z,$):UY(X)?pJ(Y,X,$):W&&J?b0("Pick",[Y,Q],$):!W&&J?b0("Pick",[Y,Q],$):W&&!J?b0("Pick",[Y,Q],$):I({...rZ(Y,Z),...$})}function IA(Y,X,$){return{[X]:$8(Y,[X],f0($))}}function TA(Y,X,$){return X.reduce((Q,Z)=>{return{...Q,...IA(Y,Z,$)}},{})}function xA(Y,X,$){return TA(Y,X.keys,$)}function pJ(Y,X,$){let Q=xA(Y,X,$);return U0(Q)}function bA(Y,X){return b0("Partial",[b0(Y,X)])}function gA(Y){return b0("Partial",[_Y(Y)])}function kA(Y){let X={};for(let $ of globalThis.Object.getOwnPropertyNames(Y))X[$]=f1(Y[$]);return X}function fA(Y){let X=t0(Y,[R0,"$id","required","properties"]),$=kA(Y.properties);return q0($,X)}function iJ(Y){return Y.map((X)=>lJ(X))}function lJ(Y){return yY(Y)?bA(Y.target,Y.parameters):X1(Y)?gA(Y.$ref):o0(Y)?y1(iJ(Y.allOf)):N0(Y)?z0(iJ(Y.anyOf)):J1(Y)?fA(Y):D8(Y)?Y:FX(Y)?Y:dY(Y)?Y:GY(Y)?Y:b6(Y)?Y:mY(Y)?Y:CX(Y)?Y:g6(Y)?Y:RX(Y)?Y:q0({})}function X6(Y,X){if(v0(Y))return nJ(Y,X);else return I({...lJ(Y),...X})}function yA(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=X6(Y[Q],f0(X));return $}function vA(Y,X){return yA(Y.properties,X)}function nJ(Y,X){let $=vA(Y,X);return U0($)}function hA(Y,X){return b0("Required",[b0(Y,X)])}function dA(Y){return b0("Required",[_Y(Y)])}function mA(Y){let X={};for(let $ of globalThis.Object.getOwnPropertyNames(Y))X[$]=t0(Y[$],[H1]);return X}function uA(Y){let X=t0(Y,[R0,"$id","required","properties"]),$=mA(Y.properties);return q0($,X)}function oJ(Y){return Y.map((X)=>tJ(X))}function tJ(Y){return yY(Y)?hA(Y.target,Y.parameters):X1(Y)?dA(Y.$ref):o0(Y)?y1(oJ(Y.allOf)):N0(Y)?z0(oJ(Y.anyOf)):J1(Y)?uA(Y):D8(Y)?Y:FX(Y)?Y:dY(Y)?Y:GY(Y)?Y:b6(Y)?Y:mY(Y)?Y:CX(Y)?Y:g6(Y)?Y:RX(Y)?Y:q0({})}function $6(Y,X){if(v0(Y))return rJ(Y,X);else return I({...tJ(Y),...X})}function cA(Y,X){let $={};for(let Q of globalThis.Object.getOwnPropertyNames(Y))$[Q]=$6(Y[Q],X);return $}function pA(Y,X){return cA(Y.properties,X)}function rJ(Y,X){let $=pA(Y,X);return U0($)}function iA(Y,X){return X.map(($)=>{return X1($)?sZ(Y,$.$ref):HY(Y,$)})}function sZ(Y,X){return X in Y?X1(Y[X])?sZ(Y,Y[X].$ref):HY(Y,Y[X]):r()}function lA(Y){return t8(Y[0])}function nA(Y){return eX(Y[0],Y[1])}function oA(Y){return r8(Y[0])}function tA(Y){return X6(Y[0])}function rA(Y){return X8(Y[0],Y[1])}function sA(Y){return $8(Y[0],Y[1])}function aA(Y){return $6(Y[0])}function eA(Y,X,$){let Q=iA(Y,$);return X==="Awaited"?lA(Q):X==="Index"?nA(Q):X==="KeyOf"?oA(Q):X==="Partial"?tA(Q):X==="Omit"?rA(Q):X==="Pick"?sA(Q):X==="Required"?aA(Q):r()}function YH(Y,X){return m8(HY(Y,X))}function XH(Y,X){return u8(HY(Y,X))}function $H(Y,X,$){return c8(p6(Y,X),HY(Y,$))}function QH(Y,X,$){return NX(p6(Y,X),HY(Y,$))}function ZH(Y,X){return y1(p6(Y,X))}function WH(Y,X){return o8(HY(Y,X))}function JH(Y,X){return q0(globalThis.Object.keys(X).reduce(($,Q)=>{return{...$,[Q]:HY(Y,X[Q])}},{}))}function MH(Y,X){let[$,Q]=[HY(Y,KQ(X)),LQ(X)],Z=f8(X);return Z.patternProperties[Q]=$,Z}function NH(Y,X){return X1(X)?{...sZ(Y,X.$ref),[R0]:X[R0]}:X}function GH(Y,X){return RY(p6(Y,X))}function UH(Y,X){return z0(p6(Y,X))}function p6(Y,X){return X.map(($)=>HY(Y,$))}function HY(Y,X){return n1(X)?I(HY(Y,t0(X,[H1])),X):v8(X)?I(HY(Y,t0(X,[kY])),X):H0(X)?I(NH(Y,X),X):fY(X)?I(YH(Y,X.items),X):O8(X)?I(XH(Y,X.items),X):yY(X)?I(eA(Y,X.target,X.parameters)):vY(X)?I($H(Y,X.parameters,X.returns),X):hY(X)?I(QH(Y,X.parameters,X.returns),X):o0(X)?I(ZH(Y,X.allOf),X):w8(X)?I(WH(Y,X.items),X):J1(X)?I(JH(Y,X.properties),X):K8(X)?I(MH(Y,X)):AY(X)?I(GH(Y,X.items||[]),X):N0(X)?I(UH(Y,X.anyOf),X):X}function BH(Y,X){return X in Y?HY(Y,Y[X]):r()}function sJ(Y){return globalThis.Object.getOwnPropertyNames(Y).reduce((X,$)=>{return{...X,[$]:BH(Y,$)}},{})}class aJ{constructor(Y){let X=sJ(Y),$=this.WithIdentifiers(X);this.$defs=$}Import(Y,X){let $={...this.$defs,[Y]:I(this.$defs[Y],X)};return I({[S]:"Import",$defs:$,$ref:Y})}WithIdentifiers(Y){return globalThis.Object.getOwnPropertyNames(Y).reduce((X,$)=>{return{...X,[$]:{...Y[$],$id:$}}},{})}}function eJ(Y){return new aJ(Y)}function Y7(Y,X){return I({[S]:"Not",not:Y},X)}function X7(Y,X){return hY(Y)?RY(Y.parameters,X):r()}var AH=0;function $7(Y,X={}){if(W1(X.$id))X.$id=`T${AH++}`;let $=f8(Y({[S]:"This",$ref:`${X.$id}`}));return $.$id=X.$id,I({[FY]:"Recursive",...$},X)}function Q7(Y,X){let $=j0(Y)?new globalThis.RegExp(Y):Y;return I({[S]:"RegExp",type:"RegExp",source:$.source,flags:$.flags},X)}function HH(Y){return o0(Y)?Y.allOf:N0(Y)?Y.anyOf:AY(Y)?Y.items??[]:[]}function Z7(Y){return HH(Y)}function W7(Y,X){return hY(Y)?I(Y.returns,X):r(X)}class J7{constructor(Y){this.schema=Y}Decode(Y){return new M7(this.schema,Y)}}class M7{constructor(Y,X){this.schema=Y,this.decode=X}EncodeTransform(Y,X){let Z={Encode:(W)=>X[R0].Encode(Y(W)),Decode:(W)=>this.decode(X[R0].Decode(W))};return{...X,[R0]:Z}}EncodeSchema(Y,X){let $={Decode:this.decode,Encode:Y};return{...X,[R0]:$}}Encode(Y){return H0(this.schema)?this.EncodeTransform(Y,this.schema):this.EncodeSchema(Y,this.schema)}}function N7(Y){return new J7(Y)}function SQ(Y={}){return I({[S]:Y[S]??"Unsafe"},Y)}function G7(Y){return I({[S]:"Void",type:"void"},Y)}var aZ={};wX(aZ,{Void:()=>G7,Uppercase:()=>dJ,Unsafe:()=>SQ,Unknown:()=>uY,Union:()=>z0,Undefined:()=>AQ,Uncapitalize:()=>hJ,Uint8Array:()=>HQ,Tuple:()=>RY,Transform:()=>N7,TemplateLiteral:()=>WQ,Symbol:()=>BQ,String:()=>m1,ReturnType:()=>W7,Rest:()=>Z7,Required:()=>$6,RegExp:()=>Q7,Ref:()=>_Y,Recursive:()=>$7,Record:()=>wQ,ReadonlyOptional:()=>DQ,Readonly:()=>t1,Promise:()=>MQ,Pick:()=>$8,Partial:()=>X6,Parameters:()=>X7,Optional:()=>f1,Omit:()=>X8,Object:()=>q0,Number:()=>CY,Null:()=>UQ,Not:()=>Y7,Never:()=>r,Module:()=>eJ,Mapped:()=>$J,Lowercase:()=>vJ,Literal:()=>Z0,KeyOf:()=>r8,Iterator:()=>o8,Intersect:()=>y1,Integer:()=>bJ,Instantiate:()=>xJ,InstanceType:()=>IJ,Index:()=>eX,Function:()=>NX,Extract:()=>Y6,Extends:()=>a8,Exclude:()=>e8,Enum:()=>BJ,Date:()=>GQ,ConstructorParameters:()=>UJ,Constructor:()=>c8,Const:()=>GJ,Composite:()=>NJ,Capitalize:()=>yJ,Boolean:()=>ZQ,BigInt:()=>n8,Awaited:()=>t8,AsyncIterator:()=>u8,Array:()=>m8,Argument:()=>d5,Any:()=>aX});var iY=aZ;function zH(Y){switch(Y.errorType){case V.ArrayContains:return"Expected array to contain at least one matching value";case V.ArrayMaxContains:return`Expected array to contain no more than ${Y.schema.maxContains} matching values`;case V.ArrayMinContains:return`Expected array to contain at least ${Y.schema.minContains} matching values`;case V.ArrayMaxItems:return`Expected array length to be less or equal to ${Y.schema.maxItems}`;case V.ArrayMinItems:return`Expected array length to be greater or equal to ${Y.schema.minItems}`;case V.ArrayUniqueItems:return"Expected array elements to be unique";case V.Array:return"Expected array";case V.AsyncIterator:return"Expected AsyncIterator";case V.BigIntExclusiveMaximum:return`Expected bigint to be less than ${Y.schema.exclusiveMaximum}`;case V.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${Y.schema.exclusiveMinimum}`;case V.BigIntMaximum:return`Expected bigint to be less or equal to ${Y.schema.maximum}`;case V.BigIntMinimum:return`Expected bigint to be greater or equal to ${Y.schema.minimum}`;case V.BigIntMultipleOf:return`Expected bigint to be a multiple of ${Y.schema.multipleOf}`;case V.BigInt:return"Expected bigint";case V.Boolean:return"Expected boolean";case V.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${Y.schema.exclusiveMinimumTimestamp}`;case V.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${Y.schema.exclusiveMaximumTimestamp}`;case V.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${Y.schema.minimumTimestamp}`;case V.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${Y.schema.maximumTimestamp}`;case V.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${Y.schema.multipleOfTimestamp}`;case V.Date:return"Expected Date";case V.Function:return"Expected function";case V.IntegerExclusiveMaximum:return`Expected integer to be less than ${Y.schema.exclusiveMaximum}`;case V.IntegerExclusiveMinimum:return`Expected integer to be greater than ${Y.schema.exclusiveMinimum}`;case V.IntegerMaximum:return`Expected integer to be less or equal to ${Y.schema.maximum}`;case V.IntegerMinimum:return`Expected integer to be greater or equal to ${Y.schema.minimum}`;case V.IntegerMultipleOf:return`Expected integer to be a multiple of ${Y.schema.multipleOf}`;case V.Integer:return"Expected integer";case V.IntersectUnevaluatedProperties:return"Unexpected property";case V.Intersect:return"Expected all values to match";case V.Iterator:return"Expected Iterator";case V.Literal:return`Expected ${typeof Y.schema.const==="string"?`'${Y.schema.const}'`:Y.schema.const}`;case V.Never:return"Never";case V.Not:return"Value should not match";case V.Null:return"Expected null";case V.NumberExclusiveMaximum:return`Expected number to be less than ${Y.schema.exclusiveMaximum}`;case V.NumberExclusiveMinimum:return`Expected number to be greater than ${Y.schema.exclusiveMinimum}`;case V.NumberMaximum:return`Expected number to be less or equal to ${Y.schema.maximum}`;case V.NumberMinimum:return`Expected number to be greater or equal to ${Y.schema.minimum}`;case V.NumberMultipleOf:return`Expected number to be a multiple of ${Y.schema.multipleOf}`;case V.Number:return"Expected number";case V.Object:return"Expected object";case V.ObjectAdditionalProperties:return"Unexpected property";case V.ObjectMaxProperties:return`Expected object to have no more than ${Y.schema.maxProperties} properties`;case V.ObjectMinProperties:return`Expected object to have at least ${Y.schema.minProperties} properties`;case V.ObjectRequiredProperty:return"Expected required property";case V.Promise:return"Expected Promise";case V.RegExp:return"Expected string to match regular expression";case V.StringFormatUnknown:return`Unknown format '${Y.schema.format}'`;case V.StringFormat:return`Expected string to match '${Y.schema.format}' format`;case V.StringMaxLength:return`Expected string length less or equal to ${Y.schema.maxLength}`;case V.StringMinLength:return`Expected string length greater or equal to ${Y.schema.minLength}`;case V.StringPattern:return`Expected string to match '${Y.schema.pattern}'`;case V.String:return"Expected string";case V.Symbol:return"Expected symbol";case V.TupleLength:return`Expected tuple to have ${Y.schema.maxItems||0} elements`;case V.Tuple:return"Expected tuple";case V.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${Y.schema.maxByteLength}`;case V.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${Y.schema.minByteLength}`;case V.Uint8Array:return"Expected Uint8Array";case V.Undefined:return"Expected undefined";case V.Union:return"Expected union value";case V.Void:return"Expected void";case V.Kind:return`Expected kind '${Y.schema[S]}'`;default:return"Unknown error type"}}var qH=zH;function U7(){return qH}class B7 extends n{constructor(Y){super(`Unable to dereference schema with $id '${Y.$ref}'`);this.schema=Y}}function OH(Y,X){let $=X.find((Q)=>Q.$id===Y.$ref);if($===void 0)throw new B7(Y);return G0($,X)}function C1(Y,X){if(!M0(Y.$id)||X.some(($)=>$.$id===Y.$id))return X;return X.push(Y),X}function G0(Y,X){return Y[S]==="This"||Y[S]==="Ref"?OH(Y,X):Y}class A7 extends n{constructor(Y){super("Unable to hash value");this.value=Y}}var zY;(function(Y){Y[Y.Undefined=0]="Undefined",Y[Y.Null=1]="Null",Y[Y.Boolean=2]="Boolean",Y[Y.Number=3]="Number",Y[Y.String=4]="String",Y[Y.Object=5]="Object",Y[Y.Array=6]="Array",Y[Y.Date=7]="Date",Y[Y.Uint8Array=8]="Uint8Array",Y[Y.Symbol=9]="Symbol",Y[Y.BigInt=10]="BigInt"})(zY||(zY={}));var Q6=BigInt("14695981039346656037"),[DH,wH]=[BigInt("1099511628211"),BigInt("18446744073709551616")],LH=Array.from({length:256}).map((Y,X)=>BigInt(X)),H7=new Float64Array(1),z7=new DataView(H7.buffer),q7=new Uint8Array(H7.buffer);function*KH(Y){let X=Y===0?1:Math.ceil(Math.floor(Math.log2(Y)+1)/8);for(let $=0;$<X;$++)yield Y>>8*(X-1-$)&255}function SH(Y){h1(zY.Array);for(let X of Y)Z6(X)}function PH(Y){h1(zY.Boolean),h1(Y?1:0)}function FH(Y){h1(zY.BigInt),z7.setBigInt64(0,Y);for(let X of q7)h1(X)}function CH(Y){h1(zY.Date),Z6(Y.getTime())}function RH(Y){h1(zY.Null)}function jH(Y){h1(zY.Number),z7.setFloat64(0,Y);for(let X of q7)h1(X)}function _H(Y){h1(zY.Object);for(let X of globalThis.Object.getOwnPropertyNames(Y).sort())Z6(X),Z6(Y[X])}function EH(Y){h1(zY.String);for(let X=0;X<Y.length;X++)for(let $ of KH(Y.charCodeAt(X)))h1($)}function VH(Y){h1(zY.Symbol),Z6(Y.description)}function IH(Y){h1(zY.Uint8Array);for(let X=0;X<Y.length;X++)h1(Y[X])}function TH(Y){return h1(zY.Undefined)}function Z6(Y){if(i(Y))return SH(Y);if(MX(Y))return PH(Y);if(I1(Y))return FH(Y);if(d1(Y))return CH(Y);if(SX(Y))return RH(Y);if(p(Y))return jH(Y);if(t(Y))return _H(Y);if(M0(Y))return EH(Y);if(PX(Y))return VH(Y);if(y8(Y))return IH(Y);if(y0(Y))return TH(Y);throw new A7(Y)}function h1(Y){Q6=Q6^LH[Y],Q6=Q6*DH%wH}function Q8(Y){return Q6=BigInt("14695981039346656037"),Z6(Y),Q6}class O7 extends n{constructor(Y){super("Unknown type");this.schema=Y}}function xH(Y){return Y[S]==="Any"||Y[S]==="Unknown"}function e(Y){return Y!==void 0}function bH(Y,X,$){return!0}function gH(Y,X,$){return!0}function kH(Y,X,$){if(!i($))return!1;if(e(Y.minItems)&&!($.length>=Y.minItems))return!1;if(e(Y.maxItems)&&!($.length<=Y.maxItems))return!1;if(!$.every((W)=>R1(Y.items,X,W)))return!1;if(Y.uniqueItems===!0&&!function(){let W=new Set;for(let J of $){let M=Q8(J);if(W.has(M))return!1;else W.add(M)}return!0}())return!1;if(!(e(Y.contains)||p(Y.minContains)||p(Y.maxContains)))return!0;let Q=e(Y.contains)?Y.contains:r(),Z=$.reduce((W,J)=>R1(Q,X,J)?W+1:W,0);if(Z===0)return!1;if(p(Y.minContains)&&Z<Y.minContains)return!1;if(p(Y.maxContains)&&Z>Y.maxContains)return!1;return!0}function fH(Y,X,$){return r$($)}function yH(Y,X,$){if(!I1($))return!1;if(e(Y.exclusiveMaximum)&&!($<Y.exclusiveMaximum))return!1;if(e(Y.exclusiveMinimum)&&!($>Y.exclusiveMinimum))return!1;if(e(Y.maximum)&&!($<=Y.maximum))return!1;if(e(Y.minimum)&&!($>=Y.minimum))return!1;if(e(Y.multipleOf)&&$%Y.multipleOf!==BigInt(0))return!1;return!0}function vH(Y,X,$){return MX($)}function hH(Y,X,$){return R1(Y.returns,X,$.prototype)}function dH(Y,X,$){if(!d1($))return!1;if(e(Y.exclusiveMaximumTimestamp)&&!($.getTime()<Y.exclusiveMaximumTimestamp))return!1;if(e(Y.exclusiveMinimumTimestamp)&&!($.getTime()>Y.exclusiveMinimumTimestamp))return!1;if(e(Y.maximumTimestamp)&&!($.getTime()<=Y.maximumTimestamp))return!1;if(e(Y.minimumTimestamp)&&!($.getTime()>=Y.minimumTimestamp))return!1;if(e(Y.multipleOfTimestamp)&&$.getTime()%Y.multipleOfTimestamp!==0)return!1;return!0}function mH(Y,X,$){return nX($)}function uH(Y,X,$){let Q=globalThis.Object.values(Y.$defs),Z=Y.$defs[Y.$ref];return R1(Z,[...X,...Q],$)}function cH(Y,X,$){if(!e$($))return!1;if(e(Y.exclusiveMaximum)&&!($<Y.exclusiveMaximum))return!1;if(e(Y.exclusiveMinimum)&&!($>Y.exclusiveMinimum))return!1;if(e(Y.maximum)&&!($<=Y.maximum))return!1;if(e(Y.minimum)&&!($>=Y.minimum))return!1;if(e(Y.multipleOf)&&$%Y.multipleOf!==0)return!1;return!0}function pH(Y,X,$){let Q=Y.allOf.every((Z)=>R1(Z,X,$));if(Y.unevaluatedProperties===!1){let Z=new RegExp(EX(Y)),W=Object.getOwnPropertyNames($).every((J)=>Z.test(J));return Q&&W}else if(u0(Y.unevaluatedProperties)){let Z=new RegExp(EX(Y)),W=Object.getOwnPropertyNames($).every((J)=>Z.test(J)||R1(Y.unevaluatedProperties,X,$[J]));return Q&&W}else return Q}function iH(Y,X,$){return s$($)}function lH(Y,X,$){return $===Y.const}function nH(Y,X,$){return!1}function oH(Y,X,$){return!R1(Y.not,X,$)}function tH(Y,X,$){return SX($)}function rH(Y,X,$){if(!x0.IsNumberLike($))return!1;if(e(Y.exclusiveMaximum)&&!($<Y.exclusiveMaximum))return!1;if(e(Y.exclusiveMinimum)&&!($>Y.exclusiveMinimum))return!1;if(e(Y.minimum)&&!($>=Y.minimum))return!1;if(e(Y.maximum)&&!($<=Y.maximum))return!1;if(e(Y.multipleOf)&&$%Y.multipleOf!==0)return!1;return!0}function sH(Y,X,$){if(!x0.IsObjectLike($))return!1;if(e(Y.minProperties)&&!(Object.getOwnPropertyNames($).length>=Y.minProperties))return!1;if(e(Y.maxProperties)&&!(Object.getOwnPropertyNames($).length<=Y.maxProperties))return!1;let Q=Object.getOwnPropertyNames(Y.properties);for(let Z of Q){let W=Y.properties[Z];if(Y.required&&Y.required.includes(Z)){if(!R1(W,X,$[Z]))return!1;if((VX(W)||xH(W))&&!(Z in $))return!1}else if(x0.IsExactOptionalProperty($,Z)&&!R1(W,X,$[Z]))return!1}if(Y.additionalProperties===!1){let Z=Object.getOwnPropertyNames($);if(Y.required&&Y.required.length===Q.length&&Z.length===Q.length)return!0;else return Z.every((W)=>Q.includes(W))}else if(typeof Y.additionalProperties==="object")return Object.getOwnPropertyNames($).every((W)=>Q.includes(W)||R1(Y.additionalProperties,X,$[W]));else return!0}function aH(Y,X,$){return a$($)}function eH(Y,X,$){if(!x0.IsRecordLike($))return!1;if(e(Y.minProperties)&&!(Object.getOwnPropertyNames($).length>=Y.minProperties))return!1;if(e(Y.maxProperties)&&!(Object.getOwnPropertyNames($).length<=Y.maxProperties))return!1;let[Q,Z]=Object.entries(Y.patternProperties)[0],W=new RegExp(Q),J=Object.entries($).every(([U,G])=>{return W.test(U)?R1(Z,X,G):!0}),M=typeof Y.additionalProperties==="object"?Object.entries($).every(([U,G])=>{return!W.test(U)?R1(Y.additionalProperties,X,G):!0}):!0,N=Y.additionalProperties===!1?Object.getOwnPropertyNames($).every((U)=>{return W.test(U)}):!0;return J&&M&&N}function Yz(Y,X,$){return R1(G0(Y,X),X,$)}function Xz(Y,X,$){let Q=new RegExp(Y.source,Y.flags);if(e(Y.minLength)){if(!($.length>=Y.minLength))return!1}if(e(Y.maxLength)){if(!($.length<=Y.maxLength))return!1}return Q.test($)}function $z(Y,X,$){if(!M0($))return!1;if(e(Y.minLength)){if(!($.length>=Y.minLength))return!1}if(e(Y.maxLength)){if(!($.length<=Y.maxLength))return!1}if(e(Y.pattern)){if(!new RegExp(Y.pattern).test($))return!1}if(e(Y.format)){if(!w0.Has(Y.format))return!1;return w0.Get(Y.format)($)}return!0}function Qz(Y,X,$){return PX($)}function Zz(Y,X,$){return M0($)&&new RegExp(Y.pattern).test($)}function Wz(Y,X,$){return R1(G0(Y,X),X,$)}function Jz(Y,X,$){if(!i($))return!1;if(Y.items===void 0&&$.length!==0)return!1;if($.length!==Y.maxItems)return!1;if(!Y.items)return!0;for(let Q=0;Q<Y.items.length;Q++)if(!R1(Y.items[Q],X,$[Q]))return!1;return!0}function Mz(Y,X,$){return y0($)}function Nz(Y,X,$){return Y.anyOf.some((Q)=>R1(Q,X,$))}function Gz(Y,X,$){if(!y8($))return!1;if(e(Y.maxByteLength)&&!($.length<=Y.maxByteLength))return!1;if(e(Y.minByteLength)&&!($.length>=Y.minByteLength))return!1;return!0}function Uz(Y,X,$){return!0}function Bz(Y,X,$){return x0.IsVoidLike($)}function Az(Y,X,$){if(!z1.Has(Y[S]))return!1;return z1.Get(Y[S])(Y,$)}function R1(Y,X,$){let Q=e(Y.$id)?C1(Y,X):X,Z=Y;switch(Z[S]){case"Any":return bH(Z,Q,$);case"Argument":return gH(Z,Q,$);case"Array":return kH(Z,Q,$);case"AsyncIterator":return fH(Z,Q,$);case"BigInt":return yH(Z,Q,$);case"Boolean":return vH(Z,Q,$);case"Constructor":return hH(Z,Q,$);case"Date":return dH(Z,Q,$);case"Function":return mH(Z,Q,$);case"Import":return uH(Z,Q,$);case"Integer":return cH(Z,Q,$);case"Intersect":return pH(Z,Q,$);case"Iterator":return iH(Z,Q,$);case"Literal":return lH(Z,Q,$);case"Never":return nH(Z,Q,$);case"Not":return oH(Z,Q,$);case"Null":return tH(Z,Q,$);case"Number":return rH(Z,Q,$);case"Object":return sH(Z,Q,$);case"Promise":return aH(Z,Q,$);case"Record":return eH(Z,Q,$);case"Ref":return Yz(Z,Q,$);case"RegExp":return Xz(Z,Q,$);case"String":return $z(Z,Q,$);case"Symbol":return Qz(Z,Q,$);case"TemplateLiteral":return Zz(Z,Q,$);case"This":return Wz(Z,Q,$);case"Tuple":return Jz(Z,Q,$);case"Undefined":return Mz(Z,Q,$);case"Union":return Nz(Z,Q,$);case"Uint8Array":return Gz(Z,Q,$);case"Unknown":return Uz(Z,Q,$);case"Void":return Bz(Z,Q,$);default:if(!z1.Has(Z[S]))throw new O7(Z);return Az(Z,Q,$)}}function s(...Y){return Y.length===3?R1(Y[0],Y[1],Y[2]):R1(Y[0],[],Y[1])}var V;(function(Y){Y[Y.ArrayContains=0]="ArrayContains",Y[Y.ArrayMaxContains=1]="ArrayMaxContains",Y[Y.ArrayMaxItems=2]="ArrayMaxItems",Y[Y.ArrayMinContains=3]="ArrayMinContains",Y[Y.ArrayMinItems=4]="ArrayMinItems",Y[Y.ArrayUniqueItems=5]="ArrayUniqueItems",Y[Y.Array=6]="Array",Y[Y.AsyncIterator=7]="AsyncIterator",Y[Y.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",Y[Y.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",Y[Y.BigIntMaximum=10]="BigIntMaximum",Y[Y.BigIntMinimum=11]="BigIntMinimum",Y[Y.BigIntMultipleOf=12]="BigIntMultipleOf",Y[Y.BigInt=13]="BigInt",Y[Y.Boolean=14]="Boolean",Y[Y.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",Y[Y.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",Y[Y.DateMaximumTimestamp=17]="DateMaximumTimestamp",Y[Y.DateMinimumTimestamp=18]="DateMinimumTimestamp",Y[Y.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",Y[Y.Date=20]="Date",Y[Y.Function=21]="Function",Y[Y.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",Y[Y.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",Y[Y.IntegerMaximum=24]="IntegerMaximum",Y[Y.IntegerMinimum=25]="IntegerMinimum",Y[Y.IntegerMultipleOf=26]="IntegerMultipleOf",Y[Y.Integer=27]="Integer",Y[Y.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",Y[Y.Intersect=29]="Intersect",Y[Y.Iterator=30]="Iterator",Y[Y.Kind=31]="Kind",Y[Y.Literal=32]="Literal",Y[Y.Never=33]="Never",Y[Y.Not=34]="Not",Y[Y.Null=35]="Null",Y[Y.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",Y[Y.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",Y[Y.NumberMaximum=38]="NumberMaximum",Y[Y.NumberMinimum=39]="NumberMinimum",Y[Y.NumberMultipleOf=40]="NumberMultipleOf",Y[Y.Number=41]="Number",Y[Y.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",Y[Y.ObjectMaxProperties=43]="ObjectMaxProperties",Y[Y.ObjectMinProperties=44]="ObjectMinProperties",Y[Y.ObjectRequiredProperty=45]="ObjectRequiredProperty",Y[Y.Object=46]="Object",Y[Y.Promise=47]="Promise",Y[Y.RegExp=48]="RegExp",Y[Y.StringFormatUnknown=49]="StringFormatUnknown",Y[Y.StringFormat=50]="StringFormat",Y[Y.StringMaxLength=51]="StringMaxLength",Y[Y.StringMinLength=52]="StringMinLength",Y[Y.StringPattern=53]="StringPattern",Y[Y.String=54]="String",Y[Y.Symbol=55]="Symbol",Y[Y.TupleLength=56]="TupleLength",Y[Y.Tuple=57]="Tuple",Y[Y.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",Y[Y.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",Y[Y.Uint8Array=60]="Uint8Array",Y[Y.Undefined=61]="Undefined",Y[Y.Union=62]="Union",Y[Y.Void=63]="Void"})(V||(V={}));class D7 extends n{constructor(Y){super("Unknown type");this.schema=Y}}function IX(Y){return Y.replace(/~/g,"~0").replace(/\//g,"~1")}function Y0(Y){return Y!==void 0}class C8{constructor(Y){this.iterator=Y}[Symbol.iterator](){return this.iterator}First(){let Y=this.iterator.next();return Y.done?void 0:Y.value}}function d(Y,X,$,Q,Z=[]){return{type:Y,schema:X,path:$,value:Q,message:U7()({errorType:Y,path:$,schema:X,value:Q,errors:Z}),errors:Z}}function*Hz(Y,X,$,Q){}function*zz(Y,X,$,Q){}function*qz(Y,X,$,Q){if(!i(Q))return yield d(V.Array,Y,$,Q);if(Y0(Y.minItems)&&!(Q.length>=Y.minItems))yield d(V.ArrayMinItems,Y,$,Q);if(Y0(Y.maxItems)&&!(Q.length<=Y.maxItems))yield d(V.ArrayMaxItems,Y,$,Q);for(let J=0;J<Q.length;J++)yield*j1(Y.items,X,`${$}/${J}`,Q[J]);if(Y.uniqueItems===!0&&!function(){let J=new Set;for(let M of Q){let N=Q8(M);if(J.has(N))return!1;else J.add(N)}return!0}())yield d(V.ArrayUniqueItems,Y,$,Q);if(!(Y0(Y.contains)||Y0(Y.minContains)||Y0(Y.maxContains)))return;let Z=Y0(Y.contains)?Y.contains:r(),W=Q.reduce((J,M,N)=>j1(Z,X,`${$}${N}`,M).next().done===!0?J+1:J,0);if(W===0)yield d(V.ArrayContains,Y,$,Q);if(p(Y.minContains)&&W<Y.minContains)yield d(V.ArrayMinContains,Y,$,Q);if(p(Y.maxContains)&&W>Y.maxContains)yield d(V.ArrayMaxContains,Y,$,Q)}function*Oz(Y,X,$,Q){if(!r$(Q))yield d(V.AsyncIterator,Y,$,Q)}function*Dz(Y,X,$,Q){if(!I1(Q))return yield d(V.BigInt,Y,$,Q);if(Y0(Y.exclusiveMaximum)&&!(Q<Y.exclusiveMaximum))yield d(V.BigIntExclusiveMaximum,Y,$,Q);if(Y0(Y.exclusiveMinimum)&&!(Q>Y.exclusiveMinimum))yield d(V.BigIntExclusiveMinimum,Y,$,Q);if(Y0(Y.maximum)&&!(Q<=Y.maximum))yield d(V.BigIntMaximum,Y,$,Q);if(Y0(Y.minimum)&&!(Q>=Y.minimum))yield d(V.BigIntMinimum,Y,$,Q);if(Y0(Y.multipleOf)&&Q%Y.multipleOf!==BigInt(0))yield d(V.BigIntMultipleOf,Y,$,Q)}function*wz(Y,X,$,Q){if(!MX(Q))yield d(V.Boolean,Y,$,Q)}function*Lz(Y,X,$,Q){yield*j1(Y.returns,X,$,Q.prototype)}function*Kz(Y,X,$,Q){if(!d1(Q))return yield d(V.Date,Y,$,Q);if(Y0(Y.exclusiveMaximumTimestamp)&&!(Q.getTime()<Y.exclusiveMaximumTimestamp))yield d(V.DateExclusiveMaximumTimestamp,Y,$,Q);if(Y0(Y.exclusiveMinimumTimestamp)&&!(Q.getTime()>Y.exclusiveMinimumTimestamp))yield d(V.DateExclusiveMinimumTimestamp,Y,$,Q);if(Y0(Y.maximumTimestamp)&&!(Q.getTime()<=Y.maximumTimestamp))yield d(V.DateMaximumTimestamp,Y,$,Q);if(Y0(Y.minimumTimestamp)&&!(Q.getTime()>=Y.minimumTimestamp))yield d(V.DateMinimumTimestamp,Y,$,Q);if(Y0(Y.multipleOfTimestamp)&&Q.getTime()%Y.multipleOfTimestamp!==0)yield d(V.DateMultipleOfTimestamp,Y,$,Q)}function*Sz(Y,X,$,Q){if(!nX(Q))yield d(V.Function,Y,$,Q)}function*Pz(Y,X,$,Q){let Z=globalThis.Object.values(Y.$defs),W=Y.$defs[Y.$ref];yield*j1(W,[...X,...Z],$,Q)}function*Fz(Y,X,$,Q){if(!e$(Q))return yield d(V.Integer,Y,$,Q);if(Y0(Y.exclusiveMaximum)&&!(Q<Y.exclusiveMaximum))yield d(V.IntegerExclusiveMaximum,Y,$,Q);if(Y0(Y.exclusiveMinimum)&&!(Q>Y.exclusiveMinimum))yield d(V.IntegerExclusiveMinimum,Y,$,Q);if(Y0(Y.maximum)&&!(Q<=Y.maximum))yield d(V.IntegerMaximum,Y,$,Q);if(Y0(Y.minimum)&&!(Q>=Y.minimum))yield d(V.IntegerMinimum,Y,$,Q);if(Y0(Y.multipleOf)&&Q%Y.multipleOf!==0)yield d(V.IntegerMultipleOf,Y,$,Q)}function*Cz(Y,X,$,Q){let Z=!1;for(let W of Y.allOf)for(let J of j1(W,X,$,Q))Z=!0,yield J;if(Z)return yield d(V.Intersect,Y,$,Q);if(Y.unevaluatedProperties===!1){let W=new RegExp(EX(Y));for(let J of Object.getOwnPropertyNames(Q))if(!W.test(J))yield d(V.IntersectUnevaluatedProperties,Y,`${$}/${J}`,Q)}if(typeof Y.unevaluatedProperties==="object"){let W=new RegExp(EX(Y));for(let J of Object.getOwnPropertyNames(Q))if(!W.test(J)){let M=j1(Y.unevaluatedProperties,X,`${$}/${J}`,Q[J]).next();if(!M.done)yield M.value}}}function*Rz(Y,X,$,Q){if(!s$(Q))yield d(V.Iterator,Y,$,Q)}function*jz(Y,X,$,Q){if(Q!==Y.const)yield d(V.Literal,Y,$,Q)}function*_z(Y,X,$,Q){yield d(V.Never,Y,$,Q)}function*Ez(Y,X,$,Q){if(j1(Y.not,X,$,Q).next().done===!0)yield d(V.Not,Y,$,Q)}function*Vz(Y,X,$,Q){if(!SX(Q))yield d(V.Null,Y,$,Q)}function*Iz(Y,X,$,Q){if(!x0.IsNumberLike(Q))return yield d(V.Number,Y,$,Q);if(Y0(Y.exclusiveMaximum)&&!(Q<Y.exclusiveMaximum))yield d(V.NumberExclusiveMaximum,Y,$,Q);if(Y0(Y.exclusiveMinimum)&&!(Q>Y.exclusiveMinimum))yield d(V.NumberExclusiveMinimum,Y,$,Q);if(Y0(Y.maximum)&&!(Q<=Y.maximum))yield d(V.NumberMaximum,Y,$,Q);if(Y0(Y.minimum)&&!(Q>=Y.minimum))yield d(V.NumberMinimum,Y,$,Q);if(Y0(Y.multipleOf)&&Q%Y.multipleOf!==0)yield d(V.NumberMultipleOf,Y,$,Q)}function*Tz(Y,X,$,Q){if(!x0.IsObjectLike(Q))return yield d(V.Object,Y,$,Q);if(Y0(Y.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=Y.minProperties))yield d(V.ObjectMinProperties,Y,$,Q);if(Y0(Y.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=Y.maxProperties))yield d(V.ObjectMaxProperties,Y,$,Q);let Z=Array.isArray(Y.required)?Y.required:[],W=Object.getOwnPropertyNames(Y.properties),J=Object.getOwnPropertyNames(Q);for(let M of Z){if(J.includes(M))continue;yield d(V.ObjectRequiredProperty,Y.properties[M],`${$}/${IX(M)}`,void 0)}if(Y.additionalProperties===!1){for(let M of J)if(!W.includes(M))yield d(V.ObjectAdditionalProperties,Y,`${$}/${IX(M)}`,Q[M])}if(typeof Y.additionalProperties==="object")for(let M of J){if(W.includes(M))continue;yield*j1(Y.additionalProperties,X,`${$}/${IX(M)}`,Q[M])}for(let M of W){let N=Y.properties[M];if(Y.required&&Y.required.includes(M)){if(yield*j1(N,X,`${$}/${IX(M)}`,Q[M]),VX(Y)&&!(M in Q))yield d(V.ObjectRequiredProperty,N,`${$}/${IX(M)}`,void 0)}else if(x0.IsExactOptionalProperty(Q,M))yield*j1(N,X,`${$}/${IX(M)}`,Q[M])}}function*xz(Y,X,$,Q){if(!a$(Q))yield d(V.Promise,Y,$,Q)}function*bz(Y,X,$,Q){if(!x0.IsRecordLike(Q))return yield d(V.Object,Y,$,Q);if(Y0(Y.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=Y.minProperties))yield d(V.ObjectMinProperties,Y,$,Q);if(Y0(Y.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=Y.maxProperties))yield d(V.ObjectMaxProperties,Y,$,Q);let[Z,W]=Object.entries(Y.patternProperties)[0],J=new RegExp(Z);for(let[M,N]of Object.entries(Q))if(J.test(M))yield*j1(W,X,`${$}/${IX(M)}`,N);if(typeof Y.additionalProperties==="object"){for(let[M,N]of Object.entries(Q))if(!J.test(M))yield*j1(Y.additionalProperties,X,`${$}/${IX(M)}`,N)}if(Y.additionalProperties===!1)for(let[M,N]of Object.entries(Q)){if(J.test(M))continue;return yield d(V.ObjectAdditionalProperties,Y,`${$}/${IX(M)}`,N)}}function*gz(Y,X,$,Q){yield*j1(G0(Y,X),X,$,Q)}function*kz(Y,X,$,Q){if(!M0(Q))return yield d(V.String,Y,$,Q);if(Y0(Y.minLength)&&!(Q.length>=Y.minLength))yield d(V.StringMinLength,Y,$,Q);if(Y0(Y.maxLength)&&!(Q.length<=Y.maxLength))yield d(V.StringMaxLength,Y,$,Q);if(!new RegExp(Y.source,Y.flags).test(Q))return yield d(V.RegExp,Y,$,Q)}function*fz(Y,X,$,Q){if(!M0(Q))return yield d(V.String,Y,$,Q);if(Y0(Y.minLength)&&!(Q.length>=Y.minLength))yield d(V.StringMinLength,Y,$,Q);if(Y0(Y.maxLength)&&!(Q.length<=Y.maxLength))yield d(V.StringMaxLength,Y,$,Q);if(M0(Y.pattern)){if(!new RegExp(Y.pattern).test(Q))yield d(V.StringPattern,Y,$,Q)}if(M0(Y.format)){if(!w0.Has(Y.format))yield d(V.StringFormatUnknown,Y,$,Q);else if(!w0.Get(Y.format)(Q))yield d(V.StringFormat,Y,$,Q)}}function*yz(Y,X,$,Q){if(!PX(Q))yield d(V.Symbol,Y,$,Q)}function*vz(Y,X,$,Q){if(!M0(Q))return yield d(V.String,Y,$,Q);if(!new RegExp(Y.pattern).test(Q))yield d(V.StringPattern,Y,$,Q)}function*hz(Y,X,$,Q){yield*j1(G0(Y,X),X,$,Q)}function*dz(Y,X,$,Q){if(!i(Q))return yield d(V.Tuple,Y,$,Q);if(Y.items===void 0&&Q.length!==0)return yield d(V.TupleLength,Y,$,Q);if(Q.length!==Y.maxItems)return yield d(V.TupleLength,Y,$,Q);if(!Y.items)return;for(let Z=0;Z<Y.items.length;Z++)yield*j1(Y.items[Z],X,`${$}/${Z}`,Q[Z])}function*mz(Y,X,$,Q){if(!y0(Q))yield d(V.Undefined,Y,$,Q)}function*uz(Y,X,$,Q){if(s(Y,X,Q))return;let Z=Y.anyOf.map((W)=>new C8(j1(W,X,$,Q)));yield d(V.Union,Y,$,Q,Z)}function*cz(Y,X,$,Q){if(!y8(Q))return yield d(V.Uint8Array,Y,$,Q);if(Y0(Y.maxByteLength)&&!(Q.length<=Y.maxByteLength))yield d(V.Uint8ArrayMaxByteLength,Y,$,Q);if(Y0(Y.minByteLength)&&!(Q.length>=Y.minByteLength))yield d(V.Uint8ArrayMinByteLength,Y,$,Q)}function*pz(Y,X,$,Q){}function*iz(Y,X,$,Q){if(!x0.IsVoidLike(Q))yield d(V.Void,Y,$,Q)}function*lz(Y,X,$,Q){if(!z1.Get(Y[S])(Y,Q))yield d(V.Kind,Y,$,Q)}function*j1(Y,X,$,Q){let Z=Y0(Y.$id)?[...X,Y]:X,W=Y;switch(W[S]){case"Any":return yield*Hz(W,Z,$,Q);case"Argument":return yield*zz(W,Z,$,Q);case"Array":return yield*qz(W,Z,$,Q);case"AsyncIterator":return yield*Oz(W,Z,$,Q);case"BigInt":return yield*Dz(W,Z,$,Q);case"Boolean":return yield*wz(W,Z,$,Q);case"Constructor":return yield*Lz(W,Z,$,Q);case"Date":return yield*Kz(W,Z,$,Q);case"Function":return yield*Sz(W,Z,$,Q);case"Import":return yield*Pz(W,Z,$,Q);case"Integer":return yield*Fz(W,Z,$,Q);case"Intersect":return yield*Cz(W,Z,$,Q);case"Iterator":return yield*Rz(W,Z,$,Q);case"Literal":return yield*jz(W,Z,$,Q);case"Never":return yield*_z(W,Z,$,Q);case"Not":return yield*Ez(W,Z,$,Q);case"Null":return yield*Vz(W,Z,$,Q);case"Number":return yield*Iz(W,Z,$,Q);case"Object":return yield*Tz(W,Z,$,Q);case"Promise":return yield*xz(W,Z,$,Q);case"Record":return yield*bz(W,Z,$,Q);case"Ref":return yield*gz(W,Z,$,Q);case"RegExp":return yield*kz(W,Z,$,Q);case"String":return yield*fz(W,Z,$,Q);case"Symbol":return yield*yz(W,Z,$,Q);case"TemplateLiteral":return yield*vz(W,Z,$,Q);case"This":return yield*hz(W,Z,$,Q);case"Tuple":return yield*dz(W,Z,$,Q);case"Undefined":return yield*mz(W,Z,$,Q);case"Union":return yield*uz(W,Z,$,Q);case"Uint8Array":return yield*cz(W,Z,$,Q);case"Unknown":return yield*pz(W,Z,$,Q);case"Void":return yield*iz(W,Z,$,Q);default:if(!z1.Has(W[S]))throw new D7(Y);return yield*lz(W,Z,$,Q)}}function UX(...Y){let X=Y.length===3?j1(Y[0],Y[1],"",Y[2]):j1(Y[0],[],"",Y[1]);return new C8(X)}var nz=function(Y,X,$,Q,Z){if(Q==="m")throw TypeError("Private method is not writable");if(Q==="a"&&!Z)throw TypeError("Private accessor was defined without a setter");if(typeof X==="function"?Y!==X||!Z:!X.has(Y))throw TypeError("Cannot write private member to an object whose class did not declare it");return Q==="a"?Z.call(Y,$):Z?Z.value=$:X.set(Y,$),$},L7=function(Y,X,$,Q){if($==="a"&&!Q)throw TypeError("Private accessor was defined without a getter");if(typeof X==="function"?Y!==X||!Q:!X.has(Y))throw TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?Q:$==="a"?Q.call(Y):Q?Q.value:X.get(Y)},eZ,PQ,K7;class S7 extends n{constructor(Y){let X=Y.First();super(X===void 0?"Invalid Value":X.message);eZ.add(this),PQ.set(this,void 0),nz(this,PQ,Y,"f"),this.error=X}Errors(){return new C8(L7(this,eZ,"m",K7).call(this))}}PQ=new WeakMap,eZ=new WeakSet,K7=function*(){if(this.error)yield this.error;yield*L7(this,PQ,"f")};function w7(Y,X,$){if(s(Y,X,$))return;throw new S7(UX(Y,X,$))}function FQ(...Y){return Y.length===3?w7(Y[0],Y[1],Y[2]):w7(Y[0],[],Y[1])}function oz(Y){let X={};for(let $ of Object.getOwnPropertyNames(Y))X[$]=B0(Y[$]);for(let $ of Object.getOwnPropertySymbols(Y))X[$]=B0(Y[$]);return X}function tz(Y){return Y.map((X)=>B0(X))}function rz(Y){return Y.slice()}function sz(Y){return new Map(B0([...Y.entries()]))}function az(Y){return new Set(B0([...Y.entries()]))}function ez(Y){return new Date(Y.toISOString())}function Yq(Y){return Y}function B0(Y){if(i(Y))return tz(Y);if(d1(Y))return ez(Y);if(PY(Y))return rz(Y);if(u4(Y))return sz(Y);if(c4(Y))return az(Y);if(t(Y))return oz(Y);if(NY(Y))return Yq(Y);throw Error("ValueClone: Unable to clone value")}class IY extends n{constructor(Y,X){super(X);this.schema=Y}}function A0(Y){return nX(Y)?Y():B0(Y)}function Xq(Y,X){if(o(Y,"default"))return A0(Y.default);else return{}}function $q(Y,X){return{}}function Qq(Y,X){if(Y.uniqueItems===!0&&!o(Y,"default"))throw new IY(Y,"Array with the uniqueItems constraint requires a default value");else if("contains"in Y&&!o(Y,"default"))throw new IY(Y,"Array with the contains constraint requires a default value");else if("default"in Y)return A0(Y.default);else if(Y.minItems!==void 0)return Array.from({length:Y.minItems}).map(($)=>{return qY(Y.items,X)});else return[]}function Zq(Y,X){if(o(Y,"default"))return A0(Y.default);else return async function*(){}()}function Wq(Y,X){if(o(Y,"default"))return A0(Y.default);else return BigInt(0)}function Jq(Y,X){if(o(Y,"default"))return A0(Y.default);else return!1}function Mq(Y,X){if(o(Y,"default"))return A0(Y.default);else{let $=qY(Y.returns,X);if(typeof $==="object"&&!Array.isArray($))return class{constructor(){for(let[Q,Z]of Object.entries($)){let W=this;W[Q]=Z}}};else return class{}}}function Nq(Y,X){if(o(Y,"default"))return A0(Y.default);else if(Y.minimumTimestamp!==void 0)return new Date(Y.minimumTimestamp);else return new Date}function Gq(Y,X){if(o(Y,"default"))return A0(Y.default);else return()=>qY(Y.returns,X)}function Uq(Y,X){let $=globalThis.Object.values(Y.$defs),Q=Y.$defs[Y.$ref];return qY(Q,[...X,...$])}function Bq(Y,X){if(o(Y,"default"))return A0(Y.default);else if(Y.minimum!==void 0)return Y.minimum;else return 0}function Aq(Y,X){if(o(Y,"default"))return A0(Y.default);else{let $=Y.allOf.reduce((Q,Z)=>{let W=qY(Z,X);return typeof W==="object"?{...Q,...W}:W},{});if(!s(Y,X,$))throw new IY(Y,"Intersect produced invalid value. Consider using a default value.");return $}}function Hq(Y,X){if(o(Y,"default"))return A0(Y.default);else return function*(){}()}function zq(Y,X){if(o(Y,"default"))return A0(Y.default);else return Y.const}function qq(Y,X){if(o(Y,"default"))return A0(Y.default);else throw new IY(Y,"Never types cannot be created. Consider using a default value.")}function Oq(Y,X){if(o(Y,"default"))return A0(Y.default);else throw new IY(Y,"Not types must have a default value")}function Dq(Y,X){if(o(Y,"default"))return A0(Y.default);else return null}function wq(Y,X){if(o(Y,"default"))return A0(Y.default);else if(Y.minimum!==void 0)return Y.minimum;else return 0}function Lq(Y,X){if(o(Y,"default"))return A0(Y.default);else{let $=new Set(Y.required),Q={};for(let[Z,W]of Object.entries(Y.properties)){if(!$.has(Z))continue;Q[Z]=qY(W,X)}return Q}}function Kq(Y,X){if(o(Y,"default"))return A0(Y.default);else return Promise.resolve(qY(Y.item,X))}function Sq(Y,X){if(o(Y,"default"))return A0(Y.default);else return{}}function Pq(Y,X){if(o(Y,"default"))return A0(Y.default);else return qY(G0(Y,X),X)}function Fq(Y,X){if(o(Y,"default"))return A0(Y.default);else throw new IY(Y,"RegExp types cannot be created. Consider using a default value.")}function Cq(Y,X){if(Y.pattern!==void 0)if(!o(Y,"default"))throw new IY(Y,"String types with patterns must specify a default value");else return A0(Y.default);else if(Y.format!==void 0)if(!o(Y,"default"))throw new IY(Y,"String types with formats must specify a default value");else return A0(Y.default);else if(o(Y,"default"))return A0(Y.default);else if(Y.minLength!==void 0)return Array.from({length:Y.minLength}).map(()=>" ").join("");else return""}function Rq(Y,X){if(o(Y,"default"))return A0(Y.default);else if("value"in Y)return Symbol.for(Y.value);else return Symbol()}function jq(Y,X){if(o(Y,"default"))return A0(Y.default);if(!QQ(Y))throw new IY(Y,"Can only create template literals that produce a finite variants. Consider using a default value.");return l8(Y)[0]}function _q(Y,X){if(P7++>kq)throw new IY(Y,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(o(Y,"default"))return A0(Y.default);else return qY(G0(Y,X),X)}function Eq(Y,X){if(o(Y,"default"))return A0(Y.default);if(Y.items===void 0)return[];else return Array.from({length:Y.minItems}).map(($,Q)=>qY(Y.items[Q],X))}function Vq(Y,X){if(o(Y,"default"))return A0(Y.default);else return}function Iq(Y,X){if(o(Y,"default"))return A0(Y.default);else if(Y.anyOf.length===0)throw Error("ValueCreate.Union: Cannot create Union with zero variants");else return qY(Y.anyOf[0],X)}function Tq(Y,X){if(o(Y,"default"))return A0(Y.default);else if(Y.minByteLength!==void 0)return new Uint8Array(Y.minByteLength);else return new Uint8Array(0)}function xq(Y,X){if(o(Y,"default"))return A0(Y.default);else return{}}function bq(Y,X){if(o(Y,"default"))return A0(Y.default);else return}function gq(Y,X){if(o(Y,"default"))return A0(Y.default);else throw Error("User defined types must specify a default value")}function qY(Y,X){let $=C1(Y,X),Q=Y;switch(Q[S]){case"Any":return Xq(Q,$);case"Argument":return $q(Q,$);case"Array":return Qq(Q,$);case"AsyncIterator":return Zq(Q,$);case"BigInt":return Wq(Q,$);case"Boolean":return Jq(Q,$);case"Constructor":return Mq(Q,$);case"Date":return Nq(Q,$);case"Function":return Gq(Q,$);case"Import":return Uq(Q,$);case"Integer":return Bq(Q,$);case"Intersect":return Aq(Q,$);case"Iterator":return Hq(Q,$);case"Literal":return zq(Q,$);case"Never":return qq(Q,$);case"Not":return Oq(Q,$);case"Null":return Dq(Q,$);case"Number":return wq(Q,$);case"Object":return Lq(Q,$);case"Promise":return Kq(Q,$);case"Record":return Sq(Q,$);case"Ref":return Pq(Q,$);case"RegExp":return Fq(Q,$);case"String":return Cq(Q,$);case"Symbol":return Rq(Q,$);case"TemplateLiteral":return jq(Q,$);case"This":return _q(Q,$);case"Tuple":return Eq(Q,$);case"Undefined":return Vq(Q,$);case"Union":return Iq(Q,$);case"Uint8Array":return Tq(Q,$);case"Unknown":return xq(Q,$);case"Void":return bq(Q,$);default:if(!z1.Has(Q[S]))throw new IY(Q,"Unknown type");return gq(Q,$)}}var kq=512,P7=0;function lY(...Y){return P7=0,Y.length===2?qY(Y[0],Y[1]):qY(Y[0],[])}class YW extends n{constructor(Y,X){super(X);this.schema=Y}}function F7(Y,X,$){if(Y[S]==="Object"&&typeof $==="object"&&!SX($)){let Q=Y,Z=Object.getOwnPropertyNames($);return Object.entries(Q.properties).reduce((J,[M,N])=>{let U=N[S]==="Literal"&&N.const===$[M]?100:0,G=s(N,X,$[M])?10:0,A=Z.includes(M)?1:0;return J+(U+G+A)},0)}else if(Y[S]==="Union"){let Z=Y.anyOf.map((W)=>G0(W,X)).map((W)=>F7(W,X,$));return Math.max(...Z)}else return s(Y,X,$)?1:0}function fq(Y,X,$){let Q=Y.anyOf.map((J)=>G0(J,X)),[Z,W]=[Q[0],0];for(let J of Q){let M=F7(J,X,$);if(M>W)Z=J,W=M}return Z}function yq(Y,X,$){if("default"in Y)return typeof $==="function"?Y.default:B0(Y.default);else{let Q=fq(Y,X,$);return i6(Q,X,$)}}function vq(Y,X,$){return s(Y,X,$)?B0($):lY(Y,X)}function hq(Y,X,$){return s(Y,X,$)?$:lY(Y,X)}function dq(Y,X,$){if(s(Y,X,$))return B0($);let Q=i($)?B0($):lY(Y,X),Z=p(Y.minItems)&&Q.length<Y.minItems?[...Q,...Array.from({length:Y.minItems-Q.length},()=>null)]:Q,J=(p(Y.maxItems)&&Z.length>Y.maxItems?Z.slice(0,Y.maxItems):Z).map((N)=>nY(Y.items,X,N));if(Y.uniqueItems!==!0)return J;let M=[...new Set(J)];if(!s(Y,X,M))throw new YW(Y,"Array cast produced invalid data due to uniqueItems constraint");return M}function mq(Y,X,$){if(s(Y,X,$))return lY(Y,X);let Q=new Set(Y.returns.required||[]),Z=function(){};for(let[W,J]of Object.entries(Y.returns.properties)){if(!Q.has(W)&&$.prototype[W]===void 0)continue;Z.prototype[W]=nY(J,X,$.prototype[W])}return Z}function uq(Y,X,$){let Q=globalThis.Object.values(Y.$defs),Z=Y.$defs[Y.$ref];return nY(Z,[...X,...Q],$)}function C7(Y,X){if(t(Y)&&!t(X)||!t(Y)&&t(X))return Y;if(!t(Y)||!t(X))return X;return globalThis.Object.getOwnPropertyNames(Y).reduce(($,Q)=>{let Z=Q in X?C7(Y[Q],X[Q]):Y[Q];return{...$,[Q]:Z}},{})}function cq(Y,X,$){if(s(Y,X,$))return $;let Q=lY(Y,X),Z=C7(Q,$);return s(Y,X,Z)?Z:Q}function pq(Y,X,$){throw new YW(Y,"Never types cannot be cast")}function iq(Y,X,$){if(s(Y,X,$))return $;if($===null||typeof $!=="object")return lY(Y,X);let Q=new Set(Y.required||[]),Z={};for(let[W,J]of Object.entries(Y.properties)){if(!Q.has(W)&&$[W]===void 0)continue;Z[W]=nY(J,X,$[W])}if(typeof Y.additionalProperties==="object"){let W=Object.getOwnPropertyNames(Y.properties);for(let J of Object.getOwnPropertyNames($)){if(W.includes(J))continue;Z[J]=nY(Y.additionalProperties,X,$[J])}}return Z}function lq(Y,X,$){if(s(Y,X,$))return B0($);if($===null||typeof $!=="object"||Array.isArray($)||$ instanceof Date)return lY(Y,X);let Q=Object.getOwnPropertyNames(Y.patternProperties)[0],Z=Y.patternProperties[Q],W={};for(let[J,M]of Object.entries($))W[J]=nY(Z,X,M);return W}function nq(Y,X,$){return nY(G0(Y,X),X,$)}function oq(Y,X,$){return nY(G0(Y,X),X,$)}function tq(Y,X,$){if(s(Y,X,$))return B0($);if(!i($))return lY(Y,X);if(Y.items===void 0)return[];return Y.items.map((Q,Z)=>nY(Q,X,$[Z]))}function rq(Y,X,$){return s(Y,X,$)?B0($):yq(Y,X,$)}function nY(Y,X,$){let Q=M0(Y.$id)?C1(Y,X):X,Z=Y;switch(Y[S]){case"Array":return dq(Z,Q,$);case"Constructor":return mq(Z,Q,$);case"Import":return uq(Z,Q,$);case"Intersect":return cq(Z,Q,$);case"Never":return pq(Z,Q,$);case"Object":return iq(Z,Q,$);case"Record":return lq(Z,Q,$);case"Ref":return nq(Z,Q,$);case"This":return oq(Z,Q,$);case"Tuple":return tq(Z,Q,$);case"Union":return rq(Z,Q,$);case"Date":case"Symbol":case"Uint8Array":return vq(Y,X,$);default:return hq(Z,Q,$)}}function i6(...Y){return Y.length===3?nY(Y[0],Y[1],Y[2]):nY(Y[0],[],Y[1])}function sq(Y){return tX(Y)&&Y[S]!=="Unsafe"}function aq(Y,X,$){if(!i($))return $;return $.map((Q)=>a1(Y.items,X,Q))}function eq(Y,X,$){let Q=globalThis.Object.values(Y.$defs),Z=Y.$defs[Y.$ref];return a1(Z,[...X,...Q],$)}function YO(Y,X,$){let Q=Y.unevaluatedProperties,W=Y.allOf.map((M)=>a1(M,X,B0($))).reduce((M,N)=>t(N)?{...M,...N}:N,{});if(!t($)||!t(W)||!tX(Q))return W;let J=r1(Y);for(let M of Object.getOwnPropertyNames($)){if(J.includes(M))continue;if(s(Q,X,$[M]))W[M]=a1(Q,X,$[M])}return W}function XO(Y,X,$){if(!t($)||i($))return $;let Q=Y.additionalProperties;for(let Z of Object.getOwnPropertyNames($)){if(o(Y.properties,Z)){$[Z]=a1(Y.properties[Z],X,$[Z]);continue}if(tX(Q)&&s(Q,X,$[Z])){$[Z]=a1(Q,X,$[Z]);continue}delete $[Z]}return $}function $O(Y,X,$){if(!t($))return $;let Q=Y.additionalProperties,Z=Object.getOwnPropertyNames($),[W,J]=Object.entries(Y.patternProperties)[0],M=new RegExp(W);for(let N of Z){if(M.test(N)){$[N]=a1(J,X,$[N]);continue}if(tX(Q)&&s(Q,X,$[N])){$[N]=a1(Q,X,$[N]);continue}delete $[N]}return $}function QO(Y,X,$){return a1(G0(Y,X),X,$)}function ZO(Y,X,$){return a1(G0(Y,X),X,$)}function WO(Y,X,$){if(!i($))return $;if(y0(Y.items))return[];let Q=Math.min($.length,Y.items.length);for(let Z=0;Z<Q;Z++)$[Z]=a1(Y.items[Z],X,$[Z]);return $.length>Q?$.slice(0,Q):$}function JO(Y,X,$){for(let Q of Y.anyOf)if(sq(Q)&&s(Q,X,$))return a1(Q,X,$);return $}function a1(Y,X,$){let Q=M0(Y.$id)?C1(Y,X):X,Z=Y;switch(Z[S]){case"Array":return aq(Z,Q,$);case"Import":return eq(Z,Q,$);case"Intersect":return YO(Z,Q,$);case"Object":return XO(Z,Q,$);case"Record":return $O(Z,Q,$);case"Ref":return QO(Z,Q,$);case"This":return ZO(Z,Q,$);case"Tuple":return WO(Z,Q,$);case"Union":return JO(Z,Q,$);default:return $}}function CQ(...Y){return Y.length===3?a1(Y[0],Y[1],Y[2]):a1(Y[0],[],Y[1])}function RQ(Y){return M0(Y)&&!isNaN(Y)&&!isNaN(parseFloat(Y))}function MO(Y){return I1(Y)||MX(Y)||p(Y)}function l6(Y){return Y===!0||p(Y)&&Y===1||I1(Y)&&Y===BigInt("1")||M0(Y)&&(Y.toLowerCase()==="true"||Y==="1")}function n6(Y){return Y===!1||p(Y)&&(Y===0||Object.is(Y,-0))||I1(Y)&&Y===BigInt("0")||M0(Y)&&(Y.toLowerCase()==="false"||Y==="0"||Y==="-0")}function NO(Y){return M0(Y)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Y)}function GO(Y){return M0(Y)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Y)}function UO(Y){return M0(Y)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(Y)}function BO(Y){return M0(Y)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(Y)}function AO(Y){return M0(Y)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(Y)}function HO(Y,X){let $=j7(Y);return $===X?$:Y}function zO(Y,X){let $=_7(Y);return $===X?$:Y}function qO(Y,X){let $=R7(Y);return $===X?$:Y}function OO(Y,X){return M0(Y.const)?HO(X,Y.const):p(Y.const)?zO(X,Y.const):MX(Y.const)?qO(X,Y.const):X}function R7(Y){return l6(Y)?!0:n6(Y)?!1:Y}function DO(Y){let X=($)=>$.split(".")[0];return RQ(Y)?BigInt(X(Y)):p(Y)?BigInt(Math.trunc(Y)):n6(Y)?BigInt(0):l6(Y)?BigInt(1):Y}function j7(Y){return PX(Y)&&Y.description!==void 0?Y.description.toString():MO(Y)?Y.toString():Y}function _7(Y){return RQ(Y)?parseFloat(Y):l6(Y)?1:n6(Y)?0:Y}function wO(Y){return RQ(Y)?parseInt(Y):p(Y)?Math.trunc(Y):l6(Y)?1:n6(Y)?0:Y}function LO(Y){return M0(Y)&&Y.toLowerCase()==="null"?null:Y}function KO(Y){return M0(Y)&&Y==="undefined"?void 0:Y}function SO(Y){return d1(Y)?Y:p(Y)?new Date(Y):l6(Y)?new Date(1):n6(Y)?new Date(0):RQ(Y)?new Date(parseInt(Y)):GO(Y)?new Date(`1970-01-01T${Y}.000Z`):NO(Y)?new Date(`1970-01-01T${Y}`):BO(Y)?new Date(`${Y}.000Z`):UO(Y)?new Date(Y):AO(Y)?new Date(`${Y}T00:00:00.000Z`):Y}function PO(Y){return Y}function FO(Y,X,$){return(i($)?$:[$]).map((Z)=>oY(Y.items,X,Z))}function CO(Y,X,$){return DO($)}function RO(Y,X,$){return R7($)}function jO(Y,X,$){return SO($)}function _O(Y,X,$){let Q=globalThis.Object.values(Y.$defs),Z=Y.$defs[Y.$ref];return oY(Z,[...X,...Q],$)}function EO(Y,X,$){return wO($)}function VO(Y,X,$){return Y.allOf.reduce((Q,Z)=>oY(Z,X,Q),$)}function IO(Y,X,$){return OO(Y,$)}function TO(Y,X,$){return LO($)}function xO(Y,X,$){return _7($)}function bO(Y,X,$){if(!t($)||i($))return $;for(let Q of Object.getOwnPropertyNames(Y.properties)){if(!o($,Q))continue;$[Q]=oY(Y.properties[Q],X,$[Q])}return $}function gO(Y,X,$){if(!(t($)&&!i($)))return $;let Z=Object.getOwnPropertyNames(Y.patternProperties)[0],W=Y.patternProperties[Z];for(let[J,M]of Object.entries($))$[J]=oY(W,X,M);return $}function kO(Y,X,$){return oY(G0(Y,X),X,$)}function fO(Y,X,$){return j7($)}function yO(Y,X,$){return M0($)||p($)?Symbol($):$}function vO(Y,X,$){return oY(G0(Y,X),X,$)}function hO(Y,X,$){if(!(i($)&&!y0(Y.items)))return $;return $.map((Z,W)=>{return W<Y.items.length?oY(Y.items[W],X,Z):Z})}function dO(Y,X,$){return KO($)}function mO(Y,X,$){for(let Q of Y.anyOf)if(s(Q,X,$))return $;for(let Q of Y.anyOf){let Z=oY(Q,X,B0($));if(!s(Q,X,Z))continue;return Z}return $}function oY(Y,X,$){let Q=C1(Y,X),Z=Y;switch(Y[S]){case"Array":return FO(Z,Q,$);case"BigInt":return CO(Z,Q,$);case"Boolean":return RO(Z,Q,$);case"Date":return jO(Z,Q,$);case"Import":return _O(Z,Q,$);case"Integer":return EO(Z,Q,$);case"Intersect":return VO(Z,Q,$);case"Literal":return IO(Z,Q,$);case"Null":return TO(Z,Q,$);case"Number":return xO(Z,Q,$);case"Object":return bO(Z,Q,$);case"Record":return gO(Z,Q,$);case"Ref":return kO(Z,Q,$);case"String":return fO(Z,Q,$);case"Symbol":return yO(Z,Q,$);case"This":return vO(Z,Q,$);case"Tuple":return hO(Z,Q,$);case"Undefined":return dO(Z,Q,$);case"Union":return mO(Z,Q,$);default:return PO($)}}function jQ(...Y){return Y.length===3?oY(Y[0],Y[1],Y[2]):oY(Y[0],[],Y[1])}class o6 extends n{constructor(Y,X,$){super("Unable to decode value as it does not match the expected schema");this.schema=Y,this.value=X,this.error=$}}class _Q extends n{constructor(Y,X,$,Q){super(Q instanceof Error?Q.message:"Unknown error");this.schema=Y,this.path=X,this.value=$,this.error=Q}}function c0(Y,X,$){try{return H0(Y)?Y[R0].Decode($):$}catch(Q){throw new _Q(Y,X,$,Q)}}function uO(Y,X,$,Q){return i(Q)?c0(Y,$,Q.map((Z,W)=>tY(Y.items,X,`${$}/${W}`,Z))):c0(Y,$,Q)}function cO(Y,X,$,Q){if(!t(Q)||NY(Q))return c0(Y,$,Q);let Z=NQ(Y),W=Z.map((G)=>G[0]),J={...Q};for(let[G,A]of Z)if(G in J)J[G]=tY(A,X,`${$}/${G}`,J[G]);if(!H0(Y.unevaluatedProperties))return c0(Y,$,J);let M=Object.getOwnPropertyNames(J),N=Y.unevaluatedProperties,U={...J};for(let G of M)if(!W.includes(G))U[G]=c0(N,`${$}/${G}`,U[G]);return c0(Y,$,U)}function pO(Y,X,$,Q){let Z=globalThis.Object.values(Y.$defs),W=Y.$defs[Y.$ref],J=tY(W,[...X,...Z],$,Q);return c0(Y,$,J)}function iO(Y,X,$,Q){return c0(Y,$,tY(Y.not,X,$,Q))}function lO(Y,X,$,Q){if(!t(Q))return c0(Y,$,Q);let Z=r1(Y),W={...Q};for(let U of Z){if(!o(W,U))continue;if(y0(W[U])&&(!RX(Y.properties[U])||x0.IsExactOptionalProperty(W,U)))continue;W[U]=tY(Y.properties[U],X,`${$}/${U}`,W[U])}if(!u0(Y.additionalProperties))return c0(Y,$,W);let J=Object.getOwnPropertyNames(W),M=Y.additionalProperties,N={...W};for(let U of J)if(!Z.includes(U))N[U]=c0(M,`${$}/${U}`,N[U]);return c0(Y,$,N)}function nO(Y,X,$,Q){if(!t(Q))return c0(Y,$,Q);let Z=Object.getOwnPropertyNames(Y.patternProperties)[0],W=new RegExp(Z),J={...Q};for(let G of Object.getOwnPropertyNames(Q))if(W.test(G))J[G]=tY(Y.patternProperties[Z],X,`${$}/${G}`,J[G]);if(!u0(Y.additionalProperties))return c0(Y,$,J);let M=Object.getOwnPropertyNames(J),N=Y.additionalProperties,U={...J};for(let G of M)if(!W.test(G))U[G]=c0(N,`${$}/${G}`,U[G]);return c0(Y,$,U)}function oO(Y,X,$,Q){let Z=G0(Y,X);return c0(Y,$,tY(Z,X,$,Q))}function tO(Y,X,$,Q){let Z=G0(Y,X);return c0(Y,$,tY(Z,X,$,Q))}function rO(Y,X,$,Q){return i(Q)&&i(Y.items)?c0(Y,$,Y.items.map((Z,W)=>tY(Z,X,`${$}/${W}`,Q[W]))):c0(Y,$,Q)}function sO(Y,X,$,Q){for(let Z of Y.anyOf){if(!s(Z,X,Q))continue;let W=tY(Z,X,$,Q);return c0(Y,$,W)}return c0(Y,$,Q)}function tY(Y,X,$,Q){let Z=C1(Y,X),W=Y;switch(Y[S]){case"Array":return uO(W,Z,$,Q);case"Import":return pO(W,Z,$,Q);case"Intersect":return cO(W,Z,$,Q);case"Not":return iO(W,Z,$,Q);case"Object":return lO(W,Z,$,Q);case"Record":return nO(W,Z,$,Q);case"Ref":return oO(W,Z,$,Q);case"Symbol":return c0(W,$,Q);case"This":return tO(W,Z,$,Q);case"Tuple":return rO(W,Z,$,Q);case"Union":return sO(W,Z,$,Q);default:return c0(W,$,Q)}}function W6(Y,X,$){return tY(Y,X,"",$)}class t6 extends n{constructor(Y,X,$){super("The encoded value does not match the expected schema");this.schema=Y,this.value=X,this.error=$}}class E7 extends n{constructor(Y,X,$,Q){super(`${Q instanceof Error?Q.message:"Unknown error"}`);this.schema=Y,this.path=X,this.value=$,this.error=Q}}function T1(Y,X,$){try{return H0(Y)?Y[R0].Encode($):$}catch(Q){throw new E7(Y,X,$,Q)}}function aO(Y,X,$,Q){let Z=T1(Y,$,Q);return i(Z)?Z.map((W,J)=>rY(Y.items,X,`${$}/${J}`,W)):Z}function eO(Y,X,$,Q){let Z=globalThis.Object.values(Y.$defs),W=Y.$defs[Y.$ref],J=T1(Y,$,Q);return rY(W,[...X,...Z],$,J)}function YD(Y,X,$,Q){let Z=T1(Y,$,Q);if(!t(Q)||NY(Q))return Z;let W=NQ(Y),J=W.map((A)=>A[0]),M={...Z};for(let[A,O]of W)if(A in M)M[A]=rY(O,X,`${$}/${A}`,M[A]);if(!H0(Y.unevaluatedProperties))return M;let N=Object.getOwnPropertyNames(M),U=Y.unevaluatedProperties,G={...M};for(let A of N)if(!J.includes(A))G[A]=T1(U,`${$}/${A}`,G[A]);return G}function XD(Y,X,$,Q){return T1(Y.not,$,T1(Y,$,Q))}function $D(Y,X,$,Q){let Z=T1(Y,$,Q);if(!t(Z))return Z;let W=r1(Y),J={...Z};for(let G of W){if(!o(J,G))continue;if(y0(J[G])&&(!RX(Y.properties[G])||x0.IsExactOptionalProperty(J,G)))continue;J[G]=rY(Y.properties[G],X,`${$}/${G}`,J[G])}if(!u0(Y.additionalProperties))return J;let M=Object.getOwnPropertyNames(J),N=Y.additionalProperties,U={...J};for(let G of M)if(!W.includes(G))U[G]=T1(N,`${$}/${G}`,U[G]);return U}function QD(Y,X,$,Q){let Z=T1(Y,$,Q);if(!t(Q))return Z;let W=Object.getOwnPropertyNames(Y.patternProperties)[0],J=new RegExp(W),M={...Z};for(let A of Object.getOwnPropertyNames(Q))if(J.test(A))M[A]=rY(Y.patternProperties[W],X,`${$}/${A}`,M[A]);if(!u0(Y.additionalProperties))return M;let N=Object.getOwnPropertyNames(M),U=Y.additionalProperties,G={...M};for(let A of N)if(!J.test(A))G[A]=T1(U,`${$}/${A}`,G[A]);return G}function ZD(Y,X,$,Q){let Z=G0(Y,X),W=rY(Z,X,$,Q);return T1(Y,$,W)}function WD(Y,X,$,Q){let Z=G0(Y,X),W=rY(Z,X,$,Q);return T1(Y,$,W)}function JD(Y,X,$,Q){let Z=T1(Y,$,Q);return i(Y.items)?Y.items.map((W,J)=>rY(W,X,`${$}/${J}`,Z[J])):[]}function MD(Y,X,$,Q){for(let Z of Y.anyOf){if(!s(Z,X,Q))continue;let W=rY(Z,X,$,Q);return T1(Y,$,W)}for(let Z of Y.anyOf){let W=rY(Z,X,$,Q);if(!s(Y,X,W))continue;return T1(Y,$,W)}return T1(Y,$,Q)}function rY(Y,X,$,Q){let Z=C1(Y,X),W=Y;switch(Y[S]){case"Array":return aO(W,Z,$,Q);case"Import":return eO(W,Z,$,Q);case"Intersect":return YD(W,Z,$,Q);case"Not":return XD(W,Z,$,Q);case"Object":return $D(W,Z,$,Q);case"Record":return QD(W,Z,$,Q);case"Ref":return ZD(W,Z,$,Q);case"This":return WD(W,Z,$,Q);case"Tuple":return JD(W,Z,$,Q);case"Union":return MD(W,Z,$,Q);default:return T1(W,$,Q)}}function J6(Y,X,$){return rY(Y,X,"",$)}function ND(Y,X){return H0(Y)||q1(Y.items,X)}function GD(Y,X){return H0(Y)||q1(Y.items,X)}function UD(Y,X){return H0(Y)||q1(Y.returns,X)||Y.parameters.some(($)=>q1($,X))}function BD(Y,X){return H0(Y)||q1(Y.returns,X)||Y.parameters.some(($)=>q1($,X))}function AD(Y,X){return H0(Y)||H0(Y.unevaluatedProperties)||Y.allOf.some(($)=>q1($,X))}function HD(Y,X){let $=globalThis.Object.getOwnPropertyNames(Y.$defs).reduce((Z,W)=>[...Z,Y.$defs[W]],[]),Q=Y.$defs[Y.$ref];return H0(Y)||q1(Q,[...$,...X])}function zD(Y,X){return H0(Y)||q1(Y.items,X)}function qD(Y,X){return H0(Y)||q1(Y.not,X)}function OD(Y,X){return H0(Y)||Object.values(Y.properties).some(($)=>q1($,X))||u0(Y.additionalProperties)&&q1(Y.additionalProperties,X)}function DD(Y,X){return H0(Y)||q1(Y.item,X)}function wD(Y,X){let $=Object.getOwnPropertyNames(Y.patternProperties)[0],Q=Y.patternProperties[$];return H0(Y)||q1(Q,X)||u0(Y.additionalProperties)&&H0(Y.additionalProperties)}function LD(Y,X){if(H0(Y))return!0;return q1(G0(Y,X),X)}function KD(Y,X){if(H0(Y))return!0;return q1(G0(Y,X),X)}function SD(Y,X){return H0(Y)||!y0(Y.items)&&Y.items.some(($)=>q1($,X))}function PD(Y,X){return H0(Y)||Y.anyOf.some(($)=>q1($,X))}function q1(Y,X){let $=C1(Y,X),Q=Y;if(Y.$id&&XW.has(Y.$id))return!1;if(Y.$id)XW.add(Y.$id);switch(Y[S]){case"Array":return ND(Q,$);case"AsyncIterator":return GD(Q,$);case"Constructor":return UD(Q,$);case"Function":return BD(Q,$);case"Import":return HD(Q,$);case"Intersect":return AD(Q,$);case"Iterator":return zD(Q,$);case"Not":return qD(Q,$);case"Object":return OD(Q,$);case"Promise":return DD(Q,$);case"Record":return wD(Q,$);case"Ref":return LD(Q,$);case"This":return KD(Q,$);case"Tuple":return SD(Q,$);case"Union":return PD(Q,$);default:return H0(Y)}}var XW=new Set;function TX(Y,X){return XW.clear(),q1(Y,X)}function V7(...Y){let[X,$,Q]=Y.length===3?[Y[0],Y[1],Y[2]]:[Y[0],[],Y[1]];if(!s(X,$,Q))throw new o6(X,Q,UX(X,$,Q).First());return TX(X,$)?W6(X,$,Q):Q}function xX(Y,X){let $=o(Y,"default")?Y.default:void 0,Q=nX($)?$():B0($);return y0(X)?Q:t(X)&&t(Q)?Object.assign(Q,X):X}function $W(Y){return tX(Y)&&"default"in Y}function FD(Y,X,$){if(i($)){for(let Z=0;Z<$.length;Z++)$[Z]=u1(Y.items,X,$[Z]);return $}let Q=xX(Y,$);if(!i(Q))return Q;for(let Z=0;Z<Q.length;Z++)Q[Z]=u1(Y.items,X,Q[Z]);return Q}function CD(Y,X,$){return d1($)?$:xX(Y,$)}function RD(Y,X,$){let Q=globalThis.Object.values(Y.$defs),Z=Y.$defs[Y.$ref];return u1(Z,[...X,...Q],$)}function jD(Y,X,$){let Q=xX(Y,$);return Y.allOf.reduce((Z,W)=>{let J=u1(W,X,Q);return t(J)?{...Z,...J}:J},{})}function _D(Y,X,$){let Q=xX(Y,$);if(!t(Q))return Q;let Z=Object.getOwnPropertyNames(Y.properties);for(let W of Z){let J=u1(Y.properties[W],X,Q[W]);if(y0(J))continue;Q[W]=u1(Y.properties[W],X,Q[W])}if(!$W(Y.additionalProperties))return Q;for(let W of Object.getOwnPropertyNames(Q)){if(Z.includes(W))continue;Q[W]=u1(Y.additionalProperties,X,Q[W])}return Q}function ED(Y,X,$){let Q=xX(Y,$);if(!t(Q))return Q;let Z=Y.additionalProperties,[W,J]=Object.entries(Y.patternProperties)[0],M=new RegExp(W);for(let N of Object.getOwnPropertyNames(Q)){if(!(M.test(N)&&$W(J)))continue;Q[N]=u1(J,X,Q[N])}if(!$W(Z))return Q;for(let N of Object.getOwnPropertyNames(Q)){if(M.test(N))continue;Q[N]=u1(Z,X,Q[N])}return Q}function VD(Y,X,$){return u1(G0(Y,X),X,xX(Y,$))}function ID(Y,X,$){return u1(G0(Y,X),X,$)}function TD(Y,X,$){let Q=xX(Y,$);if(!i(Q)||y0(Y.items))return Q;let[Z,W]=[Y.items,Math.max(Y.items.length,Q.length)];for(let J=0;J<W;J++)if(J<Z.length)Q[J]=u1(Z[J],X,Q[J]);return Q}function xD(Y,X,$){let Q=xX(Y,$);for(let Z of Y.anyOf){let W=u1(Z,X,B0(Q));if(s(Z,X,W))return W}return Q}function u1(Y,X,$){let Q=C1(Y,X),Z=Y;switch(Z[S]){case"Array":return FD(Z,Q,$);case"Date":return CD(Z,Q,$);case"Import":return RD(Z,Q,$);case"Intersect":return jD(Z,Q,$);case"Object":return _D(Z,Q,$);case"Record":return ED(Z,Q,$);case"Ref":return VD(Z,Q,$);case"This":return ID(Z,Q,$);case"Tuple":return TD(Z,Q,$);case"Union":return xD(Z,Q,$);default:return xX(Z,$)}}function EQ(...Y){return Y.length===3?u1(Y[0],Y[1],Y[2]):u1(Y[0],[],Y[1])}var sY={};wX(sY,{ValuePointerRootSetError:()=>QW,ValuePointerRootDeleteError:()=>ZW,Set:()=>bD,Has:()=>kD,Get:()=>fD,Format:()=>r6,Delete:()=>gD});class QW extends n{constructor(Y,X,$){super("Cannot set root value");this.value=Y,this.path=X,this.update=$}}class ZW extends n{constructor(Y,X){super("Cannot delete root value");this.value=Y,this.path=X}}function I7(Y){return Y.indexOf("~")===-1?Y:Y.replace(/~1/g,"/").replace(/~0/g,"~")}function*r6(Y){if(Y==="")return;let[X,$]=[0,0];for(let Q=0;Q<Y.length;Q++)if(Y.charAt(Q)==="/")if(Q===0)X=Q+1;else $=Q,yield I7(Y.slice(X,$)),X=Q+1;else $=Q;yield I7(Y.slice(X))}function bD(Y,X,$){if(X==="")throw new QW(Y,X,$);let[Q,Z,W]=[null,Y,""];for(let J of r6(X)){if(Z[J]===void 0)Z[J]={};Q=Z,Z=Z[J],W=J}Q[W]=$}function gD(Y,X){if(X==="")throw new ZW(Y,X);let[$,Q,Z]=[null,Y,""];for(let W of r6(X)){if(Q[W]===void 0||Q[W]===null)return;$=Q,Q=Q[W],Z=W}if(Array.isArray($)){let W=parseInt(Z);$.splice(W,1)}else delete $[Z]}function kD(Y,X){if(X==="")return!0;let[$,Q,Z]=[null,Y,""];for(let W of r6(X)){if(Q[W]===void 0)return!1;$=Q,Q=Q[W],Z=W}return Object.getOwnPropertyNames($).includes(Z)}function fD(Y,X){if(X==="")return Y;let $=Y;for(let Q of r6(X)){if($[Q]===void 0)return;$=$[Q]}return $}function yD(Y,X){if(!t(X))return!1;let $=[...Object.keys(Y),...Object.getOwnPropertySymbols(Y)],Q=[...Object.keys(X),...Object.getOwnPropertySymbols(X)];if($.length!==Q.length)return!1;return $.every((Z)=>R8(Y[Z],X[Z]))}function vD(Y,X){return d1(X)&&Y.getTime()===X.getTime()}function hD(Y,X){if(!i(X)||Y.length!==X.length)return!1;return Y.every(($,Q)=>R8($,X[Q]))}function dD(Y,X){if(!PY(X)||Y.length!==X.length||Object.getPrototypeOf(Y).constructor.name!==Object.getPrototypeOf(X).constructor.name)return!1;return Y.every(($,Q)=>R8($,X[Q]))}function mD(Y,X){return Y===X}function R8(Y,X){if(d1(Y))return vD(Y,X);if(PY(Y))return dD(Y,X);if(i(Y))return hD(Y,X);if(t(Y))return yD(Y,X);if(NY(Y))return mD(Y,X);throw Error("ValueEquals: Unable to compare value")}var uD=q0({type:Z0("insert"),path:m1(),value:uY()}),cD=q0({type:Z0("update"),path:m1(),value:uY()}),pD=q0({type:Z0("delete"),path:m1()}),x7=z0([uD,cD,pD]);class WW extends n{constructor(Y,X){super(X);this.value=Y}}function VQ(Y,X){return{type:"update",path:Y,value:X}}function b7(Y,X){return{type:"insert",path:Y,value:X}}function g7(Y){return{type:"delete",path:Y}}function T7(Y){if(globalThis.Object.getOwnPropertySymbols(Y).length>0)throw new WW(Y,"Cannot diff objects with symbols")}function*iD(Y,X,$){if(T7(X),T7($),!IZ($))return yield VQ(Y,$);let Q=globalThis.Object.getOwnPropertyNames(X),Z=globalThis.Object.getOwnPropertyNames($);for(let W of Z){if(o(X,W))continue;yield b7(`${Y}/${W}`,$[W])}for(let W of Q){if(!o($,W))continue;if(R8(X,$))continue;yield*IQ(`${Y}/${W}`,X[W],$[W])}for(let W of Q){if(o($,W))continue;yield g7(`${Y}/${W}`)}}function*lD(Y,X,$){if(!i($))return yield VQ(Y,$);for(let Q=0;Q<Math.min(X.length,$.length);Q++)yield*IQ(`${Y}/${Q}`,X[Q],$[Q]);for(let Q=0;Q<$.length;Q++){if(Q<X.length)continue;yield b7(`${Y}/${Q}`,$[Q])}for(let Q=X.length-1;Q>=0;Q--){if(Q<$.length)continue;yield g7(`${Y}/${Q}`)}}function*nD(Y,X,$){if(!PY($)||X.length!==$.length||globalThis.Object.getPrototypeOf(X).constructor.name!==globalThis.Object.getPrototypeOf($).constructor.name)return yield VQ(Y,$);for(let Q=0;Q<Math.min(X.length,$.length);Q++)yield*IQ(`${Y}/${Q}`,X[Q],$[Q])}function*oD(Y,X,$){if(X===$)return;yield VQ(Y,$)}function*IQ(Y,X,$){if(IZ(X))return yield*iD(Y,X,$);if(i(X))return yield*lD(Y,X,$);if(PY(X))return yield*nD(Y,X,$);if(NY(X))return yield*oD(Y,X,$);throw new WW(X,"Unable to diff value")}function k7(Y,X){return[...IQ("",Y,X)]}function tD(Y){return Y.length>0&&Y[0].path===""&&Y[0].type==="update"}function rD(Y){return Y.length===0}function f7(Y,X){if(tD(X))return B0(X[0].value);if(rD(X))return B0(Y);let $=B0(Y);for(let Q of X)switch(Q.type){case"insert":{sY.Set($,Q.path,Q.value);break}case"update":{sY.Set($,Q.path,Q.value);break}case"delete":{sY.Delete($,Q.path);break}}return $}function y7(...Y){let[X,$,Q]=Y.length===3?[Y[0],Y[1],Y[2]]:[Y[0],[],Y[1]],Z=TX(X,$)?J6(X,$,Q):Q;if(!s(X,$,Z))throw new t6(X,Z,UX(X,$,Z).First());return Z}function TQ(Y){return t(Y)&&!i(Y)}class JW extends n{constructor(Y){super(Y)}}function sD(Y,X,$,Q){if(!TQ($))sY.Set(Y,X,B0(Q));else{let Z=Object.getOwnPropertyNames($),W=Object.getOwnPropertyNames(Q);for(let J of Z)if(!W.includes(J))delete $[J];for(let J of W)if(!Z.includes(J))$[J]=null;for(let J of W)MW(Y,`${X}/${J}`,$[J],Q[J])}}function aD(Y,X,$,Q){if(!i($))sY.Set(Y,X,B0(Q));else{for(let Z=0;Z<Q.length;Z++)MW(Y,`${X}/${Z}`,$[Z],Q[Z]);$.splice(Q.length)}}function eD(Y,X,$,Q){if(PY($)&&$.length===Q.length)for(let Z=0;Z<$.length;Z++)$[Z]=Q[Z];else sY.Set(Y,X,B0(Q))}function Yw(Y,X,$,Q){if($===Q)return;sY.Set(Y,X,Q)}function MW(Y,X,$,Q){if(i(Q))return aD(Y,X,$,Q);if(PY(Q))return eD(Y,X,$,Q);if(TQ(Q))return sD(Y,X,$,Q);if(NY(Q))return Yw(Y,X,$,Q)}function v7(Y){return PY(Y)||NY(Y)}function Xw(Y,X){return TQ(Y)&&i(X)||i(Y)&&TQ(X)}function h7(Y,X){if(v7(Y)||v7(X))throw new JW("Only object and array types can be mutated at the root level");if(Xw(Y,X))throw new JW("Cannot assign due type mismatch of assignable values");MW(Y,"",Y,X)}class GW extends n{constructor(Y){super(Y)}}var NW;(function(Y){let X=new Map([["Assert",(W,J,M)=>{return FQ(W,J,M),M}],["Cast",(W,J,M)=>i6(W,J,M)],["Clean",(W,J,M)=>CQ(W,J,M)],["Clone",(W,J,M)=>B0(M)],["Convert",(W,J,M)=>jQ(W,J,M)],["Decode",(W,J,M)=>TX(W,J)?W6(W,J,M):M],["Default",(W,J,M)=>EQ(W,J,M)],["Encode",(W,J,M)=>TX(W,J)?J6(W,J,M):M]]);function $(W){X.delete(W)}Y.Delete=$;function Q(W,J){X.set(W,J)}Y.Set=Q;function Z(W){return X.get(W)}Y.Get=Z})(NW||(NW={}));var d7=["Clone","Clean","Default","Convert","Assert","Decode"];function $w(Y,X,$,Q){return Y.reduce((Z,W)=>{let J=NW.Get(W);if(y0(J))throw new GW(`Unable to find Parse operation '${W}'`);return J(X,$,Z)},Q)}function m7(...Y){let[X,$,Q,Z]=Y.length===4?[Y[0],Y[1],Y[2],Y[3]]:Y.length===3?i(Y[0])?[Y[0],Y[1],[],Y[2]]:[d7,Y[0],Y[1],Y[2]]:Y.length===2?[d7,Y[0],[],Y[1]]:(()=>{throw new GW("Invalid Arguments")})();return $w(X,$,Q,Z)}var F0={};wX(F0,{ValueErrorIterator:()=>C8,Patch:()=>f7,Parse:()=>m7,Mutate:()=>h7,Hash:()=>Q8,Errors:()=>UX,Equal:()=>R8,Encode:()=>y7,Edit:()=>x7,Diff:()=>k7,Default:()=>EQ,Decode:()=>V7,Create:()=>lY,Convert:()=>jQ,Clone:()=>B0,Clean:()=>CQ,Check:()=>s,Cast:()=>i6,Assert:()=>FQ});class u7{constructor(Y,X,$,Q){this.schema=Y,this.references=X,this.checkFunc=$,this.code=Q,this.hasTransform=TX(Y,X)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(Y){return UX(this.schema,this.references,Y)}Check(Y){return this.checkFunc(Y)}Decode(Y){if(!this.checkFunc(Y))throw new o6(this.schema,Y,this.Errors(Y).First());return this.hasTransform?W6(this.schema,this.references,Y):Y}Encode(Y){let X=this.hasTransform?J6(this.schema,this.references,Y):Y;if(!this.checkFunc(X))throw new t6(this.schema,Y,this.Errors(Y).First());return X}}var bX;(function(Y){function X(W){return W===36}Y.DollarSign=X;function $(W){return W===95}Y.IsUnderscore=$;function Q(W){return W>=65&&W<=90||W>=97&&W<=122}Y.IsAlpha=Q;function Z(W){return W>=48&&W<=57}Y.IsNumeric=Z})(bX||(bX={}));var xQ;(function(Y){function X(W){if(W.length===0)return!1;return bX.IsNumeric(W.charCodeAt(0))}function $(W){if(X(W))return!1;for(let J=0;J<W.length;J++){let M=W.charCodeAt(J);if(!(bX.IsAlpha(M)||bX.IsNumeric(M)||bX.DollarSign(M)||bX.IsUnderscore(M)))return!1}return!0}function Q(W){return W.replace(/'/g,"\\'")}function Z(W,J){return $(J)?`${W}.${J}`:`${W}['${Q(J)}']`}Y.Encode=Z})(xQ||(xQ={}));var UW;(function(Y){function X($){let Q=[];for(let Z=0;Z<$.length;Z++){let W=$.charCodeAt(Z);if(bX.IsNumeric(W)||bX.IsAlpha(W))Q.push($.charAt(Z));else Q.push(`_${W}_`)}return Q.join("").replace(/__/g,"_")}Y.Encode=X})(UW||(UW={}));var BW;(function(Y){function X($){return $.replace(/'/g,"\\'")}Y.Escape=X})(BW||(BW={}));class c7 extends n{constructor(Y){super("Unknown type");this.schema=Y}}class AW extends n{constructor(Y){super("Preflight validation check failed to guard for the given schema");this.schema=Y}}var j8;(function(Y){function X(J,M,N){return x0.ExactOptionalPropertyTypes?`('${M}' in ${J} ? ${N} : true)`:`(${xQ.Encode(J,M)} !== undefined ? ${N} : true)`}Y.IsExactOptionalProperty=X;function $(J){return!x0.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}))`:`(typeof ${J} === 'object' && ${J} !== null)`}Y.IsObjectLike=$;function Q(J){return!x0.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}) && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`:`(typeof ${J} === 'object' && ${J} !== null && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`}Y.IsRecordLike=Q;function Z(J){return x0.AllowNaN?`typeof ${J} === 'number'`:`Number.isFinite(${J})`}Y.IsNumberLike=Z;function W(J){return x0.AllowNullVoid?`(${J} === undefined || ${J} === null)`:`${J} === undefined`}Y.IsVoidLike=W})(j8||(j8={}));var aY;(function(Y){function X(L){return L[S]==="Any"||L[S]==="Unknown"}function*$(L,j,q){yield"true"}function*Q(L,j,q){yield"true"}function*Z(L,j,q){yield`Array.isArray(${q})`;let[F,_]=[A1("value","any"),A1("acc","number")];if(p(L.maxItems))yield`${q}.length <= ${L.maxItems}`;if(p(L.minItems))yield`${q}.length >= ${L.minItems}`;let x=Q1(L.items,j,"value");if(yield`${q}.every((${F}) => ${x})`,h0(L.contains)||p(L.minContains)||p(L.maxContains)){let m=h0(L.contains)?L.contains:r(),O0=Q1(m,j,"value"),I0=p(L.minContains)?[`(count >= ${L.minContains})`]:[],C0=p(L.maxContains)?[`(count <= ${L.maxContains})`]:[],n0=`const count = value.reduce((${_}, ${F}) => ${O0} ? acc + 1 : acc, 0)`,bY=["(count > 0)",...I0,...C0].join(" && ");yield`((${F}) => { ${n0}; return ${bY}})(${q})`}if(L.uniqueItems===!0)yield`((${F}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${q})`}function*W(L,j,q){yield`(typeof value === 'object' && Symbol.asyncIterator in ${q})`}function*J(L,j,q){if(yield`(typeof ${q} === 'bigint')`,I1(L.exclusiveMaximum))yield`${q} < BigInt(${L.exclusiveMaximum})`;if(I1(L.exclusiveMinimum))yield`${q} > BigInt(${L.exclusiveMinimum})`;if(I1(L.maximum))yield`${q} <= BigInt(${L.maximum})`;if(I1(L.minimum))yield`${q} >= BigInt(${L.minimum})`;if(I1(L.multipleOf))yield`(${q} % BigInt(${L.multipleOf})) === 0`}function*M(L,j,q){yield`(typeof ${q} === 'boolean')`}function*N(L,j,q){yield*WY(L.returns,j,`${q}.prototype`)}function*U(L,j,q){if(yield`(${q} instanceof Date) && Number.isFinite(${q}.getTime())`,p(L.exclusiveMaximumTimestamp))yield`${q}.getTime() < ${L.exclusiveMaximumTimestamp}`;if(p(L.exclusiveMinimumTimestamp))yield`${q}.getTime() > ${L.exclusiveMinimumTimestamp}`;if(p(L.maximumTimestamp))yield`${q}.getTime() <= ${L.maximumTimestamp}`;if(p(L.minimumTimestamp))yield`${q}.getTime() >= ${L.minimumTimestamp}`;if(p(L.multipleOfTimestamp))yield`(${q}.getTime() % ${L.multipleOfTimestamp}) === 0`}function*G(L,j,q){yield`(typeof ${q} === 'function')`}function*A(L,j,q){let F=globalThis.Object.getOwnPropertyNames(L.$defs).reduce((_,x)=>{return[..._,L.$defs[x]]},[]);yield*WY(_Y(L.$ref),[...j,...F],q)}function*O(L,j,q){if(yield`Number.isInteger(${q})`,p(L.exclusiveMaximum))yield`${q} < ${L.exclusiveMaximum}`;if(p(L.exclusiveMinimum))yield`${q} > ${L.exclusiveMinimum}`;if(p(L.maximum))yield`${q} <= ${L.maximum}`;if(p(L.minimum))yield`${q} >= ${L.minimum}`;if(p(L.multipleOf))yield`(${q} % ${L.multipleOf}) === 0`}function*B(L,j,q){let F=L.allOf.map((_)=>Q1(_,j,q)).join(" && ");if(L.unevaluatedProperties===!1){let _=J0(`${new RegExp(EX(L))};`),x=`Object.getOwnPropertyNames(${q}).every(key => ${_}.test(key))`;yield`(${F} && ${x})`}else if(h0(L.unevaluatedProperties)){let _=J0(`${new RegExp(EX(L))};`),x=`Object.getOwnPropertyNames(${q}).every(key => ${_}.test(key) || ${Q1(L.unevaluatedProperties,j,`${q}[key]`)})`;yield`(${F} && ${x})`}else yield`(${F})`}function*z(L,j,q){yield`(typeof value === 'object' && Symbol.iterator in ${q})`}function*H(L,j,q){if(typeof L.const==="number"||typeof L.const==="boolean")yield`(${q} === ${L.const})`;else yield`(${q} === '${BW.Escape(L.const)}')`}function*P(L,j,q){yield"false"}function*R(L,j,q){yield`(!${Q1(L.not,j,q)})`}function*D(L,j,q){yield`(${q} === null)`}function*C(L,j,q){if(yield j8.IsNumberLike(q),p(L.exclusiveMaximum))yield`${q} < ${L.exclusiveMaximum}`;if(p(L.exclusiveMinimum))yield`${q} > ${L.exclusiveMinimum}`;if(p(L.maximum))yield`${q} <= ${L.maximum}`;if(p(L.minimum))yield`${q} >= ${L.minimum}`;if(p(L.multipleOf))yield`(${q} % ${L.multipleOf}) === 0`}function*g(L,j,q){if(yield j8.IsObjectLike(q),p(L.minProperties))yield`Object.getOwnPropertyNames(${q}).length >= ${L.minProperties}`;if(p(L.maxProperties))yield`Object.getOwnPropertyNames(${q}).length <= ${L.maxProperties}`;let F=Object.getOwnPropertyNames(L.properties);for(let _ of F){let x=xQ.Encode(q,_),m=L.properties[_];if(L.required&&L.required.includes(_)){if(yield*WY(m,j,x),VX(m)||X(m))yield`('${_}' in ${q})`}else{let O0=Q1(m,j,x);yield j8.IsExactOptionalProperty(q,_,O0)}}if(L.additionalProperties===!1)if(L.required&&L.required.length===F.length)yield`Object.getOwnPropertyNames(${q}).length === ${F.length}`;else{let _=`[${F.map((x)=>`'${x}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${q}).every(key => ${_}.includes(key))`}if(typeof L.additionalProperties==="object"){let _=Q1(L.additionalProperties,j,`${q}[key]`),x=`[${F.map((m)=>`'${m}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${q}).every(key => ${x}.includes(key) || ${_}))`}}function*c(L,j,q){yield`${q} instanceof Promise`}function*f(L,j,q){if(yield j8.IsRecordLike(q),p(L.minProperties))yield`Object.getOwnPropertyNames(${q}).length >= ${L.minProperties}`;if(p(L.maxProperties))yield`Object.getOwnPropertyNames(${q}).length <= ${L.maxProperties}`;let[F,_]=Object.entries(L.patternProperties)[0],x=J0(`${new RegExp(F)}`),m=Q1(_,j,"value"),O0=h0(L.additionalProperties)?Q1(L.additionalProperties,j,q):L.additionalProperties===!1?"false":"true",I0=`(${x}.test(key) ? ${m} : ${O0})`;yield`(Object.entries(${q}).every(([key, value]) => ${I0}))`}function*y(L,j,q){let F=G0(L,j);if(l0.functions.has(L.$ref))return yield`${N1(L.$ref)}(${q})`;yield*WY(F,j,q)}function*v(L,j,q){let F=J0(`${new RegExp(L.source,L.flags)};`);if(yield`(typeof ${q} === 'string')`,p(L.maxLength))yield`${q}.length <= ${L.maxLength}`;if(p(L.minLength))yield`${q}.length >= ${L.minLength}`;yield`${F}.test(${q})`}function*E(L,j,q){if(yield`(typeof ${q} === 'string')`,p(L.maxLength))yield`${q}.length <= ${L.maxLength}`;if(p(L.minLength))yield`${q}.length >= ${L.minLength}`;if(L.pattern!==void 0)yield`${J0(`${new RegExp(L.pattern)};`)}.test(${q})`;if(L.format!==void 0)yield`format('${L.format}', ${q})`}function*k(L,j,q){yield`(typeof ${q} === 'symbol')`}function*b(L,j,q){yield`(typeof ${q} === 'string')`,yield`${J0(`${new RegExp(L.pattern)};`)}.test(${q})`}function*u(L,j,q){yield`${N1(L.$ref)}(${q})`}function*h(L,j,q){if(yield`Array.isArray(${q})`,L.items===void 0)return yield`${q}.length === 0`;yield`(${q}.length === ${L.maxItems})`;for(let F=0;F<L.items.length;F++)yield`${Q1(L.items[F],j,`${q}[${F}]`)}`}function*L0(L,j,q){yield`${q} === undefined`}function*l(L,j,q){yield`(${L.anyOf.map((_)=>Q1(_,j,q)).join(" || ")})`}function*$1(L,j,q){if(yield`${q} instanceof Uint8Array`,p(L.maxByteLength))yield`(${q}.length <= ${L.maxByteLength})`;if(p(L.minByteLength))yield`(${q}.length >= ${L.minByteLength})`}function*l1(L,j,q){yield"true"}function*KY(L,j,q){yield j8.IsVoidLike(q)}function*P1(L,j,q){let F=l0.instances.size;l0.instances.set(F,L),yield`kind('${L[S]}', ${F}, ${q})`}function*WY(L,j,q,F=!0){let _=M0(L.$id)?[...j,L]:j,x=L;if(F&&M0(L.$id)){let m=N1(L.$id);if(l0.functions.has(m))return yield`${m}(${q})`;else{l0.functions.set(m,"<deferred>");let O0=Y1(m,L,j,"value",!1);return l0.functions.set(m,O0),yield`${m}(${q})`}}switch(x[S]){case"Any":return yield*$(x,_,q);case"Argument":return yield*Q(x,_,q);case"Array":return yield*Z(x,_,q);case"AsyncIterator":return yield*W(x,_,q);case"BigInt":return yield*J(x,_,q);case"Boolean":return yield*M(x,_,q);case"Constructor":return yield*N(x,_,q);case"Date":return yield*U(x,_,q);case"Function":return yield*G(x,_,q);case"Import":return yield*A(x,_,q);case"Integer":return yield*O(x,_,q);case"Intersect":return yield*B(x,_,q);case"Iterator":return yield*z(x,_,q);case"Literal":return yield*H(x,_,q);case"Never":return yield*P(x,_,q);case"Not":return yield*R(x,_,q);case"Null":return yield*D(x,_,q);case"Number":return yield*C(x,_,q);case"Object":return yield*g(x,_,q);case"Promise":return yield*c(x,_,q);case"Record":return yield*f(x,_,q);case"Ref":return yield*y(x,_,q);case"RegExp":return yield*v(x,_,q);case"String":return yield*E(x,_,q);case"Symbol":return yield*k(x,_,q);case"TemplateLiteral":return yield*b(x,_,q);case"This":return yield*u(x,_,q);case"Tuple":return yield*h(x,_,q);case"Undefined":return yield*L0(x,_,q);case"Union":return yield*l(x,_,q);case"Uint8Array":return yield*$1(x,_,q);case"Unknown":return yield*l1(x,_,q);case"Void":return yield*KY(x,_,q);default:if(!z1.Has(x[S]))throw new c7(L);return yield*P1(x,_,q)}}let l0={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function Q1(L,j,q,F=!0){return`(${[...WY(L,j,q,F)].join(" && ")})`}function N1(L){return`check_${UW.Encode(L)}`}function J0(L){let j=`local_${l0.variables.size}`;return l0.variables.set(j,`const ${j} = ${L}`),j}function Y1(L,j,q,F,_=!0){let[x,m]=[`
`,(n0)=>"".padStart(n0," ")],O0=A1("value","any"),I0=F1("boolean"),C0=[...WY(j,q,F,_)].map((n0)=>`${m(4)}${n0}`).join(` &&${x}`);return`function ${L}(${O0})${I0} {${x}${m(2)}return (${x}${C0}${x}${m(2)})
}`}function A1(L,j){let q=l0.language==="typescript"?`: ${j}`:"";return`${L}${q}`}function F1(L){return l0.language==="typescript"?`: ${L}`:""}function OX(L,j,q){let F=Y1("check",L,j,"value"),_=A1("value","any"),x=F1("boolean"),m=[...l0.functions.values()],O0=[...l0.variables.values()],I0=M0(L.$id)?`return function check(${_})${x} {
  return ${N1(L.$id)}(value)
}`:`return ${F}`;return[...O0,...m,I0].join(`
`)}function DX(...L){let j={language:"javascript"},[q,F,_]=L.length===2&&i(L[1])?[L[0],L[1],j]:L.length===2&&!i(L[1])?[L[0],[],L[1]]:L.length===3?[L[0],L[1],L[2]]:L.length===1?[L[0],[],j]:[null,[],j];if(l0.language=_.language,l0.variables.clear(),l0.functions.clear(),l0.instances.clear(),!h0(q))throw new AW(q);for(let x of F)if(!h0(x))throw new AW(x);return OX(q,F,_)}Y.Code=DX;function V6(L,j=[]){let q=DX(L,j,{language:"javascript"}),F=globalThis.Function("kind","format","hash",q),_=new Map(l0.instances);function x(C0,n0,bY){if(!z1.Has(C0)||!_.has(n0))return!1;let z8=z1.Get(C0),l$=_.get(n0);return z8(l$,bY)}function m(C0,n0){if(!w0.Has(C0))return!1;return w0.Get(C0)(n0)}function O0(C0){return Q8(C0)}let I0=F(x,m,O0);return new u7(L,j,I0,q)}Y.Compile=V6})(aY||(aY={}));var VL=Object.create,{getPrototypeOf:IL,defineProperty:eM,getOwnPropertyNames:TL}=Object,xL=Object.prototype.hasOwnProperty,S$=(Y,X,$)=>{$=Y!=null?VL(IL(Y)):{};let Q=X||!Y||!Y.__esModule?eM($,"default",{value:Y,enumerable:!0}):$;for(let Z of TL(Y))if(!xL.call(Q,Z))eM(Q,Z,{get:()=>Y[Z],enumerable:!0});return Q},EN=(Y,X)=>()=>(X||Y((X={exports:{}}).exports,X),X.exports);var WZ=EN((Y,X)=>{var $=12,Q=0,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7];function W(N){var U=N.indexOf("%");if(U===-1)return N;var G=N.length,A="",O=0,B=0,z=U,H=$;while(U>-1&&U<G){var P=M(N[U+1],4),R=M(N[U+2],0),D=P|R,C=Z[D];if(H=Z[256+H+C],B=B<<6|D&Z[364+C],H===$)A+=N.slice(O,z),A+=B<=65535?String.fromCharCode(B):String.fromCharCode(55232+(B>>10),56320+(B&1023)),B=0,O=U+3,U=z=N.indexOf("%",O);else if(H===Q)return null;else{if(U+=3,U<G&&N.charCodeAt(U)===37)continue;return null}}return A+N.slice(O)}var J={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};function M(N,U){var G=J[N];return G===void 0?255:G<<U}X.exports=W}),bL=EN((Y)=>{Object.defineProperty(Y,"__esModule",{value:!0}),Y.parse=M,Y.serialize=G;var X=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,$=/^[\u0021-\u003A\u003C-\u007E]*$/,Q=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Z=/^[\u0020-\u003A\u003D-\u007E]*$/,W=Object.prototype.toString,J=(()=>{let B=function(){};return B.prototype=Object.create(null),B})();function M(B,z){let H=new J,P=B.length;if(P<2)return H;let R=z?.decode||A,D=0;do{let C=B.indexOf("=",D);if(C===-1)break;let g=B.indexOf(";",D),c=g===-1?P:g;if(C>c){D=B.lastIndexOf(";",C-1)+1;continue}let f=N(B,D,C),y=U(B,C,f),v=B.slice(f,y);if(H[v]===void 0){let E=N(B,C+1,c),k=U(B,c,E),b=R(B.slice(E,k));H[v]=b}D=c+1}while(D<P);return H}function N(B,z,H){do{let P=B.charCodeAt(z);if(P!==32&&P!==9)return z}while(++z<H);return H}function U(B,z,H){while(z>H){let P=B.charCodeAt(--z);if(P!==32&&P!==9)return z+1}return H}function G(B,z,H){let P=H?.encode||encodeURIComponent;if(!X.test(B))throw TypeError(`argument name is invalid: ${B}`);let R=P(z);if(!$.test(R))throw TypeError(`argument val is invalid: ${z}`);let D=B+"="+R;if(!H)return D;if(H.maxAge!==void 0){if(!Number.isInteger(H.maxAge))throw TypeError(`option maxAge is invalid: ${H.maxAge}`);D+="; Max-Age="+H.maxAge}if(H.domain){if(!Q.test(H.domain))throw TypeError(`option domain is invalid: ${H.domain}`);D+="; Domain="+H.domain}if(H.path){if(!Z.test(H.path))throw TypeError(`option path is invalid: ${H.path}`);D+="; Path="+H.path}if(H.expires){if(!O(H.expires)||!Number.isFinite(H.expires.valueOf()))throw TypeError(`option expires is invalid: ${H.expires}`);D+="; Expires="+H.expires.toUTCString()}if(H.httpOnly)D+="; HttpOnly";if(H.secure)D+="; Secure";if(H.partitioned)D+="; Partitioned";if(H.priority)switch(typeof H.priority==="string"?H.priority.toLowerCase():void 0){case"low":D+="; Priority=Low";break;case"medium":D+="; Priority=Medium";break;case"high":D+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${H.priority}`)}if(H.sameSite)switch(typeof H.sameSite==="string"?H.sameSite.toLowerCase():H.sameSite){case!0:case"strict":D+="; SameSite=Strict";break;case"lax":D+="; SameSite=Lax";break;case"none":D+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${H.sameSite}`)}return D}function A(B){if(B.indexOf("%")===-1)return B;try{return decodeURIComponent(B)}catch(z){return B}}function O(B){return W.call(B)==="[object Date]"}}),z6=(Y,X)=>{let $=X?.length?{}:null;if($)for(let Q of X)$[Q.part.charCodeAt(0)]=Q;return{part:Y,store:null,inert:$,params:null,wildcardStore:null}},YN=(Y,X)=>({...Y,part:X}),XN=(Y)=>({name:Y,store:null,inert:null});class K6{config;root={};history=[];deferred=[];constructor(Y={}){if(this.config=Y,Y.lazy)this.find=this.lazyFind;if(Y.onParam&&!Array.isArray(Y.onParam))this.config.onParam=[this.config.onParam]}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/(\/:\w+\?)/g};lazyFind=(Y,X)=>{if(!this.config.lazy)return this.find;return this.build(),this.find(Y,X)};build(){if(!this.config.lazy)return;for(let[Y,X,$]of this.deferred)this.add(Y,X,$,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=(Y,X)=>{let $=this.root[Y];if(!$)return null;return oQ(X,X.length,$,0,this.config.onParam)}}add(Y,X,$,{ignoreError:Q=!1,ignoreHistory:Z=!1,lazy:W=this.config.lazy}={}){if(W)return this.find=this.lazyFind,this.deferred.push([Y,X,$]),$;if(typeof X!=="string")throw TypeError("Route path must be a string");if(X==="")X="/";else if(X[0]!=="/")X=`/${X}`;let J=X[X.length-1]==="*",M=X.match(K6.regex.optionalParams);if(M){let O=X.replaceAll("?","");this.add(Y,O,$,{ignoreError:Q,ignoreHistory:Z,lazy:W});for(let B=0;B<M.length;B++){let z=X.replace(M[B],"");this.add(Y,z,$,{ignoreError:!0,ignoreHistory:Z,lazy:W})}return $}if(M)X=X.replaceAll("?","");if(this.history.find(([O,B,z])=>O===Y&&B===X))return $;if(J||M&&X.charCodeAt(X.length-1)===63)X=X.slice(0,-1);if(!Z)this.history.push([Y,X,$]);let N=X.split(K6.regex.static),U=X.match(K6.regex.params)||[];if(N[N.length-1]==="")N.pop();let G;if(!this.root[Y])G=this.root[Y]=z6("/");else G=this.root[Y];let A=0;for(let O=0;O<N.length;++O){let B=N[O];if(O>0){let z=U[A++].slice(1);if(G.params===null)G.params=XN(z);else if(G.params.name!==z)if(Q)return $;else throw Error(`Cannot create route "${X}" with parameter "${z}" because a route already exists with a different parameter name ("${G.params.name}") in the same location`);let H=G.params;if(H.inert===null){G=H.inert=z6(B);continue}G=H.inert}for(let z=0;;){if(z===B.length){if(z<G.part.length){let H=YN(G,G.part.slice(z));Object.assign(G,z6(B,[H]))}break}if(z===G.part.length){if(G.inert===null)G.inert={};let H=G.inert[B.charCodeAt(z)];if(H){G=H,B=B.slice(z),z=0;continue}let P=z6(B.slice(z));G.inert[B.charCodeAt(z)]=P,G=P;break}if(B[z]!==G.part[z]){let H=YN(G,G.part.slice(z)),P=z6(B.slice(z));Object.assign(G,z6(G.part.slice(0,z),[H,P])),G=P;break}++z}}if(A<U.length){let O=U[A].slice(1);if(G.params===null)G.params=XN(O);else if(G.params.name!==O)if(Q)return $;else throw Error(`Cannot create route "${X}" with parameter "${O}" because a route already exists with a different parameter name ("${G.params.name}") in the same location`);if(G.params.store===null)G.params.store=$;return G.params.store}if(J){if(G.wildcardStore===null)G.wildcardStore=$;return G.wildcardStore}if(G.store===null)G.store=$;return G.store}find(Y,X){let $=this.root[Y];if(!$)return null;return oQ(X,X.length,$,0,this.config.onParam)}}var oQ=(Y,X,$,Q,Z)=>{let W=$.part,J=W.length,M=Q+J;if(J>1){if(M>X)return null;if(J<15){for(let N=1,U=Q+1;N<J;++N,++U)if(W.charCodeAt(N)!==Y.charCodeAt(U))return null}else if(Y.slice(Q,M)!==W)return null}if(M===X){if($.store!==null)return{store:$.store,params:{}};if($.wildcardStore!==null)return{store:$.wildcardStore,params:{"*":""}};return null}if($.inert!==null){let N=$.inert[Y.charCodeAt(M)];if(N!==void 0){let U=oQ(Y,X,N,M,Z);if(U!==null)return U}}if($.params!==null){let{store:N,name:U,inert:G}=$.params,A=Y.indexOf("/",M);if(A!==M){if(A===-1||A>=X){if(N!==null){let O={};if(O[U]=Y.substring(M,X),Z)for(let B=0;B<Z.length;B++){let z=Z[B](O[U],U);if(z!==void 0)O[U]=z}return{store:N,params:O}}}else if(G!==null){let O=oQ(Y,X,G,A,Z);if(O!==null){if(O.params[U]=Y.substring(M,A),Z)for(let B=0;B<Z.length;B++){let z=Z[B](O.params[U],U);if(z!==void 0)O.params[U]=z}return O}}}}if($.wildcardStore!==null)return{store:$.wildcardStore,params:{"*":Y.substring(M,X)}};return null},$N=S$(WZ(),1),P6=typeof Bun<"u",VN={aac:"audio/aac",abw:"application/x-abiword",ai:"application/postscript",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",dll:"application/octet-stream",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi",midi:"audio/midi",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpa:"video/mpeg",mpe:"video/mpeg",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/x-wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",xlsx_OLD:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3gp_DOES_NOT_CONTAIN_VIDEO":"audio/3gpp","3gp2":"video/3gpp2","3gp2_DOES_NOT_CONTAIN_VIDEO":"audio/3gpp2","7z":"application/x-7z-compressed"},gL=(Y)=>{let X=Y.lastIndexOf(".");if(X===-1)return"";return Y.slice(X+1)};var yW,vW;class tQ{path;value;stats;constructor(Y){if(this.path=Y,P6)this.value=Bun.file(Y);else{if(!yW||!vW){if(typeof window<"u"){console.warn("Browser environment does not support file");return}let X=(Q)=>console.warn(Error(`[elysia] \`file\` require \`fs${Q?"."+Q:""}\` ${Q?.includes(".")?"module ":""}which is not available in this environment`));if(typeof process>"u"||typeof process.getBuiltinModule!=="function"){X();return}let $=process.getBuiltinModule("fs");if(!$){X();return}if(typeof $.createReadStream!=="function"){X();return}if(typeof $.promises?.stat!=="function"){X();return}yW=$.createReadStream,vW=$.promises.stat}this.value=(()=>yW(Y))(),this.stats=vW(Y)}}get type(){return VN[gL(this.path)]||"application/octet-stream"}get length(){if(P6)return this.value.size;return this.stats?.then((Y)=>Y.size)??0}}var tW="toJSON"in new Headers,QN=(Y,X)=>{let $=new URL(Y);return $.pathname=X,$.toString()},kL=(Y)=>typeof Y==="function"&&/^\s*class\s+/.test(Y.toString())||Y.toString&&Y.toString().startsWith("[object ")&&Y.toString()!=="[object Object]"||d0(Object.getPrototypeOf(Y)),hW=(Y)=>Y&&typeof Y==="object"&&!Array.isArray(Y),E1=(Y,X,$)=>{let Q=$?.skipKeys,Z=$?.override??!0,W=$?.mergeArray??!1;if(!hW(Y)||!hW(X))return Y;for(let[J,M]of Object.entries(X)){if(Q?.includes(J))continue;if(W&&Array.isArray(M)){Y[J]=Array.isArray(Y[J])?[...Y[J],...M]:Y[J]=M;continue}if(!hW(M)||!(J in Y)||kL(M)){if((Z||!(J in Y))&&!Object.isFrozen(Y))try{Y[J]=M}catch{}continue}if(!Object.isFrozen(Y[J]))try{Y[J]=E1(Y[J],M,{skipKeys:Q,override:Z,mergeArray:W})}catch{}}return Y},rW=(Y,X)=>{let $=E1(Object.assign({},Y),X,{skipKeys:["properties"],mergeArray:!1});if($.properties)delete $.properties;return $},a0=(Y,X)=>{if(!X)return Y;let $=[],Q=[];if(Y){if(!Array.isArray(Y))Y=[Y];for(let Z of Y)if($.push(Z),Z.checksum)Q.push(Z.checksum)}if(X){if(!Array.isArray(X))X=[X];for(let Z of X)if(!Q.includes(Z.checksum))$.push(Z)}return $},fL=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],qy=fL.reduce((Y,X)=>(Y[X]=!0,Y),{}),pQ=(Y)=>typeof Y==="object"&&Object.keys(Y).every((X)=>!isNaN(+X)),IN=(Y,X)=>{if(pQ(Y)&&pQ(X))return Object.assign({},Y,X);else if(Y&&!pQ(Y)&&pQ(X))return Object.assign({200:Y},X);return X??Y},J$=(Y,X)=>{if(!Y&&!X)return{body:void 0,headers:void 0,params:void 0,query:void 0,cookie:void 0,response:void 0};return{body:X?.body??Y?.body,headers:X?.headers??Y?.headers,params:X?.params??Y?.params,query:X?.query??Y?.query,cookie:X?.cookie??Y?.cookie,response:IN(Y?.response,X?.response)}},x8=(Y,X)=>{if(!X)return Y??{};if(!Y)return X??{};if(!Object.values(X).find((Q)=>Q!==void 0&&Q!==null))return{...Y};let $={...Y,...X,body:X.body??Y.body,headers:X.headers??Y.headers,params:X.params??Y.params,query:X.query??Y.query,cookie:X.cookie??Y.cookie,response:IN(Y.response,X.response),type:Y.type||X.type,detail:E1(X.detail??{},Y.detail??{}),parse:a0(Y.parse,X.parse),transform:a0(Y.transform,X.transform),beforeHandle:a0(a0(D1(Y.resolve,"resolve"),Y.beforeHandle),a0(D1(X.resolve,"resolve"),X.beforeHandle)),afterHandle:a0(Y.afterHandle,X.afterHandle),mapResponse:a0(Y.mapResponse,X.mapResponse),afterResponse:a0(Y.afterResponse,X.afterResponse),trace:a0(Y.trace,X.trace),error:a0(Y.error,X.error),standaloneSchema:Y.standaloneSchema||X.standaloneSchema?Y.standaloneSchema&&!X.standaloneSchema?Y.standaloneSchema:X.standaloneSchema&&!Y.standaloneSchema?X.standaloneSchema:[...Y.standaloneSchema??[],...X.standaloneSchema??[]]:void 0};if($.resolve)delete $.resolve;return $},yL=(Y)=>{if(Y.parse&&!Array.isArray(Y.parse))Y.parse=[Y.parse];if(Y.transform&&!Array.isArray(Y.transform))Y.transform=[Y.transform];if(Y.afterHandle&&!Array.isArray(Y.afterHandle))Y.afterHandle=[Y.afterHandle];if(Y.mapResponse&&!Array.isArray(Y.mapResponse))Y.mapResponse=[Y.mapResponse];if(Y.afterResponse&&!Array.isArray(Y.afterResponse))Y.afterResponse=[Y.afterResponse];if(Y.trace&&!Array.isArray(Y.trace))Y.trace=[Y.trace];if(Y.error&&!Array.isArray(Y.error))Y.error=[Y.error];let X=[];if(Y.resolve)X=D1(Array.isArray(Y.resolve)?Y.resolve:[Y.resolve],"resolve"),delete Y.resolve;if(Y.beforeHandle)if(X.length)X=X.concat(Array.isArray(Y.beforeHandle)?Y.beforeHandle:[Y.beforeHandle]);else X=Array.isArray(Y.beforeHandle)?Y.beforeHandle:[Y.beforeHandle];if(X.length)Y.beforeHandle=X;return Y},vL=typeof Bun<"u",Oy=vL&&typeof Bun.hash==="function",N$=(Y)=>{let X=9;for(let $=0;$<Y.length;)X=Math.imul(X^Y.charCodeAt($++),387420489);return X=X^X>>>9},YX=(Y,X)=>{if(!X)return;if(!Array.isArray(X)){let Q=X;if(Y&&!Q.checksum)Q.checksum=Y;if(Q.scope==="scoped")Q.scope="local";return Q}let $=[...X];for(let Q of $){if(Y&&!Q.checksum)Q.checksum=Y;if(Q.scope==="scoped")Q.scope="local"}return $},ZN=(Y,X,$)=>{return{start:a0(Y.start,YX($,X?.start)),request:a0(Y.request,YX($,X?.request)),parse:a0(Y.parse,YX($,X?.parse)),transform:a0(Y.transform,YX($,X?.transform)),beforeHandle:a0(a0(D1(Y.resolve,"resolve"),Y.beforeHandle),YX($,a0(D1(X?.resolve,"resolve"),X?.beforeHandle))),afterHandle:a0(Y.afterHandle,YX($,X?.afterHandle)),mapResponse:a0(Y.mapResponse,YX($,X?.mapResponse)),afterResponse:a0(Y.afterResponse,YX($,X?.afterResponse)),trace:a0(Y.trace,YX($,X?.trace)),error:a0(Y.error,YX($,X?.error)),stop:a0(Y.stop,YX($,X?.stop))}},hL=(Y,X,{skipIfHasType:$=!1})=>{if(!Y)return Y;if(!Array.isArray(Y)){if($)Y.scope??=X;else Y.scope=X;return Y}for(let Q of Y)if($)Q.scope??=X;else Q.scope=X;return Y},J8=(Y)=>{if(!Y)return Y;if(!Array.isArray(Y))switch(Y.scope){case"global":case"scoped":return{...Y};default:return{fn:Y}}let X=[];for(let $ of Y)switch($.scope){case"global":case"scoped":X.push({...$});break}return X},WN=(Y)=>{return{...Y,type:Y?.type,detail:Y?.detail,parse:J8(Y?.parse),transform:J8(Y?.transform),beforeHandle:J8(Y?.beforeHandle),afterHandle:J8(Y?.afterHandle),mapResponse:J8(Y?.mapResponse),afterResponse:J8(Y?.afterResponse),error:J8(Y?.error),trace:J8(Y?.trace)}},D$={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Enhance Your Calm":420,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},JN=Object.fromEntries(Object.entries(D$).map(([Y,X])=>[X,Y]));function dL(Y){let X=Y;while(X.endsWith("="))X=X.slice(0,-1);return X}var MN=new TextEncoder,rQ=async(Y,X)=>{if(typeof Y==="object")Y=JSON.stringify(Y);else if(typeof Y!=="string")Y=Y+"";if(X===null)throw TypeError("Secret key must be provided.");let $=await crypto.subtle.importKey("raw",MN.encode(X),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Q=await crypto.subtle.sign("HMAC",$,MN.encode(Y));return Y+"."+dL(Buffer.from(Q).toString("base64"))},NN=async(Y,X)=>{if(typeof Y!=="string")throw TypeError("Signed cookie string must be provided.");if(X===null)throw TypeError("Secret key must be provided.");let $=Y.slice(0,Y.lastIndexOf("."));return await rQ($,X)===Y?$:!1},mL=(Y,X,$)=>{if(!Y.standaloneValidator?.length||!Array.isArray(Y.standaloneValidator)){Y.standaloneValidator=[{[X]:$}];return}let Q=Y.standaloneValidator[Y.standaloneValidator.length-1];if(X in Q)Y.standaloneValidator.push({[X]:$});else Q[X]=$},uL=(Y)=>{if(typeof Y==="number")return Y;if(Y.length<16){if(Y.trim().length===0)return null;let X=Number(Y);if(Number.isNaN(X))return null;return X}if(Y.length===16){if(Y.trim().length===0)return null;let X=Number(Y);if(Number.isNaN(X)||X.toString()!==Y)return null;return X}return null},TN=(Y)=>uL(Y)!==null;class xN{onError;onFinally;root=null;promises=[];constructor(Y=console.error,X=()=>{}){this.onError=Y,this.onFinally=X}get size(){return this.promises.length}add(Y){if(this.promises.push(Y),this.root||=this.drain(),this.promises.length===1)this.then(this.onFinally);return Y}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch(Y){this.onError(Y)}this.promises.shift()}this.root=null}then(Y,X){return(this.root??Promise.resolve()).then(Y,X)}}var D1=(Y,X)=>{if(!Y)return Y;if(!Array.isArray(Y)){if(typeof Y==="function"||typeof Y==="string")return X?{fn:Y,subType:X}:{fn:Y};else if("fn"in Y)return Y}let $=[];for(let Q of Y)if(typeof Q==="function"||typeof Q==="string")$.push(X?{fn:Q,subType:X}:{fn:Q});else if("fn"in Q)$.push(Q);return $},GN=(Y)=>{if(Y.start)Y.start=D1(Y.start);if(Y.request)Y.request=D1(Y.request);if(Y.parse)Y.parse=D1(Y.parse);if(Y.transform)Y.transform=D1(Y.transform);if(Y.beforeHandle)Y.beforeHandle=D1(Y.beforeHandle);if(Y.afterHandle)Y.afterHandle=D1(Y.afterHandle);if(Y.mapResponse)Y.mapResponse=D1(Y.mapResponse);if(Y.afterResponse)Y.afterResponse=D1(Y.afterResponse);if(Y.trace)Y.trace=D1(Y.trace);if(Y.error)Y.error=D1(Y.error);if(Y.stop)Y.stop=D1(Y.stop);return Y},UN=(Y)=>{let X=Object.create(null);if(Y.start?.map)X.start=Y.start.map(($)=>$.fn);if(Y.request?.map)X.request=Y.request.map(($)=>$.fn);if(Y.parse?.map)X.parse=Y.parse.map(($)=>$.fn);if(Y.transform?.map)X.transform=Y.transform.map(($)=>$.fn);if(Y.beforeHandle?.map)X.beforeHandle=Y.beforeHandle.map(($)=>$.fn);if(Y.afterHandle?.map)X.afterHandle=Y.afterHandle.map(($)=>$.fn);if(Y.mapResponse?.map)X.mapResponse=Y.mapResponse.map(($)=>$.fn);if(Y.afterResponse?.map)X.afterResponse=Y.afterResponse.map(($)=>$.fn);if(Y.error?.map)X.error=Y.error.map(($)=>$.fn);if(Y.stop?.map)X.stop=Y.stop.map(($)=>$.fn);if(Y.trace?.map)X.trace=Y.trace.map(($)=>$.fn);else X.trace=[];return X},BN=(Y)=>({body:Y.body,cookie:Y.cookie,headers:Y.headers,query:Y.query,set:Y.set,server:Y.server,path:Y.path,route:Y.route,url:Y.url}),JZ=(Y,X=302)=>Response.redirect(Y,X),b8=Symbol("ElysiaFormData"),P$=Symbol("ElysiaRequestId"),cL=(Y)=>{let X=new FormData;if(X[b8]={},Y)for(let[$,Q]of Object.entries(Y)){if(Array.isArray(Q)){X[b8][$]=[];for(let Z of Q){if(Q instanceof File)X.append($,Q,Q.name);else if(Q instanceof tQ)X.append($,Q.value,Q.value?.name);else X.append($,Q);X[b8][$].push(Q)}continue}if(Q instanceof File)X.append($,Q,Q.name);else if(Q instanceof tQ)X.append($,Q.value,Q.value?.name);else X.append($,Q);X[b8][$]=Q}return X},MZ=typeof crypto>"u"?()=>{let Y="",X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",$=X.length;for(let Q=0;Q<16;Q++)Y+=X.charAt(Math.floor(Math.random()*$));return Y}:()=>{let Y=crypto.randomUUID();return Y.slice(0,8)+Y.slice(24,32)},pL=(Y)=>{if(!Y.length)return[];let X=[];for(let $=0;$<Y.length;$++){let Q=Y[$];if(Q.checksum){if(X.includes(Q.checksum))Y.splice($,1),$--;X.push(Q.checksum)}}return Y},M8=(Y,X="scoped")=>{if(!Y)return;if(X==="scoped"){for(let $ of Y)if("scope"in $&&$.scope==="local")$.scope="scoped";return}for(let $ of Y)if("scope"in $)$.scope="global"},G$=(Y)=>{if(Y.charCodeAt(Y.length-1)===47)return Y.slice(0,Y.length-1);return Y+"/"},d0=(Y)=>{if(!Y)return!1;for(let X in Y)return!0;return!1},U$=(Y,{dynamic:X=!1}={})=>{let $=encodeURIComponent(Y).replace(/%2F/g,"/");if(X)$=$.replace(/%3A/g,":").replace(/%3F/g,"?");return $},bN=(()=>{if(typeof Bun>"u")return!0;if(Bun.semver?.satisfies?.(Bun.version,">=1.2.14"))return!0;return!1})();async function iL(Y){if(Y.bodyUsed||!Y.body)return 0;let X=0,$=Y.body.getReader();while(!0){let{done:Q,value:Z}=await $.read();if(Q)break;X+=Z.byteLength}return X}var lL={headers:!0,cookie:!0,query:!0,params:!0,body:!0,response:!0},AN=typeof Bun<"u"?Bun.env:typeof process<"u"?process?.env:void 0,sQ=Symbol("ElysiaErrorCode"),G8=(AN?.NODE_ENV??AN?.ENV)==="production",nL={101:void 0,204:void 0,205:void 0,304:void 0,307:void 0,308:void 0};class V1{code;response;constructor(Y,X){let $=X??(Y in JN?JN[Y]:Y);if(this.code=D$[Y]??Y,Y in nL)this.response=void 0;else this.response=$}}var m0=(Y,X)=>new V1(Y,X);class J4 extends Error{code="NOT_FOUND";status=404;constructor(Y){super(Y??"NOT_FOUND")}}class gN extends Error{code="PARSE";status=400;constructor(Y){super("Bad Request",{cause:Y})}}class sW extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor(Y,X){super(X??`"${Y}" has invalid cookie signature`);this.key=Y}}var x1=(Y)=>{if(!Y)return{summary:void 0};let{message:X,path:$,value:Q,type:Z}=Y,W=$.slice(1).replaceAll("/","."),J=$==="";switch(Z){case 42:return{...Y,summary:J?"Value should not be provided":`Property '${W}' should not be provided`};case 45:return{...Y,summary:J?"Value is missing":`Property '${W}' is missing`};case 50:let M=X.indexOf("'"),N=X.slice(M+1,X.indexOf("'",M+1));return{...Y,summary:J?"Value should be an email":`Property '${W}' should be ${N}`};case 54:return{...Y,summary:`${X.slice(0,9).trim()} property '${W}' to be ${X.slice(8).trim()} but found: ${Q}`};case 62:let U=Y.schema.anyOf.map((G)=>`'${G?.format??G.type}'`).join(", ");return{...Y,summary:J?`Value should be one of ${U}`:`Property '${W}' should be one of: ${U}`};default:return{summary:X,...Y}}};class z$ extends Error{property;expected;message;code="INVALID_FILE_TYPE";status=422;constructor(Y,X,$=`"${Y}" has invalid file type`){super($);this.property=Y,this.expected=X,this.message=$,Object.setPrototypeOf(this,z$.prototype)}toResponse(Y){if(G8)return new Response(JSON.stringify({type:"validation",on:"body"}),{status:422,headers:{...Y,"content-type":"application/json"}});return new Response(JSON.stringify({type:"validation",on:"body",summary:"Invalid file type",message:this.message,property:this.property,expected:this.expected}),{status:422,headers:{...Y,"content-type":"application/json"}})}}class D0 extends Error{type;validator;value;allowUnsafeValidationDetails;code="VALIDATION";status=422;valueError;expected;customError;constructor(Y,X,$,Q=!1,Z){let W="",J,M,N;if(X?.provider==="standard"||"~standard"in X||X.schema&&"~standard"in X.schema){let U=("~standard"in X?X:X.schema)["~standard"];if(J=(Z??U.validate($).issues)?.[0],G8)W=JSON.stringify({type:"validation",on:Y,found:$});else W=JSON.stringify({type:"validation",on:Y,property:J.path?.[0]||"root",message:J?.message,summary:J?.problem,expected:M,found:$,errors:Z},null,2);N=J?.message}else{if($&&typeof $==="object"&&$ instanceof V1)$=$.response;J=Z?.First()??("Errors"in X?X.Errors($).First():F0.Errors(X,$).First());let U=J?.path||"root",G=X?.schema??X;if(!G8&&!Q)try{M=F0.Create(G)}catch(A){M={type:"Could not create expected value",message:A?.message,error:A}}if(N=J?.schema?.message||J?.schema?.error!==void 0?typeof J.schema.error==="function"?J.schema.error(G8&&!Q?{type:"validation",on:Y,found:$}:{type:"validation",on:Y,value:$,property:U,message:J?.message,summary:x1(J).summary,found:$,expected:M,errors:"Errors"in X?[...X.Errors($)].map(x1):[...F0.Errors(X,$)].map(x1)},X):J.schema.error:void 0,N!==void 0)W=typeof N==="object"?JSON.stringify(N):N+"";else if(G8&&!Q)W=JSON.stringify({type:"validation",on:Y,found:$});else W=JSON.stringify({type:"validation",on:Y,property:U,message:J?.message,summary:x1(J).summary,expected:M,found:$,errors:"Errors"in X?[...X.Errors($)].map(x1):[...F0.Errors(X,$)].map(x1)},null,2)}super(W);this.type=Y,this.validator=X,this.value=$,this.allowUnsafeValidationDetails=Q,this.valueError=J,this.expected=M,this.customError=N,Object.setPrototypeOf(this,D0.prototype)}get all(){if(this.validator?.provider==="standard"||"~standard"in this.validator||"schema"in this.validator&&this.validator.schema&&"~standard"in this.validator.schema)return("~standard"in this.validator?this.validator:this.validator.schema)["~standard"].validate(this.value).issues?.map((Y)=>({summary:Y.message,path:Y.path?.join(".")||"root",message:Y.message,value:this.value}))||[];return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(x1):[...F0.Errors(this.validator,this.value)].map(x1)}static simplifyModel(Y){let X="schema"in Y?Y.schema:Y;try{return F0.Create(X)}catch{return X}}get model(){if("~standard"in this.validator)return this.validator;return D0.simplifyModel(this.validator)}toResponse(Y){return new Response(this.message,{status:400,headers:{...Y,"content-type":"application/json"}})}detail(Y){if(!this.customError)return this.message;let X=this.validator,$=this.value,Q=this.expected,Z=this.all;return G8&&!this.allowUnsafeValidationDetails?{type:"validation",on:this.type,found:$,message:Y}:{type:"validation",on:this.type,property:this.valueError?.path||"root",message:Y,summary:x1(this.valueError).summary,found:$,expected:Q,errors:Z}}}var M$=(Y,X)=>{try{return JSON.parse(Y)}catch{throw new D0("property",X,Y)}};function F$(Y,X){if(!z1.Has(Y))z1.Set(Y,X);return($={})=>SQ({...$,[S]:Y})}var kX=(Y)=>{try{let X=aY.Compile(Y);return X.Create=()=>F0.Create(Y),X.Error=($)=>new D0("property",Y,$,X.Errors($)),X}catch{return{Check:(X)=>F0.Check(Y,X),CheckThrow:(X)=>{if(!F0.Check(Y,X))throw new D0("property",Y,X,F0.Errors(Y,X))},Decode:(X)=>F0.Decode(Y,X),Create:()=>F0.Create(Y),Error:(X)=>new D0("property",Y,X,F0.Errors(Y,X))}}},HN=(Y)=>{if(typeof Y==="string")switch(Y.slice(-1)){case"k":return+Y.slice(0,Y.length-1)*1024;case"m":return+Y.slice(0,Y.length-1)*1048576;default:return+Y}return Y},aQ=(Y,X)=>{if(Y.startsWith(X))return!0;return X.charCodeAt(X.length-1)===42&&X.charCodeAt(X.length-2)===47&&Y.startsWith(X.slice(0,-1))},zN=!1,oL=()=>{if(!zN)console.warn("[Elysia] Attempt to validate file type without 'file-type'. This may lead to security risks. We recommend installing 'file-type' to properly validate file extension."),zN=!0},M4=async()=>Promise.resolve().then(() => (aM(),sM)).then((Y)=>{return eQ=Y.fileTypeFromBlob,eQ}).catch(oL),eQ,tL=(Y)=>{if(eQ)return eQ(Y);return M4().then((X)=>{if(X)return X(Y)})},kN=async(Y,X,$=Y?.name??"")=>{if(Array.isArray(Y))return await Promise.all(Y.map((Z)=>kN(Z,X,$))),!0;if(!Y)return!1;let Q=await tL(Y);if(!Q)throw new z$($,X);if(typeof X==="string"){if(!aQ(Q.mime,X))throw new z$($,X)}for(let Z=0;Z<X.length;Z++)if(aQ(Q.mime,X[Z]))return!0;throw new z$($,X)},aW=(Y,X)=>{if(X instanceof tQ)return!0;if(!(X instanceof Blob))return!1;if(Y.minSize&&X.size<HN(Y.minSize))return!1;if(Y.maxSize&&X.size>HN(Y.maxSize))return!1;if(Y.extension){if(typeof Y.extension==="string")return aQ(X.type,Y.extension);for(let $=0;$<Y.extension.length;$++)if(aQ(X.type,Y.extension[$]))return!0;return!1}return!0};var N4={date:fN,time:eW(!0),"date-time":qN(!0),"iso-time":eW(!1),"iso-date-time":qN(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:QK,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:UK,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:ZK,int32:{type:"number",validate:MK},int64:{type:"number",validate:NK},float:{type:"number",validate:DN},double:{type:"number",validate:DN},password:!0,binary:!0};function rL(Y){return Y%4===0&&(Y%100!==0||Y%400===0)}var sL=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,aL=[0,31,28,31,30,31,30,31,31,30,31,30,31];function fN(Y){let X=sL.exec(Y);if(!X)return!1;let $=+X[1],Q=+X[2],Z=+X[3];return Q>=1&&Q<=12&&Z>=1&&Z<=(Q===2&&rL($)?29:aL[Q])}var eL=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function eW(Y){return function(X){let $=eL.exec(X);if(!$)return!1;let Q=+$[1],Z=+$[2],W=+$[3],J=$[4],M=$[5]==="-"?-1:1,N=+($[6]||0),U=+($[7]||0);if(N>23||U>59||Y&&!J)return!1;if(Q<=23&&Z<=59&&W<60)return!0;let G=Z-U*M,A=Q-N*M-(G<0?1:0);return(A===23||A===-1)&&(G===59||G===-1)&&W<61}}var Y4=(Y)=>{if(Y.charCodeAt(Y.length-6)===32)return Y.slice(0,-6)+"+"+Y.slice(-5);return Y},YK=/t|\s/i;function qN(Y){let X=eW(Y);return function($){let Q=$.split(YK);return Q.length===2&&fN(Q[0])&&X(Q[1])}}var XK=/\/|:/,$K=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function QK(Y){return XK.test(Y)&&$K.test(Y)}var ON=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function ZK(Y){return ON.lastIndex=0,ON.test(Y)}var WK=-2147483648,JK=2147483647;function MK(Y){return Number.isInteger(Y)&&Y<=JK&&Y>=WK}function NK(Y){return Number.isInteger(Y)}function DN(){return!0}var GK=/[^\\]\\Z/;function UK(Y){if(GK.test(Y))return!1;try{return new RegExp(Y),!0}catch(X){return!1}}var yN=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,vN=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,hN=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,BK=N4.date,AK=N4["date-time"];if(!w0.Has("date"))w0.Set("date",(Y)=>{let X=Y4(Y).replace(/"/g,"");if(yN.test(X)||vN.test(X)||hN.test(X)||BK(X)){let $=new Date(X);if(!Number.isNaN($.getTime()))return!0}return!1});if(!w0.Has("date-time"))w0.Set("date-time",(Y)=>{let X=Y.replace(/"/g,"");if(yN.test(X)||vN.test(X)||hN.test(X)||AK(X)){let $=new Date(X);if(!Number.isNaN($.getTime()))return!0}return!1});Object.entries(N4).forEach((Y)=>{let[X,$]=Y;if(!w0.Has(X)){if($ instanceof RegExp)w0.Set(X,(Q)=>$.test(Q));else if(typeof $==="function")w0.Set(X,$)}});if(!w0.Has("numeric"))w0.Set("numeric",(Y)=>!!Y&&!isNaN(+Y));if(!w0.Has("integer"))w0.Set("integer",(Y)=>!!Y&&Number.isInteger(+Y));if(!w0.Has("boolean"))w0.Set("boolean",(Y)=>Y==="true"||Y==="false");if(!w0.Has("ObjectString"))w0.Set("ObjectString",(Y)=>{let X=Y.charCodeAt(0);if(X===9||X===10||X===32)X=Y.trimStart().charCodeAt(0);if(X!==123&&X!==91)return!1;try{return JSON.parse(Y),!0}catch{return!1}});if(!w0.Has("ArrayString"))w0.Set("ArrayString",(Y)=>{let X=Y.charCodeAt(0);if(X===9||X===10||X===32)X=Y.trimStart().charCodeAt(0);if(X!==123&&X!==91)return!1;try{return JSON.parse(Y),!0}catch{return!1}});var w=Object.assign({},iY);F$("UnionEnum",(Y,X)=>(typeof X==="number"||typeof X==="string"||X===null)&&Y.enum.includes(X));F$("ArrayBuffer",(Y,X)=>X instanceof ArrayBuffer);var HK=F$("Files",(Y,X)=>{if(Y.minItems&&Y.minItems>1&&!Array.isArray(X))return!1;if(!Array.isArray(X))return aW(Y,X);if(Y.minItems&&X.length<Y.minItems)return!1;if(Y.maxItems&&X.length>Y.maxItems)return!1;for(let $=0;$<X.length;$++)if(!aW(Y,X[$]))return!1;return!0}),zK=F$("ElysiaForm",({compiler:Y,...X},$)=>{if(!($ instanceof FormData))return!1;if(Y){if(!(b8 in $))throw new D0("property",X,$);if(!Y.Check($[b8]))throw Y.Error($[b8])}return!0}),b1={String:(Y)=>iY.String(Y),Numeric:(Y)=>{let X=iY.Number(Y),$=kX(X);return w.Transform(w.Union([w.String({format:"numeric",default:0}),w.Number(Y)],Y)).Decode((Q)=>{let Z=+Q;if(isNaN(Z))return Q;if(Y&&!$.Check(Z))throw $.Error(Z);return Z}).Encode((Q)=>Q)},Integer:(Y)=>{let X=iY.Integer(Y),$=kX(X);return w.Transform(w.Union([w.String({format:"integer",default:0}),iY.Integer(Y)],Y)).Decode((Q)=>{let Z=+Q;if(!$.Check(Z))throw $.Error(Z);return Z}).Encode((Q)=>Q)},Date:(Y)=>{let X=iY.Date(Y),$=kX(X),Q=Y?.default?new Date(Y.default):void 0;return w.Transform(w.Union([iY.Date(Y),w.String({format:"date-time",default:Q?.toISOString()}),w.String({format:"date",default:Q?.toISOString()}),w.Number({default:Q?.getTime()})],Y)).Decode((Z)=>{if(typeof Z==="number"){let J=new Date(Z);if(!$.Check(J))throw $.Error(J);return J}if(Z instanceof Date)return Z;let W=new Date(Y4(Z));if(!W||isNaN(W.getTime()))throw new D0("property",X,W);if(!$.Check(W))throw $.Error(W);return W}).Encode((Z)=>{if(Z instanceof Date)return Z.toISOString();if(typeof Z==="string"){if(isNaN(new Date(Y4(Z)).getTime()))throw new D0("property",X,Z);return Z}if(!$.Check(Z))throw $.Error(Z);return Z})},BooleanString:(Y)=>{let X=iY.Boolean(Y),$=kX(X);return w.Transform(w.Union([w.Boolean(Y),w.String({format:"boolean",default:!1})],Y)).Decode((Q)=>{if(typeof Q==="string")return Q==="true";if(Q!==void 0&&!$.Check(Q))throw $.Error(Q);return Q}).Encode((Q)=>Q)},ObjectString:(Y,X)=>{let $=w.Object(Y,X),Q=kX($);return w.Transform(w.Union([w.String({format:"ObjectString",default:"{}"}),$],{elysiaMeta:"ObjectString"})).Decode((Z)=>{if(typeof Z==="string"){if(Z.charCodeAt(0)!==123)throw new D0("property",$,Z);if(!Q.Check(Z=M$(Z,$)))throw Q.Error(Z);return Q.Decode(Z)}return Z}).Encode((Z)=>{let W;if(typeof Z==="string")Z=M$(W=Z,$);if(!Q.Check(Z))throw Q.Error(Z);return W??JSON.stringify(Z)})},ArrayString:(Y=w.String(),X)=>{let $=w.Array(Y,X),Q=kX($),Z=(W,J=!1)=>{if(W.charCodeAt(0)===91){if(!Q.Check(W=M$(W,$)))throw Q.Error(W);return Q.Decode(W)}if(J)return W;throw new D0("property",$,W)};return w.Transform(w.Union([w.String({format:"ArrayString",default:X?.default}),$])).Decode((W)=>{if(Array.isArray(W)){let J=[];for(let M=0;M<W.length;M++){let N=W[M];if(typeof N==="string"){let U=Z(N,!0);if(Array.isArray(U))J=J.concat(U);else J.push(U);continue}J.push(N)}return J}if(typeof W==="string")return Z(W);return W}).Encode((W)=>{let J;if(typeof W==="string")W=M$(J=W,$);if(!Q.Check(W))throw new D0("property",$,W);return J??JSON.stringify(W)})},ArrayQuery:(Y=w.String(),X)=>{let $=w.Array(Y,X),Q=kX($),Z=(W)=>{if(W.indexOf(",")!==-1)return Q.Decode(W.split(","));return[W]};return w.Transform(w.Union([w.String({default:X?.default}),$],{elysiaMeta:"ArrayQuery"})).Decode((W)=>{if(Array.isArray(W)){let J=[];for(let M=0;M<W.length;M++){let N=W[M];if(typeof N==="string"){let U=Z(N);if(Array.isArray(U))J=J.concat(U);else J.push(U);continue}J.push(N)}return J}if(typeof W==="string")return Z(W);return W}).Encode((W)=>{let J;if(typeof W==="string")W=M$(J=W,$);if(!Q.Check(W))throw new D0("property",$,W);return J??JSON.stringify(W)})},File:F$("File",aW),Files:(Y={})=>w.Transform(HK(Y)).Decode((X)=>{if(Array.isArray(X))return X;return[X]}).Encode((X)=>X),Nullable:(Y,X)=>w.Union([Y,w.Null()],{...X,nullable:!0}),MaybeEmpty:(Y,X)=>w.Union([Y,w.Null(),w.Undefined()],X),Cookie:(Y,{domain:X,expires:$,httpOnly:Q,maxAge:Z,path:W,priority:J,sameSite:M,secure:N,secrets:U,sign:G,...A}={})=>{let O=w.Object(Y,A);return O.config={domain:X,expires:$,httpOnly:Q,maxAge:Z,path:W,priority:J,sameSite:M,secure:N,secrets:U,sign:G},O},UnionEnum:(Y,X={})=>{let $=Y.every((Q)=>typeof Q==="string")?{type:"string"}:Y.every((Q)=>typeof Q==="number")?{type:"number"}:Y.every((Q)=>Q===null)?{type:"null"}:{};if(Y.some((Q)=>typeof Q==="object"&&Q!==null))throw Error("This type does not support objects or arrays");return{default:Y[0],...X,[S]:"UnionEnum",...$,enum:Y}},NoValidate:(Y,X=!0)=>{return Y.noValidate=X,Y},Form:(Y,X={})=>{let $=w.Object(Y,{default:cL({}),...X}),Q=kX($);return w.Union([$,zK({compiler:Q})])},ArrayBuffer(Y={}){return{default:[1,2,3],...Y,[S]:"ArrayBuffer"}},Uint8Array:(Y)=>{let X=iY.Uint8Array(Y),$=kX(X);return w.Transform(w.Union([w.ArrayBuffer(),iY.Uint8Array(Y)])).Decode((Q)=>{if(Q instanceof ArrayBuffer){if(!$.Check(Q=new Uint8Array(Q)))throw $.Error(Q);return Q}return Q}).Encode((Q)=>Q)}};w.BooleanString=b1.BooleanString;w.ObjectString=b1.ObjectString;w.ArrayString=b1.ArrayString;w.ArrayQuery=b1.ArrayQuery;w.Numeric=b1.Numeric;w.Integer=b1.Integer;w.File=(Y)=>{if(Y?.type)M4();return b1.File({default:"File",...Y,extension:Y?.type,type:"string",format:"binary"})};w.Files=(Y)=>{if(Y?.type)M4();return b1.Files({...Y,elysiaMeta:"Files",default:"Files",extension:Y?.type,type:"array",items:{...Y,default:"Files",type:"string",format:"binary"}})};w.Nullable=b1.Nullable;w.MaybeEmpty=b1.MaybeEmpty;w.Cookie=b1.Cookie;w.Date=b1.Date;w.UnionEnum=b1.UnionEnum;w.NoValidate=b1.NoValidate;w.Form=b1.Form;w.ArrayBuffer=b1.ArrayBuffer;w.Uint8Array=b1.Uint8Array;var dN=S$(bL(),1),qK=S$(WZ(),1);class uX{name;jar;initial;constructor(Y,X,$={}){this.name=Y,this.jar=X,this.initial=$}get cookie(){return this.jar[this.name]??this.initial}set cookie(Y){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=Y}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie(Y){this.cookie=Y}get value(){return this.cookie.value}set value(Y){this.setCookie.value=Y}get expires(){return this.cookie.expires}set expires(Y){this.setCookie.expires=Y}get maxAge(){return this.cookie.maxAge}set maxAge(Y){this.setCookie.maxAge=Y}get domain(){return this.cookie.domain}set domain(Y){this.setCookie.domain=Y}get path(){return this.cookie.path}set path(Y){this.setCookie.path=Y}get secure(){return this.cookie.secure}set secure(Y){this.setCookie.secure=Y}get httpOnly(){return this.cookie.httpOnly}set httpOnly(Y){this.setCookie.httpOnly=Y}get sameSite(){return this.cookie.sameSite}set sameSite(Y){this.setCookie.sameSite=Y}get priority(){return this.cookie.priority}set priority(Y){this.setCookie.priority=Y}get partitioned(){return this.cookie.partitioned}set partitioned(Y){this.setCookie.partitioned=Y}get secrets(){return this.cookie.secrets}set secrets(Y){this.setCookie.secrets=Y}update(Y){return this.setCookie=Object.assign(this.cookie,typeof Y==="function"?Y(this.cookie):Y),this}set(Y){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof Y==="function"?Y(this.cookie):Y),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var wN=(Y,X,$)=>{if(!Y.cookie)Y.cookie={};return new Proxy(X,{get(Q,Z){if(Z in X)return new uX(Z,Y.cookie,Object.assign({},$??{},X[Z]));return new uX(Z,Y.cookie,Object.assign({},$))}})},mN=async(Y,X,{secrets:$,sign:Q,...Z}={})=>{if(!X)return wN(Y,{},Z);let W=typeof $==="string";if(Q&&Q!==!0&&!Array.isArray(Q))Q=[Q];let J={},M=dN.parse(X);for(let[N,U]of Object.entries(M)){if(U===void 0)continue;let G=qK.default(U);if(G){let A=G.charCodeAt(0),O=G.charCodeAt(G.length-1);if(A===123&&O===125||A===91&&O===93)try{G=JSON.parse(G)}catch{}}if(Q===!0||Q?.includes(N)){if(!$)throw Error("No secret is provided to cookie plugin");if(W){let A=await NN(G,$);if(A===!1)throw new sW(N);G=A}else{let A=!0;for(let O=0;O<$.length;O++){let B=await NN(G,$[O]);if(B!==!1){A=!0,G=B;break}}if(!A)throw new sW(N)}}J[N]={value:G}}return wN(Y,J,Z)},uN=(Y)=>{if(!Y||!d0(Y))return;let X=[];for(let[$,Q]of Object.entries(Y)){if(!$||!Q)continue;let Z=Q.value;if(Z===void 0||Z===null)continue;X.push(dN.serialize($,typeof Z==="object"?JSON.stringify(Z):Z+"",Q))}if(X.length===0)return;if(X.length===1)return X[0];return X},X4=P6?Bun.env:typeof process<"u"&&process?.env?process.env:{},e0=(Y,X)=>{if(!P6&&Y instanceof Promise)return Y.then((W)=>e0(W,X));let $=Y.size,Q=X&&(X.status===206||X.status===304||X.status===412||X.status===416),Z=Q?{}:{"accept-ranges":"bytes","content-range":$?`bytes 0-${$-1}/${$}`:void 0};if(!X&&!$)return new Response(Y);if(!X)return new Response(Y,{headers:Z});if(X.headers instanceof Headers){for(let W of Object.keys(Z))if(W in X.headers)X.headers.append(W,Z[W]);if(Q)X.headers.delete("content-length"),X.headers.delete("accept-ranges");return new Response(Y,X)}if(d0(X.headers))return new Response(Y,{status:X.status,headers:Object.assign(Z,X.headers)});return new Response(Y,{status:X.status,headers:Z})},cN=(Y,X)=>{if(!Y)return Y;Y.delete("set-cookie");for(let $=0;$<X.length;$++){let Q=X[$].indexOf("=");Y.append("set-cookie",`${X[$].slice(0,Q)}=${X[$].slice(Q+1)||""}`)}return Y},LN=(Y,X)=>{if(X?.headers){if(Y){if(tW)Object.assign(X.headers,Y.headers.toJSON());else for(let[$,Q]of Y.headers.entries())if($ in X.headers)X.headers[$]=Q}if(X.status===200)X.status=Y.status;if(X.headers["content-encoding"])delete X.headers["content-encoding"];return X}if(!Y)return{headers:{},status:X?.status??200};if(tW){if(X={headers:Y.headers.toJSON(),status:X?.status??200},X.headers["content-encoding"])delete X.headers["content-encoding"];return X}X={headers:{},status:X?.status??200};for(let[$,Q]of Y.headers.entries()){if($==="content-encoding")continue;if($ in X.headers)X.headers[$]=Q}return X},OK=X4.ELYSIA_RAPID_STREAM==="true",G4=({mapResponse:Y,mapCompactResponse:X})=>async($,Q,Z)=>{let W=$.next?.();if(Q)C$(Q);if(W instanceof Promise)W=await W;if(W?.value instanceof ReadableStream)$=W.value;else if(W&&(typeof W?.done>"u"||W?.done)){if(Q)return Y(W.value,Q,Z);return X(W.value,Z)}let J=W?.value?.sse??$?.sse??Q?.headers["content-type"]?.startsWith("text/event-stream"),M=J?(G)=>`data: ${G}

`:(G)=>G,N=J?"text/event-stream":W?.value&&typeof W?.value==="object"?"application/json":"text/plain";if(Q?.headers){if(!Q.headers["transfer-encoding"])Q.headers["transfer-encoding"]="chunked";if(!Q.headers["content-type"])Q.headers["content-type"]=N;if(!Q.headers["cache-control"])Q.headers["cache-control"]="no-cache"}else Q={status:200,headers:{"content-type":N,"transfer-encoding":"chunked","cache-control":"no-cache",connection:"keep-alive"}};let U=Z?.headers.has("Origin");return new Response(new ReadableStream({async start(G){let A=!1;if(Z?.signal?.addEventListener("abort",()=>{A=!0;try{G.close()}catch{}}),!W||W.value instanceof ReadableStream);else if(W.value!==void 0&&W.value!==null)if(W.value.toSSE)G.enqueue(W.value.toSSE());else if(typeof W.value==="object")try{G.enqueue(M(JSON.stringify(W.value)))}catch{G.enqueue(M(W.value.toString()))}else G.enqueue(M(W.value.toString()));try{for await(let O of $){if(A)break;if(O===void 0||O===null)continue;if(O.toSSE)G.enqueue(O.toSSE());else{if(typeof O==="object")try{G.enqueue(M(JSON.stringify(O)))}catch{G.enqueue(M(O.toString()))}else G.enqueue(M(O.toString()));if(!OK&&U&&!J)await new Promise((B)=>setTimeout(()=>B(),0))}}}catch(O){console.warn(O)}try{G.close()}catch{}}}),Q)};async function*KN(Y){let X=Y.body;if(!X)return;let $=X.getReader(),Q=new TextDecoder;try{while(!0){let{done:Z,value:W}=await $.read();if(Z)break;if(typeof W==="string")yield W;else yield Q.decode(W)}}finally{$.releaseLock()}}var C$=(Y)=>{if(typeof Y.status==="string")Y.status=D$[Y.status];if(Y.cookie&&d0(Y.cookie)){let X=uN(Y.cookie);if(X)Y.headers["set-cookie"]=X}if(Y.headers["set-cookie"]&&Array.isArray(Y.headers["set-cookie"]))Y.headers=cN(new Headers(Y.headers),Y.headers["set-cookie"])},pN=(Y)=>{let X=G4(Y);return($,Q,Z)=>{let W=!1;if(Q.headers instanceof Headers)for(let M of Q.headers.keys())if(M==="set-cookie"){if(W)continue;W=!0;for(let N of Q.headers.getSetCookie())$.headers.append("set-cookie",N)}else $.headers.append(M,Q.headers?.get(M)??"");else for(let M in Q.headers)$.headers.append(M,Q.headers[M]);let J=Q.status??200;if($.status!==J&&J!==200&&($.status<=300||$.status>400)){let M=new Response($.body,{headers:$.headers,status:Q.status});if(!M.headers.has("content-length")&&M.headers.get("transfer-encoding")==="chunked")return X(KN(M),LN(M,Q),Z);return M}if(!$.headers.has("content-length")&&$.headers.get("transfer-encoding")==="chunked")return X(KN($),LN($,Q),Z);return $}};async function DK(Y,X=2){let $=[],Q=!1,Z=[];(async()=>{for await(let J of Y)$.push(J),Z.forEach((M)=>M.resolve()),Z=[];Q=!0,Z.forEach((J)=>J.resolve())})();async function*W(){let J=0;while(!0)if(J<$.length)yield $[J++];else if(Q)return;else await new Promise((M)=>Z.push({resolve:M}))}return Array.from({length:X},W)}var YZ=(Y,X={headers:{}})=>{let $=Y.path,Q=VN[$.slice($.lastIndexOf(".")+1)];if(Q)X.headers["content-type"]=Q;if(Y.stats&&X.status!==206&&X.status!==304&&X.status!==412&&X.status!==416)return Y.stats.then((Z)=>{let W=Z.size;if(W!==void 0)X.headers["content-range"]=`bytes 0-${W-1}/${W}`,X.headers["content-length"]=W;return e0(Y.value,X)});return e0(Y.value,X)},XY=(Y,X,$)=>{if(d0(X.headers)||X.status!==200||X.cookie)switch(C$(X),Y?.constructor?.name){case"String":return X.headers["content-type"]="text/plain",new Response(Y,X);case"Array":case"Object":return X.headers["content-type"]="application/json",new Response(JSON.stringify(Y),X);case"ElysiaFile":return YZ(Y,X);case"File":return e0(Y,X);case"Blob":return e0(Y,X);case"ElysiaCustomStatusResponse":return X.status=Y.code,XY(Y.response,X,$);case void 0:if(!Y)return new Response("",X);return new Response(JSON.stringify(Y),X);case"Response":return XZ(Y,X,$);case"Error":return U8(Y,X);case"Promise":return Y.then((Q)=>XY(Q,X,$));case"Function":return XY(Y(),X,$);case"Number":case"Boolean":return new Response(Y.toString(),X);case"Cookie":if(Y instanceof uX)return new Response(Y.value,X);return new Response(Y?.toString(),X);case"FormData":return new Response(Y,X);default:if(Y instanceof Response)return XZ(Y,X,$);if(Y instanceof Promise)return Y.then((Q)=>XY(Q,X));if(Y instanceof Error)return U8(Y,X);if(Y instanceof V1)return X.status=Y.code,XY(Y.response,X,$);if(typeof Y?.next==="function"||Y instanceof ReadableStream)return w$(Y,X,$);if(typeof Y?.then==="function")return Y.then((Q)=>XY(Q,X));if(typeof Y?.toResponse==="function")return XY(Y.toResponse(),X);if("charCodeAt"in Y){let Q=Y.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Y),X)}}return new Response(Y,X)}if(typeof Y?.next==="function"||Y instanceof ReadableStream)return w$(Y,X,$);return hX(Y,$)},YY=(Y,X,$)=>{if(Y===void 0||Y===null)return;if(d0(X.headers)||X.status!==200||X.cookie)switch(C$(X),Y?.constructor?.name){case"String":return X.headers["content-type"]="text/plain",new Response(Y,X);case"Array":case"Object":return X.headers["content-type"]="application/json",new Response(JSON.stringify(Y),X);case"ElysiaFile":return YZ(Y,X);case"File":return e0(Y,X);case"Blob":return e0(Y,X);case"ElysiaCustomStatusResponse":return X.status=Y.code,YY(Y.response,X,$);case void 0:if(!Y)return;return new Response(JSON.stringify(Y),X);case"Response":return XZ(Y,X,$);case"Promise":return Y.then((Q)=>YY(Q,X));case"Error":return U8(Y,X);case"Function":return YY(Y(),X);case"Number":case"Boolean":return new Response(Y.toString(),X);case"FormData":return new Response(Y);case"Cookie":if(Y instanceof uX)return new Response(Y.value,X);return new Response(Y?.toString(),X);default:if(Y instanceof Response)return XZ(Y,X,$);if(Y instanceof Promise)return Y.then((Q)=>YY(Q,X));if(Y instanceof Error)return U8(Y,X);if(Y instanceof V1)return X.status=Y.code,YY(Y.response,X,$);if(typeof Y?.next==="function"||Y instanceof ReadableStream)return w$(Y,X,$);if(typeof Y?.then==="function")return Y.then((Q)=>YY(Q,X));if(typeof Y?.toResponse==="function")return YY(Y.toResponse(),X);if("charCodeAt"in Y){let Q=Y.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Y),X)}}return new Response(Y,X)}else switch(Y?.constructor?.name){case"String":return X.headers["content-type"]="text/plain",new Response(Y);case"Array":case"Object":return X.headers["content-type"]="application/json",new Response(JSON.stringify(Y),X);case"ElysiaFile":return YZ(Y,X);case"File":return e0(Y,X);case"Blob":return e0(Y,X);case"ElysiaCustomStatusResponse":return X.status=Y.code,YY(Y.response,X,$);case void 0:if(!Y)return new Response("");return new Response(JSON.stringify(Y),{headers:{"content-type":"application/json"}});case"Response":return Y;case"Promise":return Y.then((Q)=>{let Z=YY(Q,X);if(Z!==void 0)return Z});case"Error":return U8(Y,X);case"Function":return hX(Y(),$);case"Number":case"Boolean":return new Response(Y.toString());case"Cookie":if(Y instanceof uX)return new Response(Y.value,X);return new Response(Y?.toString(),X);case"FormData":return new Response(Y);default:if(Y instanceof Response)return Y;if(Y instanceof Promise)return Y.then((Q)=>YY(Q,X));if(Y instanceof Error)return U8(Y,X);if(Y instanceof V1)return X.status=Y.code,YY(Y.response,X,$);if(typeof Y?.next==="function"||Y instanceof ReadableStream)return w$(Y,X,$);if(typeof Y?.then==="function")return Y.then((Q)=>YY(Q,X));if(typeof Y?.toResponse==="function")return YY(Y.toResponse(),X);if("charCodeAt"in Y){let Q=Y.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Y),X)}}return new Response(Y)}},hX=(Y,X)=>{switch(Y?.constructor?.name){case"String":return new Response(Y,{headers:{"Content-Type":"text/plain"}});case"Object":case"Array":return new Response(JSON.stringify(Y),{headers:{"Content-Type":"application/json"}});case"ElysiaFile":return YZ(Y);case"File":return e0(Y);case"Blob":return e0(Y);case"ElysiaCustomStatusResponse":return XY(Y.response,{status:Y.code,headers:{}});case void 0:if(!Y)return new Response("");return new Response(JSON.stringify(Y),{headers:{"content-type":"application/json"}});case"Response":return Y;case"Error":return U8(Y);case"Promise":return Y.then(($)=>hX($,X));case"Function":return hX(Y(),X);case"Number":case"Boolean":return new Response(Y.toString());case"FormData":return new Response(Y);default:if(Y instanceof Response)return Y;if(Y instanceof Promise)return Y.then(($)=>hX($,X));if(Y instanceof Error)return U8(Y);if(Y instanceof V1)return XY(Y.response,{status:Y.code,headers:{}});if(typeof Y?.next==="function"||Y instanceof ReadableStream)return w$(Y,void 0,X);if(typeof Y?.then==="function")return Y.then(($)=>XY($,set));if(typeof Y?.toResponse==="function")return hX(Y.toResponse());if("charCodeAt"in Y){let $=Y.charCodeAt(0);if($===123||$===91)return new Response(JSON.stringify(Y),{headers:{"Content-Type":"application/json"}})}return new Response(Y)}},U8=(Y,X)=>new Response(JSON.stringify({name:Y?.name,message:Y?.message,cause:Y?.cause}),{status:X?.status!==200?X?.status??500:500,headers:X?.headers}),wK=(Y,X,$={})=>{if(typeof Y==="function")return;let Q=XY(Y,{headers:$});if(!X.parse?.length&&!X.transform?.length&&!X.beforeHandle?.length&&!X.afterHandle?.length)return()=>Q.clone()},XZ=pN({mapResponse:XY,mapCompactResponse:hX}),w$=G4({mapResponse:XY,mapCompactResponse:hX}),S6={name:"web-standard",isWebStandard:!0,handler:{mapResponse:XY,mapEarlyResponse:YY,mapCompactResponse:hX,createStaticHandler:wK},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers={}
for(const [k,v] of c.request.headers.entries())c.headers[k]=v
`,parser:{json(Y){if(Y)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData(Y){let X=`
c.body={}
`;if(Y)X+="let form;try{form=await c.request.formData()}catch{}";else X+=`const form=await c.request.formData()
`;return X+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},async stop(Y,X){if(!Y.server)throw Error("Elysia isn't running. Call `app.listen` to start the server.");if(Y.server){if(await Y.server.stop(X),Y.server=null,Y.event.stop?.length)for(let $=0;$<Y.event.stop.length;$++)Y.event.stop[$].fn(Y)}},composeGeneralHandler:{parameters:"r",createContext(Y){let X="",$="",Q=Y.setHeaders;for(let J of Object.keys(Y.decorator))X+=`,'${J}':decorator['${J}']`;let Z=Y.config.handler?.standardHostname??!0,W=!!Y.event.trace?.length;if($+=`const u=r.url,s=u.indexOf('/',${Z?11:7}),qi=u.indexOf('?',s+1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,W)$+=`const id=randomId()
`;if($+="const c={request:r,store,qi,path:p,url:u,redirect,status,set:{headers:",$+=Object.keys(Q??{}).length?"Object.assign({},app.setHeaders)":"Object.create(null)",$+=",status:200}",Y.inference.server)$+=",get server(){return app.getServer()}";if(W)$+=",[ELYSIA_REQUEST_ID]:id";return $+=X,$+=`}
`,$},error404(Y,X,$=""){let Q="if(route===null){"+$+(X?"":"c.set.status=404")+`
return `;if(X)Q+=`app.handleError(c,notFound,false,${this.parameters})`;else Q+=Y?"c.response=c.responseValue=new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"c.response=c.responseValue=error404.clone()";return Q+="}",{declare:X?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:Q}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}};function LK(){try{if(typeof caches<"u"&&typeof caches.default<"u")return!0;if(typeof WebSocketPair<"u")return!0}catch{return!1}return!1}var wy={...S6,name:"cloudflare-worker",composeGeneralHandler:{...S6.composeGeneralHandler,error404(Y,X,$){let{code:Q}=S6.composeGeneralHandler.error404(Y,X,$);return{code:Q,declare:X?"":`const error404Message=notFound.message.toString()
const error404={clone:()=>new Response(error404Message,{status:404})}
`}}},beforeCompile(Y){for(let X of Y.routes)X.compile()},listen(Y){return(X,$)=>{console.warn("Cloudflare Worker does not support listen method. Please export default Elysia instance instead."),Y.compile()}}},KK=(Y)=>{if(Y.startsWith("async"))Y=Y.slice(5);Y=Y.trimStart();let X=-1;if(Y.charCodeAt(0)===40){if(X=Y.indexOf("=>",Y.indexOf(")")),X!==-1){let Z=X;while(Z>0)if(Y.charCodeAt(--Z)===41)break;let W=Y.slice(X+2);if(W.charCodeAt(0)===32)W=W.trimStart();return[Y.slice(1,Z),W,{isArrowReturn:W.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test(Y)){if(X=Y.indexOf("=>"),X!==-1){let Z=Y.slice(X+2);if(Z.charCodeAt(0)===32)Z=Z.trimStart();return[Y.slice(0,X),Z,{isArrowReturn:Z.charCodeAt(0)!==123}]}}if(Y.startsWith("function")){X=Y.indexOf("(");let Z=Y.indexOf(")");return[Y.slice(X+1,Z),Y.slice(Z+2),{isArrowReturn:!1}]}let $=Y.indexOf("(");if($!==-1){let Z=Y.indexOf(`
`,2),W=Y.slice(0,Z),J=W.lastIndexOf(")")+1,M=Y.slice(Z+1);return[W.slice($,J),"{"+M,{isArrowReturn:!1}]}let Q=Y.split(`
`,2);return[Q[0],Q[1],{isArrowReturn:!1}]},SK=(Y)=>{let X=Y.indexOf("{");if(X===-1)return[-1,0];let $=X+1,Q=1;for(;$<Y.length;$++){let Z=Y.charCodeAt($);if(Z===123)Q++;else if(Z===125)Q--;if(Q===0)break}if(Q!==0)return[0,Y.length];return[X,$+1]},PK=(Y)=>{let X=Y.lastIndexOf("}");if(X===-1)return[-1,0];let $=X-1,Q=1;for(;$>=0;$--){let Z=Y.charCodeAt($);if(Z===125)Q++;else if(Z===123)Q--;if(Q===0)break}if(Q!==0)return[-1,0];return[$,X+1]},iN=(Y)=>{while(!0){let X=Y.indexOf(":");if(X===-1)break;let $=Y.indexOf(",",X);if($===-1)$=Y.indexOf("}",X)-1;if($===-2)$=Y.length;Y=Y.slice(0,X)+Y.slice($)}return Y},lN=(Y)=>{let X=!1;if(Y.charCodeAt(0)===40)Y=Y.slice(1,-1);if(Y.charCodeAt(0)===123)X=!0,Y=Y.slice(1,-1);Y=Y.replace(/( |\t|\n)/g,"").trim();let $=[];while(!0){let[Z,W]=SK(Y);if(Z===-1)break;if($.push(Y.slice(0,Z-1)),Y.charCodeAt(W)===44)W++;Y=Y.slice(W)}if(Y=iN(Y),Y)$=$.concat(Y.split(","));let Q=Object.create(null);for(let Z of $){if(Z.indexOf(",")===-1){Q[Z]=!0;continue}for(let W of Z.split(","))Q[W.trim()]=!0}return{hasParenthesis:X,parameters:Q}},FK=(Y,X)=>{let{parameters:$,hasParenthesis:Q}=lN(Y);if($.query)X.query=!0;if($.headers)X.headers=!0;if($.body)X.body=!0;if($.cookie)X.cookie=!0;if($.set)X.set=!0;if($.server)X.server=!0;if($.route)X.route=!0;if($.url)X.url=!0;if($.path)X.path=!0;if(Q)return`{ ${Object.keys($).join(", ")} }`;return Object.keys($).join(", ")},SN=(Y,X,$)=>{let Q=new RegExp(`${Y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}[\\n\\t,; ]`);if($!==void 0)Q.lastIndex=$;let Z=Q.exec(X);return Z?Z.index:-1},nN=(Y,X,$=0)=>{if($>5)return[];let Q=[],Z=X;while(!0){let W=SN(" = "+Y,Z);if(W===-1)W=SN("="+Y,Z);if(W===-1){let U=Z.indexOf(" = "+Y);if(U===-1)U=Z.indexOf("="+Y);if(U+3+Y.length!==Z.length)break;W=U}let J=Z.slice(0,W),M=J.lastIndexOf(" "),N=J.slice(M!==-1?M+1:-1);if(N==="}"){let[U,G]=PK(J);Q.push(iN(Z.slice(U,G))),Z=Z.slice(W+3+Y.length);continue}while(N.charCodeAt(0)===44)N=N.slice(1);while(N.charCodeAt(0)===9)N=N.slice(1);if(!N.includes("("))Q.push(N);Z=Z.slice(W+3+Y.length)}for(let W of Q){if(W.charCodeAt(0)===123)continue;let J=nN(W,X);if(J.length>0)Q.push(...J)}return Q},CK=(Y)=>{if(!Y)return;if(Y.charCodeAt(0)!==123)return Y;if(Y=Y.slice(2,-2),!Y.includes(",")){if(Y.indexOf("...")!==-1)return Y.slice(Y.indexOf("...")+3);return}let X=Y.indexOf("...");if(X===-1)return;return Y.slice(X+3).trimEnd()},RK=(Y,X,$)=>{let Q=(Z,W)=>new RegExp(`${W}\\.(${Z})|${W}\\["${Z}"\\]|${W}\\['${Z}'\\]`).test(Y);for(let Z of X){if(!Z)continue;if(Z.charCodeAt(0)===123){let W=lN(Z).parameters;if(W.query)$.query=!0;if(W.headers)$.headers=!0;if(W.body)$.body=!0;if(W.cookie)$.cookie=!0;if(W.set)$.set=!0;if(W.server)$.server=!0;if(W.url)$.url=!0;if(W.route)$.route=!0;if(W.path)$.path=!0;continue}if(!$.query&&(Q("query",Z)||Y.includes("return "+Z)||Y.includes("return "+Z+".query")))$.query=!0;if(!$.headers&&Q("headers",Z))$.headers=!0;if(!$.body&&Q("body",Z))$.body=!0;if(!$.cookie&&Q("cookie",Z))$.cookie=!0;if(!$.set&&Q("set",Z))$.set=!0;if(!$.server&&Q("server",Z))$.server=!0;if(!$.route&&Q("route",Z))$.route=!0;if(!$.url&&Q("url",Z))$.url=!0;if(!$.path&&Q("path",Z))$.path=!0;if($.query&&$.headers&&$.body&&$.cookie&&$.set&&$.server&&$.route&&$.url&&$.path)break}return X},jK=(Y,X,$)=>{try{let Q=new RegExp(`\\w\\((.*?)?${Y}`,"gs");Q.test(X);let Z=X.charCodeAt(Q.lastIndex);if(Z===41||Z===44)return $.query=!0,$.headers=!0,$.body=!0,$.cookie=!0,$.set=!0,$.server=!0,$.url=!0,$.route=!0,$.path=!0,!0;return!1}catch(Q){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log(X),console.log("--- context ---"),console.log(Y),!0}},iQ,nQ={},_K=(Y)=>{if(Y===null||LK())return;if(Y===void 0)Y=295000;if(iQ)clearTimeout(iQ);iQ=setTimeout(()=>{if(nQ={},iQ=void 0,P6)Bun.gc(!1)},Y)},$4=(Y,X)=>{return{body:Y.body||X.body,cookie:Y.cookie||X.cookie,headers:Y.headers||X.headers,query:Y.query||X.query,set:Y.set||X.set,server:Y.server||X.server,url:Y.url||X.url,route:Y.route||X.route,path:Y.path||X.path}},$Z=(Y,X={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,url:!1,route:!1,path:!1},$={})=>{let Q=[];if(Y.request?.length)Q.push(...Y.request);if(Y.beforeHandle?.length)Q.push(...Y.beforeHandle);if(Y.parse?.length)Q.push(...Y.parse);if(Y.error?.length)Q.push(...Y.error);if(Y.transform?.length)Q.push(...Y.transform);if(Y.afterHandle?.length)Q.push(...Y.afterHandle);if(Y.mapResponse?.length)Q.push(...Y.mapResponse);if(Y.afterResponse?.length)Q.push(...Y.afterResponse);if(Y.handler&&typeof Y.handler==="function")Q.push(Y.handler);for(let Z=0;Z<Q.length;Z++){let W=Q[Z];if(!W)continue;let J=typeof W==="object"?W.fn:W;if(typeof J!=="function")continue;let M=J.toString(),N=N$(M),U=nQ[N];if(U){X=$4(X,U);continue}_K($.gcTime);let G={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,url:!1,route:!1,path:!1},[A,O]=KK(M),B=FK(A,G),z=CK(B);if(z){let H=nN(z,O.slice(1,-1));H.splice(0,-1,z);let P=O;if(P.charCodeAt(0)===123&&P.charCodeAt(O.length-1)===125)P=P.slice(1,-1);if(!jK(z,P,G))RK(P,H,G);if(!G.query&&P.includes("return "+z+".query"))G.query=!0}if(!nQ[N])nQ[N]=G;if(X=$4(X,G),X.query&&X.headers&&X.body&&X.cookie&&X.set&&X.server&&X.url&&X.route&&X.path)break}return X},p1=(Y,X,$)=>{if(d0(X.headers)||X.status!==200||X.cookie)switch(C$(X),Y?.constructor?.name){case"String":return new Response(Y,X);case"Array":case"Object":return X.headers["content-type"]="application/json",new Response(JSON.stringify(Y),X);case"ElysiaFile":return e0(Y.value,X);case"File":return e0(Y,X);case"Blob":return e0(Y,X);case"ElysiaCustomStatusResponse":return X.status=Y.code,p1(Y.response,X,$);case void 0:if(!Y)return new Response("",X);return new Response(JSON.stringify(Y),X);case"Response":return QZ(Y,X,$);case"Error":return B8(Y,X);case"Promise":return Y.then((Q)=>p1(Q,X,$));case"Function":return p1(Y(),X,$);case"Number":case"Boolean":return new Response(Y.toString(),X);case"Cookie":if(Y instanceof uX)return new Response(Y.value,X);return new Response(Y?.toString(),X);case"FormData":return new Response(Y,X);default:if(Y instanceof Response)return QZ(Y,X,$);if(Y instanceof Promise)return Y.then((Q)=>p1(Q,X));if(Y instanceof Error)return B8(Y,X);if(Y instanceof V1)return X.status=Y.code,p1(Y.response,X,$);if(typeof Y?.next==="function"||Y instanceof ReadableStream)return L$(Y,X,$);if(typeof Y?.then==="function")return Y.then((Q)=>p1(Q,X));if(typeof Y?.toResponse==="function")return p1(Y.toResponse(),X);if("charCodeAt"in Y){let Q=Y.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Y),X)}}return new Response(Y,X)}if(typeof Y?.next==="function"||Y instanceof ReadableStream)return L$(Y,X,$);return dX(Y,$)},c1=(Y,X,$)=>{if(Y===void 0||Y===null)return;if(d0(X.headers)||X.status!==200||X.cookie)switch(C$(X),Y?.constructor?.name){case"String":return new Response(Y,X);case"Array":case"Object":return X.headers["content-type"]="application/json",new Response(JSON.stringify(Y),X);case"ElysiaFile":return e0(Y.value,X);case"File":return e0(Y,X);case"Blob":return e0(Y,X);case"ElysiaCustomStatusResponse":return X.status=Y.code,c1(Y.response,X,$);case void 0:if(!Y)return;return new Response(JSON.stringify(Y),X);case"Response":return QZ(Y,X,$);case"Promise":return Y.then((Q)=>c1(Q,X));case"Error":return B8(Y,X);case"Function":return c1(Y(),X);case"Number":case"Boolean":return new Response(Y.toString(),X);case"FormData":return new Response(Y);case"Cookie":if(Y instanceof uX)return new Response(Y.value,X);return new Response(Y?.toString(),X);default:if(Y instanceof Response)return QZ(Y,X,$);if(Y instanceof Promise)return Y.then((Q)=>c1(Q,X));if(Y instanceof Error)return B8(Y,X);if(Y instanceof V1)return X.status=Y.code,c1(Y.response,X,$);if(typeof Y?.next==="function"||Y instanceof ReadableStream)return L$(Y,X,$);if(typeof Y?.then==="function")return Y.then((Q)=>c1(Q,X));if(typeof Y?.toResponse==="function")return c1(Y.toResponse(),X);if("charCodeAt"in Y){let Q=Y.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Y),X)}}return new Response(Y,X)}else switch(Y?.constructor?.name){case"String":return new Response(Y);case"Array":case"Object":return X.headers["content-type"]="application/json",new Response(JSON.stringify(Y),X);case"ElysiaFile":return e0(Y.value,X);case"File":return e0(Y,X);case"Blob":return e0(Y,X);case"ElysiaCustomStatusResponse":return X.status=Y.code,c1(Y.response,X,$);case void 0:if(!Y)return new Response("");return new Response(JSON.stringify(Y),{headers:{"content-type":"application/json"}});case"Response":return Y;case"Promise":return Y.then((Q)=>{let Z=c1(Q,X);if(Z!==void 0)return Z});case"Error":return B8(Y,X);case"Function":return dX(Y(),$);case"Number":case"Boolean":return new Response(Y.toString());case"Cookie":if(Y instanceof uX)return new Response(Y.value,X);return new Response(Y?.toString(),X);case"FormData":return new Response(Y);default:if(Y instanceof Response)return Y;if(Y instanceof Promise)return Y.then((Q)=>c1(Q,X));if(Y instanceof Error)return B8(Y,X);if(Y instanceof V1)return X.status=Y.code,c1(Y.response,X,$);if(typeof Y?.next==="function"||Y instanceof ReadableStream)return L$(Y,X,$);if(typeof Y?.then==="function")return Y.then((Q)=>c1(Q,X));if(typeof Y?.toResponse==="function")return c1(Y.toResponse(),X);if("charCodeAt"in Y){let Q=Y.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify(Y),X)}}return new Response(Y)}},dX=(Y,X)=>{switch(Y?.constructor?.name){case"String":return new Response(Y);case"Object":case"Array":return new Response(JSON.stringify(Y),{headers:{"Content-Type":"application/json"}});case"ElysiaFile":return e0(Y.value);case"File":return e0(Y);case"Blob":return e0(Y);case"ElysiaCustomStatusResponse":return p1(Y.response,{status:Y.code,headers:{}});case void 0:if(!Y)return new Response("");return new Response(JSON.stringify(Y),{headers:{"content-type":"application/json"}});case"Response":return Y;case"Error":return B8(Y);case"Promise":return Y.then(($)=>dX($,X));case"Function":return dX(Y(),X);case"Number":case"Boolean":return new Response(Y.toString());case"FormData":return new Response(Y);default:if(Y instanceof Response)return Y;if(Y instanceof Promise)return Y.then(($)=>dX($,X));if(Y instanceof Error)return B8(Y);if(Y instanceof V1)return p1(Y.response,{status:Y.code,headers:{}});if(typeof Y?.next==="function"||Y instanceof ReadableStream)return L$(Y,void 0,X);if(typeof Y?.then==="function")return Y.then(($)=>p1($,set));if(typeof Y?.toResponse==="function")return dX(Y.toResponse());if("charCodeAt"in Y){let $=Y.charCodeAt(0);if($===123||$===91)return new Response(JSON.stringify(Y),{headers:{"Content-Type":"application/json"}})}return new Response(Y)}},B8=(Y,X)=>new Response(JSON.stringify({name:Y?.name,message:Y?.message,cause:Y?.cause}),{status:X?.status!==200?X?.status??500:500,headers:X?.headers}),EK=(Y,X,$={})=>{if(typeof Y==="function")return;let Q=p1(Y,{headers:$});if(!X.parse?.length&&!X.transform?.length&&!X.beforeHandle?.length&&!X.afterHandle?.length)return()=>Q.clone()},QZ=pN({mapResponse:p1,mapCompactResponse:dX}),L$=G4({mapResponse:p1,mapCompactResponse:dX}),VK=S$(WZ(),1),F6=S$(WZ(),1),C6=1,R6=2,j6=4,mX=8;function oN(Y,X=0,$,Q){let Z=Object.create(null),W=0,J=Y.length,M=X-1,N=M;for(let G=0;G<J;G++)switch(Y.charCodeAt(G)){case 38:U(Y,G),M=G,N=G,W=0;break;case 61:if(N<=M)N=G;else W|=mX;break;case 43:if(N>M)W|=j6;else W|=C6;break;case 37:if(N>M)W|=mX;else W|=R6;break}if(M<J)U(Y,J);return Z;function U(G,A){let O=N>M,B=O?N:A,z=G.slice(M+1,B);if(!O&&z.length===0)return;let H=z;if(W&C6)H=H.replace(/\+/g," ");if(W&R6)H=F6.default(H)||H;let P="";if(O){let D=G.slice(N+1,A);if(W&j6)D=D.replace(/\+/g," ");if(W&mX)D=F6.default(D)||D;P=D}let R=Z[H];if($?.[H])if(P.charCodeAt(0)===91){if(Q?.[H])P=JSON.parse(P);else P=P.slice(1,-1).split(",");if(R===void 0)Z[H]=P;else if(Array.isArray(R))R.push(...P);else Z[H]=P,Z[H].unshift(R)}else if(R===void 0)Z[H]=P;else if(Array.isArray(R))R.push(P);else Z[H]=[R,P];else Z[H]=P}}function IK(Y,X=0){let $=Object.create(null),Q=0,Z=Y.length,W=X-1,J=W;for(let N=0;N<Z;N++)switch(Y.charCodeAt(N)){case 38:M(Y,N),W=N,J=N,Q=0;break;case 61:if(J<=W)J=N;else Q|=mX;break;case 43:if(J>W)Q|=j6;else Q|=C6;break;case 37:if(J>W)Q|=mX;else Q|=R6;break}if(W<Z)M(Y,Z);return $;function M(N,U){let G=J>W,A=G?J:U,O=N.slice(W+1,A);if(!G&&O.length===0)return;let B=O;if(Q&C6)B=B.replace(/\+/g," ");if(Q&R6)B=F6.default(B)||B;let z="";if(G){let P=N.slice(J+1,U);if(Q&j6)P=P.replace(/\+/g," ");if(Q&mX)P=F6.default(P)||P;z=P}let H=$[B];if(z.charCodeAt(0)===91&&z.charCodeAt(z.length-1)===93){try{z=JSON.parse(z)}catch{}if(H===void 0)$[B]=z;else if(Array.isArray(H))H.push(z);else $[B]=[H,z]}else if(z.charCodeAt(0)===123&&z.charCodeAt(z.length-1)===125){try{z=JSON.parse(z)}catch{}if(H===void 0)$[B]=z;else if(Array.isArray(H))H.push(z);else $[B]=[H,z]}else{if(z.includes(","))z=z.split(",");if(H===void 0)$[B]=z;else if(Array.isArray(H))H.push(z);else $[B]=[H,z]}}}function L6(Y){let X=Object.create(null),$=0,Q=Y.length,Z=-1,W=-1;for(let M=0;M<Q;M++)switch(Y.charCodeAt(M)){case 38:J(Y,M),Z=M,W=M,$=0;break;case 61:if(W<=Z)W=M;else $|=mX;break;case 43:if(W>Z)$|=j6;else $|=C6;break;case 37:if(W>Z)$|=mX;else $|=R6;break}if(Z<Q)J(Y,Q);return X;function J(M,N){let U=W>Z,G=U?W:N,A=M.slice(Z+1,G);if(!U&&A.length===0)return;let O=A;if($&C6)O=O.replace(/\+/g," ");if($&R6)O=F6.default(O)||O;let B="";if(U){let H=M.slice(W+1,N);if($&j6)H=H.replace(/\+/g," ");if($&mX)H=F6.default(H)||H;B=H}let z=X[O];if(z===void 0)X[O]=B;else if(Array.isArray(z))z.push(B);else X[O]=[z,B]}}var NZ=Symbol("ElysiaTrace"),fX=()=>{let{promise:Y,resolve:X}=Promise.withResolvers(),{promise:$,resolve:Q}=Promise.withResolvers(),{promise:Z,resolve:W}=Promise.withResolvers(),J=[],M=[];return[(N)=>{if(N)J.push(N);return Y},(N)=>{let U=[],G=[],A=null;for(let B=0;B<(N.total??0);B++){let{promise:z,resolve:H}=Promise.withResolvers(),{promise:P,resolve:R}=Promise.withResolvers(),{promise:D,resolve:C}=Promise.withResolvers(),g=[],c=[];U.push((f)=>{if(f)g.push(f);return z}),G.push((f)=>{let y={...f,end:P,error:D,index:B,onStop(v){if(v)c.push(v);return P}};H(y);for(let v=0;v<g.length;v++)g[v](y);return(v=null)=>{let E=performance.now();if(v)A=v;let k={end:E,error:v,get elapsed(){return E-f.begin}};for(let b=0;b<c.length;b++)c[b](k);R(E),C(v)}})}let O={...N,end:$,error:Z,onEvent(B){for(let z=0;z<U.length;z++)U[z](B)},onStop(B){if(B)M.push(B);return $}};X(O);for(let B=0;B<J.length;B++)J[B](O);return{resolveChild:G,resolve(B=null){let z=performance.now();if(!B&&A)B=A;let H={end:z,error:B,get elapsed(){return z-N.begin}};for(let P=0;P<M.length;P++)M[P](H);Q(z),W(B)}}}]},TK=(Y)=>{return(X)=>{let[$,Q]=fX(),[Z,W]=fX(),[J,M]=fX(),[N,U]=fX(),[G,A]=fX(),[O,B]=fX(),[z,H]=fX(),[P,R]=fX(),[D,C]=fX();return Y({id:X[P$],context:X,set:X.set,onRequest:$,onParse:Z,onTransform:J,onBeforeHandle:N,onHandle:G,onAfterHandle:O,onMapResponse:P,onAfterResponse:D,onError:z,time:Date.now(),store:X.store}),{request:Q,parse:W,transform:M,beforeHandle:U,handle:A,afterHandle:B,error:H,mapResponse:R,afterResponse:C}}},$Y=Symbol.for("TypeBox.Kind"),xK=Symbol.for("TypeBox.Hint"),tN=(Y)=>/(\ |-|\t|\n|\.)/.test(Y)||!isNaN(+Y[0]),rN=(Y,X,$=!1)=>{if(typeof X==="number")return`${Y}[${X}]`;if(tN(X))return`${Y}${$?"?.":""}["${X}"]`;return`${Y}${$?"?":""}.${X}`},bK=(Y)=>tN(Y)?`"${Y}"`:Y,PN=(Y,X=0,$)=>{if($.type!=="string"||$.const||$.trusted)return Y;let Q="";for(let Z=X-1;Z>=0;Z--)Q+=`d.h${Z}(`;return Q+Y+")".repeat(X)},sN=(Y)=>{if(!Y.allOf||$Y in Y&&(Y[$Y]!=="Intersect"||Y.type!=="object"))return Y;let{allOf:X,...$}=Y;if($.properties={},$Y in $)$[$Y]="Object";for(let Q of X){if(Q.type!=="object")continue;let{properties:Z,required:W,type:J,[$Y]:M,...N}=Q;if(W)$.required=$.required?$.required.concat(W):W;Object.assign($,N);for(let U in Q.properties)$.properties[U]=sN(Q.properties[U])}return $},gK=(Y,X,$)=>{let Q=Y.patternProperties["^(.*)$"]??Y.patternProperties[Object.keys(Y.patternProperties)[0]];if(!Q)return X;let Z=$.array;$.array++;let W=`(()=>{const ar${Z}s=Object.keys(${X}),ar${Z}v={};for(let i=0;i<ar${Z}s.length;i++){const ar${Z}p=${X}[ar${Z}s[i]];ar${Z}v[ar${Z}s[i]]=${yX(Q,`ar${Z}p`,$)}`,J=$.optionalsInArray[Z+1];if(J)for(let M=0;M<J.length;M++){let N=`ar${Z}v[ar${Z}s[i]].${J[M]}`;W+=`;if(${N}===undefined)delete ${N}`}return W+=`}return ar${Z}v})()`,W},kK=(Y,X,$)=>{let Q=$.array;$.array++;let Z=X==="v"&&!$.unions.length,W="";if(!Z)W="(()=>{";W+=`const ar${Q}v=[`;for(let J=0;J<Y.length;J++){if(J!==0)W+=",";W+=yX(Y[J],rN(X,J,$.parentIsOptional),$)}if(W+="];",!Z)W+=`return ar${Q}v})()`;return W};function ZZ(Y,X=new WeakMap){if(Y===null||typeof Y!=="object"||typeof Y==="function")return Y;if(X.has(Y))return X.get(Y);if(Array.isArray(Y)){let $=Array(Y.length);X.set(Y,$);for(let Q=0;Q<Y.length;Q++)$[Q]=ZZ(Y[Q],X);return $}if(typeof Y==="object"){let $=Object.keys(Y).concat(Object.getOwnPropertySymbols(Y)),Q={};for(let Z of $)Q[Z]=ZZ(Y[Z],X);return Q}return Y}var fK=(Y,X,$)=>{if($.TypeCompiler===void 0){if(!$.typeCompilerWanred)console.warn(Error("[exact-mirror] TypeBox's TypeCompiler is required to use Union")),$.typeCompilerWanred=!0;return X}$.unionKeys[X]=1;let Q=$.unions.length,Z=$.unions[Q]=[],W=`(()=>{
`,J=(M)=>{if(!($Y in M)||!M.$ref)return M;if(M[$Y]==="This")return ZZ($.definitions[M.$ref]);else if(M[$Y]==="Ref")if(!$.modules)console.warn(Error("[exact-mirror] modules is required when using nested cyclic reference"));else return $.modules.Import(M.$ref);return M};for(let M=0;M<Y.length;M++){let N=J(Y[M]);if(Array.isArray(N.anyOf))for(let U=0;U<N.anyOf.length;U++)N.anyOf[U]=J(N.anyOf[U]);else if(N.items)if(Array.isArray(N.items))for(let U=0;U<N.items.length;U++)N.items[U]=J(N.items[U]);else N.items=J(N.items);Z.push(aY.Compile(N)),W+=`if(d.unions[${Q}][${M}].Check(${X})){return ${yX(N,X,{...$,recursion:$.recursion+1,parentIsOptional:!0})}}
`}return W+=`return ${$.removeUnknownUnionType?"undefined":X}})()`,W},yX=(Y,X,$)=>{if(!Y)return"";let Q=X==="v"&&!$.unions.length;if($Y in Y&&Y[$Y]==="Import"&&Y.$ref in Y.$defs)return yX(Y.$defs[Y.$ref],X,{...$,definitions:Object.assign($.definitions,Y.$defs)});if(Q&&Y.type!=="object"&&Y.type!=="array"&&!Y.anyOf)return`return ${PN("v",$.sanitize?.length,Y)}`;if($.recursion>=$.recursionLimit)return X;let Z="";if(Y.$id&&xK in Y)$.definitions[Y.$id]=Y;switch(Y.type){case"object":if(Y[$Y]==="Record"){Z=gK(Y,X,$);break}if(Y=sN(Y),Z+="{",Y.additionalProperties)Z+=`...${X},`;let W=Object.keys(Y.properties);for(let U=0;U<W.length;U++){let G=W[U],A=!Y.required||Y.required&&!Y.required.includes(G)||Array.isArray(Y.properties[G].anyOf),O=rN(X,G,$.parentIsOptional);if(A){let z=$.array;if(X.startsWith("ar")){let H=O.slice(O.indexOf(".")+1),P=$.optionalsInArray;if(P[z])P[z].push(H);else P[z]=[H]}else $.optionals.push(O)}let B=Y.properties[G];if(U!==0)Z+=",";Z+=`${bK(G)}:${A?`${O}===undefined?undefined:`:""}${yX(B,O,{...$,recursion:$.recursion+1,parentIsOptional:A})}`}Z+="}";break;case"array":if(Y.items.type!=="object"&&Y.items.type!=="array")if(Array.isArray(Y.items)){Z=kK(Y.items,X,$);break}else if(Q)return"return v";else if($Y in Y.items&&Y.items.$ref&&(Y.items[$Y]==="Ref"||Y.items[$Y]==="This"))Z=yX(ZZ($.definitions[Y.items.$ref]),X,{...$,parentIsOptional:!0,recursion:$.recursion+1});else{Z=X;break}let J=$.array;$.array++;let M=X;if(Q)Z=`const ar${J}v=new Array(${X}.length);`;else M=`ar${J}s`,Z=`((${M})=>{const ar${J}v=new Array(${M}.length);`;Z+=`for(let i=0;i<${M}.length;i++){const ar${J}p=${M}[i];ar${J}v[i]=${yX(Y.items,`ar${J}p`,$)}`;let N=$.optionalsInArray[J+1];if(N)for(let U=0;U<N.length;U++){let G=`ar${J}v[i].${N[U]}`;Z+=`;if(${G}===undefined)delete ${G}`}if(Z+="}",!Q)Z+=`return ar${J}v})(${X})`;break;default:if(Y.$ref&&Y.$ref in $.definitions)return yX($.definitions[Y.$ref],X,$);if(Array.isArray(Y.anyOf)){Z=fK(Y.anyOf,X,$);break}Z=PN(X,$.sanitize?.length,Y);break}if(!Q)return Z;if(Y.type==="array")Z=`${Z}const x=ar0v;`;else Z=`const x=${Z}
`;for(let W=0;W<$.optionals.length;W++){let J=$.optionals[W],M=J.slice(1);if(Z+=`if(${J}===undefined`,$.unionKeys[J])Z+=`||x${M}===undefined`;let N=M.charCodeAt(0)!==63&&Y.type!=="array";Z+=`)delete x${N?M.charCodeAt(0)===91?"?.":"?":""}${M}
`}return`${Z}return x`},dW=(Y,{TypeCompiler:X,modules:$,definitions:Q,sanitize:Z,recursionLimit:W=8,removeUnknownUnionType:J=!1}={})=>{let M=[];if(typeof Z==="function")Z=[Z];let N=yX(Y,"v",{optionals:[],optionalsInArray:[],array:0,parentIsOptional:!1,unions:M,unionKeys:{},TypeCompiler:X,modules:$,definitions:Q??$?.$defs??{},sanitize:Z,recursion:0,recursionLimit:W,removeUnknownUnionType:J});if(!M.length&&!Z?.length)return Function("v",N);let U;if(Z?.length){U={};for(let G=0;G<Z.length;G++)U[`h${G}`]=Z[G]}return Function("d",`return function mirror(v){${N}}`)({unions:M,...U})},Q4=(Y)=>{if(!Y)return!1;if(Y?.[S]==="Import"&&Y.References)return Y.References().some(Q4);if(Y.schema)Y=Y.schema;return!!Y&&H1 in Y},zX=(Y)=>{if(!Y)return!1;let X=Y?.schema??Y;if(X[S]==="Import"&&Y.References)return Y.References().some(zX);if(X.anyOf)return X.anyOf.some(zX);if(X.someOf)return X.someOf.some(zX);if(X.allOf)return X.allOf.some(zX);if(X.not)return X.not.some(zX);if(X.type==="object"){let $=X.properties;if("additionalProperties"in X)return X.additionalProperties;if("patternProperties"in X)return!1;for(let Q of Object.keys($)){let Z=$[Q];if(Z.type==="object"){if(zX(Z))return!0}else if(Z.anyOf){for(let W=0;W<Z.anyOf.length;W++)if(zX(Z.anyOf[W]))return!0}return Z.additionalProperties}return!1}if(X.type==="array"&&X.items&&!Array.isArray(X.items))return zX(X.items);return!1},N8=(Y,X)=>{if(!X)return!1;if(S in X&&X[S]===Y)return!0;if(X.type==="object"){let $=X.properties;if(!$)return!1;for(let Q of Object.keys($)){let Z=$[Q];if(Z.type==="object"){if(N8(Y,Z))return!0}else if(Z.anyOf){for(let W=0;W<Z.anyOf.length;W++)if(N8(Y,Z.anyOf[W]))return!0}if(S in Z&&Z[S]===Y)return!0}return!1}return!!X.properties&&S in X.properties&&X.properties[S]===Y},qX=(Y,X)=>{if(!X)return!1;let $=X?.schema??X;if($.elysiaMeta===Y)return!0;if($[S]==="Import"&&X.References)return X.References().some((Q)=>qX(Y,Q));if($.anyOf)return $.anyOf.some((Q)=>qX(Y,Q));if($.someOf)return $.someOf.some((Q)=>qX(Y,Q));if($.allOf)return $.allOf.some((Q)=>qX(Y,Q));if($.not)return $.not.some((Q)=>qX(Y,Q));if($.type==="object"){let Q=$.properties;for(let Z of Object.keys(Q)){let W=Q[Z];if(W.type==="object"){if(qX(Y,W))return!0}else if(W.anyOf){for(let J=0;J<W.anyOf.length;J++)if(qX(Y,W.anyOf[J]))return!0}return $.elysiaMeta===Y}return!1}if($.type==="array"&&$.items&&!Array.isArray($.items))return qX(Y,$.items);return!1},q$=(Y,X)=>{if(!X)return;let $=X.schema??X;if($[S]==="Import"&&X.References)return X.References().some((Q)=>q$(Y,Q));if($.type==="object"){let Q=$.properties;if(!Q)return!1;for(let Z of Object.keys(Q)){let W=Q[Z];if(Y in W)return!0;if(W.type==="object"){if(q$(Y,W))return!0}else if(W.anyOf){for(let J=0;J<W.anyOf.length;J++)if(q$(Y,W.anyOf[J]))return!0}}return!1}return Y in $},XX=(Y)=>{if(!Y)return!1;if(Y.oneOf){for(let X=0;X<Y.oneOf.length;X++)if(XX(Y.oneOf[X]))return!0}if(Y.anyOf){for(let X=0;X<Y.anyOf.length;X++)if(XX(Y.anyOf[X]))return!0}if(Y.oneOf){for(let X=0;X<Y.oneOf.length;X++)if(XX(Y.oneOf[X]))return!0}if(Y.allOf){for(let X=0;X<Y.allOf.length;X++)if(XX(Y.allOf[X]))return!0}if(Y.not&&XX(Y.not))return!0;if(Y.type==="object"&&Y.properties){let X=Y.properties;for(let $ of Object.keys(X)){let Q=X[$];if(XX(Q))return!0;if(Q.type==="array"&&Q.items&&XX(Q.items))return!0}}if(Y.type==="array"&&Y.items&&XX(Y.items))return!0;return Y[S]==="Ref"&&"$ref"in Y},$X=(Y)=>{if(!Y)return!1;if(Y.$ref&&Y.$defs&&Y.$ref in Y.$defs&&$X(Y.$defs[Y.$ref]))return!0;if(Y.oneOf){for(let X=0;X<Y.oneOf.length;X++)if($X(Y.oneOf[X]))return!0}if(Y.anyOf){for(let X=0;X<Y.anyOf.length;X++)if($X(Y.anyOf[X]))return!0}if(Y.allOf){for(let X=0;X<Y.allOf.length;X++)if($X(Y.allOf[X]))return!0}if(Y.not&&$X(Y.not))return!0;if(Y.type==="object"&&Y.properties){let X=Y.properties;for(let $ of Object.keys(X)){let Q=X[$];if($X(Q))return!0;if(Q.type==="array"&&Q.items&&$X(Q.items))return!0}}if(Y.type==="array"&&Y.items&&$X(Y.items))return!0;return R0 in Y},mW=(Y,X,$={})=>{let Q=$;if(Q.root=!0,!Array.isArray(X))return X.original=Y,O1(Y,X,Q);for(let Z of X)Z.original=Y,Y=O1(Y,Z,Q);return Y},O1=(Y,X,$)=>{if(!Y)return Y;let Q=$.root;if(X.onlyFirst&&Y.type===X.onlyFirst)return X.to(Y)??Y;if(X.untilObjectFound&&!Q&&Y.type==="object")return Y;let Z=X.from[S];if(Y.oneOf){for(let M=0;M<Y.oneOf.length;M++)Y.oneOf[M]=O1(Y.oneOf[M],X,$);return Y}if(Y.anyOf){for(let M=0;M<Y.anyOf.length;M++)Y.anyOf[M]=O1(Y.anyOf[M],X,$);return Y}if(Y.allOf){for(let M=0;M<Y.allOf.length;M++)Y.allOf[M]=O1(Y.allOf[M],X,$);return Y}if(Y.not)return O1(Y.not,X,$);let W=Q&&!!X.excludeRoot;if(Y[S]===Z){let{anyOf:M,oneOf:N,allOf:U,not:G,properties:A,items:O,...B}=Y,z=X.to(B);if(!z)return Y;let H,P=(D)=>{let C=R(D);if(C.$id)delete C.$id;return C},R=(D)=>{if(A&&D.type==="object"){let g={};for(let[c,f]of Object.entries(A))g[c]=O1(f,X,{...$,root:!1});return{...B,...D,properties:g}}if(O&&D.type==="array")return{...B,...D,items:O1(O,X,{...$,root:!1})};let C={...B,...D};if(delete C.required,A&&D.type==="string"&&D.format==="ObjectString"&&D.default==="{}")H=w.ObjectString(A,B),C.properties=A;else if(O&&D.type==="string"&&D.format==="ArrayString"&&D.default==="[]")H=w.ArrayString(O,B),C.items=O;return C};if(W){if(A){let D={};for(let[C,g]of Object.entries(A))D[C]=O1(g,X,{...$,root:!1});return{...B,properties:D}}else if(O?.map)return{...B,items:O.map((D)=>O1(D,X,{...$,root:!1}))};return B}if(z.anyOf)for(let D=0;D<z.anyOf.length;D++)z.anyOf[D]=P(z.anyOf[D]);else if(z.oneOf)for(let D=0;D<z.oneOf.length;D++)z.oneOf[D]=P(z.oneOf[D]);else if(z.allOf)for(let D=0;D<z.allOf.length;D++)z.allOf[D]=P(z.allOf[D]);else if(z.not)z.not=P(z.not);if(H)z[R0]=H[R0];if(z.anyOf||z.oneOf||z.allOf||z.not)return z;if(A){let D={};for(let[C,g]of Object.entries(A))D[C]=O1(g,X,{...$,root:!1});return{...B,...z,properties:D}}else if(O?.map)return{...B,...z,items:O.map((D)=>O1(D,X,{...$,root:!1}))};return{...B,...z}}let J=Y?.properties;if(J&&Q&&X.rootOnly!==!0)for(let[M,N]of Object.entries(J))switch(N[S]){case Z:let{anyOf:U,oneOf:G,allOf:A,not:O,type:B,...z}=N,H=X.to(z);if(!H)return Y;if(H.anyOf)for(let P=0;P<H.anyOf.length;P++)H.anyOf[P]={...z,...H.anyOf[P]};else if(H.oneOf)for(let P=0;P<H.oneOf.length;P++)H.oneOf[P]={...z,...H.oneOf[P]};else if(H.allOf)for(let P=0;P<H.allOf.length;P++)H.allOf[P]={...z,...H.allOf[P]};else if(H.not)H.not={...z,...H.not};J[M]={...z,...O1(z,X,{...$,root:!1})};break;case"Object":case"Union":J[M]=O1(N,X,{...$,root:!1});break;default:if(Array.isArray(N.items))for(let P=0;P<N.items.length;P++)N.items[P]=O1(N.items[P],X,{...$,root:!1});else if(N.anyOf||N.oneOf||N.allOf||N.not)J[M]=O1(N,X,{...$,root:!1});else if(N.type==="array")N.items=O1(N.items,X,{...$,root:!1});break}if(Y.type==="array"&&Y.items)if(Array.isArray(Y.items))Y.items=Y.items.map((M)=>O1(M,X,{...$,root:!1}));else Y.items=O1(Y.items,X,{...$,root:!1});return Y},q6=(Y)=>(X)=>{if(typeof X==="object")try{return F0.Clean(Y,X)}catch{}return X},w1=(Y,{models:X={},dynamic:$=!1,modules:Q,normalize:Z=!1,additionalProperties:W=!1,forceAdditionalProperties:J=!1,coerce:M=!1,additionalCoerce:N=[],validators:U,sanitize:G}={})=>{if(U=U?.filter((R)=>R),!Y){if(!U?.length)return;Y=U[0],U=U.slice(1)}let A=void 0,O=(R)=>{if(M)return mW(R,[{from:w.Number(),to:(D)=>w.Numeric(D),untilObjectFound:!0},{from:w.Boolean(),to:(D)=>w.BooleanString(D),untilObjectFound:!0},...Array.isArray(N)?N:[N]]);return mW(R,N)},B=(R)=>{if(R&&typeof R!=="string"&&"~standard"in R)return R;if(!R)return;let D;if(typeof R!=="string")D=R;else if(D=Q&&R in Q.$defs?Q.Import(R):X[R],!D)return;if(S in D){if(D[S]==="Import"){if(!XX(D.$defs[D.$ref])){if(D=D.$defs[D.$ref],M||N)D=O(D)}}else if(XX(D)){let C=MZ();D=w.Module({...Q?.$defs,[C]:D}).Import(C)}else if(M||N)D=O(D)}return D},z=B(Y),H=U;if("~standard"in z||U?.length&&U.some((R)=>R&&typeof R!=="string"&&("~standard"in R))){let R=(f)=>{let y;if(Z===!0||Z==="exactMirror")try{y=dW(f,{TypeCompiler:aY,sanitize:G?.(),modules:Q})}catch{console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.warn(f),y=q6(f)}let v=w1(f,{models:X,modules:Q,dynamic:$,normalize:Z,additionalProperties:!0,forceAdditionalProperties:!0,coerce:M,additionalCoerce:N});return v.Decode=y,(E)=>{if(v.Check(E))return{value:v.Decode(E)};else return{issues:[...v.Errors(E)]}}},D=z["~standard"]?z["~standard"].validate:R(z),C=[];if(U?.length)for(let f of U){if(!f)continue;if(typeof f==="string")continue;if(f?.["~standard"]){C.push(f["~standard"]);continue}if(S in f){C.push(R(f));continue}}async function g(f){let y=D(f);if(y instanceof Promise)y=await y;if(y.issues)return y;let v=[];if(y&&typeof y==="object")v.push(y.value);for(let k=0;k<C.length;k++){if(y=C[k].validate(f),y instanceof Promise)y=await y;if(y.issues)return y;if(y&&typeof y==="object")v.push(y.value)}if(!v.length)return{value:y};if(v.length===1)return{value:v[0]};if(v.length===2)return{value:E1(v[0],v[1])};let E=E1(v[0],v[1]);for(let k=2;k<v.length;k++)E=E1(E,v[k]);return{value:E}}let c={provider:"standard",schema:z,references:"",checkFunc:()=>{},code:"",Check:g,Errors:(f)=>g(f)?.then?.((y)=>y?.issues),Code:()=>"",Decode:g,Encode:(f)=>f,hasAdditionalProperties:!1,hasDefault:!1,isOptional:!1,hasTransform:!1,hasRef:!1};return c.parse=(f)=>{try{return c.Decode(c.Clean?.(f)??f)}catch(y){throw[...c.Errors(f)].map(x1)}},c.safeParse=(f)=>{try{return{success:!0,data:c.Decode(c.Clean?.(f)??f),error:null}}catch(y){let v=[...P.Errors(f)].map(x1);return{success:!1,data:null,error:v[0]?.summary,errors:v}}},c}else if(U?.length){let R=!1,D=H,{schema:C,notObjects:g}=vK([z,...D.map(B)]);if(g){if(z=w.Intersect([...C?[C]:[],...g.map((c)=>{let f=B(c);if(f.type==="object"&&"additionalProperties"in f){if(!R&&f.additionalProperties===!1)R=!0;delete f.additionalProperties}return f})]),z.type==="object"&&R)z.additionalProperties=!1}}else if(z.type==="object"&&(("additionalProperties"in z)===!1||J))z.additionalProperties=W;else z=mW(z,{onlyFirst:"object",from:w.Object({}),to({properties:R,...D}){if(!R)return;if("additionalProperties"in z)return;return w.Object(R,{...D,additionalProperties:!1})}});if($)if(S in z){let R={provider:"typebox",schema:z,references:"",checkFunc:()=>{},code:"",Check:(D)=>F0.Check(z,D),Errors:(D)=>F0.Errors(z,D),Code:()=>"",Clean:q6(z),Decode:(D)=>F0.Decode(z,D),Encode:(D)=>F0.Encode(z,D),get hasAdditionalProperties(){if("~hasAdditionalProperties"in this)return this["~hasAdditionalProperties"];return this["~hasAdditionalProperties"]=zX(z)},get hasDefault(){if("~hasDefault"in this)return this["~hasDefault"];return this["~hasDefault"]=q$("default",z)},get isOptional(){if("~isOptional"in this)return this["~isOptional"];return this["~isOptional"]=Q4(z)},get hasTransform(){if("~hasTransform"in this)return this["~hasTransform"];return this["~hasTransform"]=$X(z)},"~hasRef":A,get hasRef(){if("~hasRef"in this)return this["~hasRef"];return this["~hasRef"]=$X(z)}};if(z.config){if(R.config=z.config,R?.schema?.config)delete R.schema.config}if(Z&&z.additionalProperties===!1)if(Z===!0||Z==="exactMirror")try{R.Clean=dW(z,{TypeCompiler:aY,sanitize:G?.(),modules:Q})}catch{console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.warn(z),R.Clean=q6(z)}else R.Clean=q6(z);return R.parse=(D)=>{try{return R.Decode(R.Clean?.(D)??D)}catch(C){throw[...R.Errors(D)].map(x1)}},R.safeParse=(D)=>{try{return{success:!0,data:R.Decode(R.Clean?.(D)??D),error:null}}catch(C){let g=[...P.Errors(D)].map(x1);return{success:!1,data:null,error:g[0]?.summary,errors:g}}},R}else{let R={provider:"standard",schema:z,references:"",checkFunc:()=>{},code:"",Check:(D)=>z["~standard"].validate(D),Errors(D){let C=z["~standard"].validate(D);if(C instanceof Promise)throw Error("Async validation is not supported in non-dynamic schema");return C.issues},Code:()=>"",Decode(D){let C=z["~standard"].validate(D);if(C instanceof Promise)throw Error("Async validation is not supported in non-dynamic schema");return C},Encode:(D)=>D,hasAdditionalProperties:!1,hasDefault:!1,isOptional:!1,hasTransform:!1,hasRef:!1};return R.parse=(D)=>{try{return R.Decode(R.Clean?.(D)??D)}catch(C){throw[...R.Errors(D)].map(x1)}},R.safeParse=(D)=>{try{return{success:!0,data:R.Decode(R.Clean?.(D)??D),error:null}}catch(C){let g=[...P.Errors(D)].map(x1);return{success:!1,data:null,error:g[0]?.summary,errors:g}}},R}let P;if(S in z){if(P=aY.Compile(z,Object.values(X).filter((R)=>(S in R))),P.provider="typebox",z.config){if(P.config=z.config,P?.schema?.config)delete P.schema.config}if(Z===!0||Z==="exactMirror")try{P.Clean=dW(z,{TypeCompiler:aY,sanitize:G?.(),modules:Q})}catch(R){console.warn("Failed to create exactMirror. Please report the following code to https://github.com/elysiajs/elysia/issues"),console.dir(z,{depth:null}),P.Clean=q6(z)}else if(Z==="typebox")P.Clean=q6(z)}else P={provider:"standard",schema:z,references:"",checkFunc(R){let D=z["~standard"].validate(R);if(D instanceof Promise)throw Error("Async validation is not supported in non-dynamic schema");return D},code:"",Check:(R)=>z["~standard"].validate(R),Errors(R){let D=z["~standard"].validate(R);if(D instanceof Promise)throw Error("Async validation is not supported in non-dynamic schema");return D.issues},Code:()=>"",Decode(R){let D=z["~standard"].validate(R);if(D instanceof Promise)throw Error("Async validation is not supported in non-dynamic schema");return D},Encode:(R)=>R,hasAdditionalProperties:!1,hasDefault:!1,isOptional:!1,hasTransform:!1,hasRef:!1};if(P.parse=(R)=>{try{return P.Decode(P.Clean?.(R)??R)}catch(D){throw[...P.Errors(R)].map(x1)}},P.safeParse=(R)=>{try{return{success:!0,data:P.Decode(P.Clean?.(R)??R),error:null}}catch(D){let C=[...P.Errors(R)].map(x1);return{success:!1,data:null,error:C[0]?.summary,errors:C}}},S in z)Object.assign(P,{get hasAdditionalProperties(){if("~hasAdditionalProperties"in this)return this["~hasAdditionalProperties"];return this["~hasAdditionalProperties"]=zX(P)},get hasDefault(){if("~hasDefault"in this)return this["~hasDefault"];return this["~hasDefault"]=q$("default",P)},get isOptional(){if("~isOptional"in this)return this["~isOptional"];return this["~isOptional"]=Q4(P)},get hasTransform(){if("~hasTransform"in this)return this["~hasTransform"];return this["~hasTransform"]=$X(z)},get hasRef(){if("~hasRef"in this)return this["~hasRef"];return this["~hasRef"]=XX(z)},"~hasRef":A});return P},yK=(Y)=>Y[S]==="Union"||!Y.schema&&!!Y.anyOf,vK=(Y)=>{if(Y.length===0)return{schema:void 0,notObjects:[]};if(Y.length===1)return Y[0].type==="object"?{schema:Y[0],notObjects:[]}:{schema:void 0,notObjects:Y};let X,$=[],Q=!1,Z=!1;for(let W of Y){if(W.type!=="object"){$.push(W);continue}if("additionalProperties"in W){if(W.additionalProperties===!0)Q=!0;else if(W.additionalProperties===!1)Z=!0}if(!X){X=W;continue}X={...X,...W,properties:{...X.properties,...W.properties},required:[...X?.required??[],...W.required??[]]}}if(X){if(X.required)X.required=[...new Set(X.required)];if(Z)X.additionalProperties=!1;else if(Q)X.additionalProperties=!0}return{schema:X,notObjects:$}},FN=(Y,{models:X={},modules:$,dynamic:Q=!1,normalize:Z=!1,additionalProperties:W=!1,validators:J=[],sanitize:M})=>{if(J=J.filter((G)=>G),!Y){if(!J?.length)return;Y=J[0],J=J.slice(1)}let N;if(typeof Y!=="string")N=Y;else if(N=$&&Y in $.$defs?$.Import(Y):X[Y],!N)return;if(!N)return;if(S in N||"~standard"in N)return{200:w1(N,{modules:$,models:X,additionalProperties:W,dynamic:Q,normalize:Z,coerce:!1,additionalCoerce:[],validators:J.map((G)=>G[200]),sanitize:M})};let U={};return Object.keys(N).forEach((G)=>{if(isNaN(+G))return;let A=N[+G];if(typeof A==="string"){if(A in X){let O=X[A];if(!O)return;U[+G]=S in O||"~standard"in O?w1(O,{modules:$,models:X,additionalProperties:W,dynamic:Q,normalize:Z,coerce:!1,additionalCoerce:[],validators:J.map((B)=>B[+G]),sanitize:M}):O}return}U[+G]=S in A||"~standard"in A?w1(A,{modules:$,models:X,additionalProperties:W,dynamic:Q,normalize:Z,coerce:!1,additionalCoerce:[],validators:J.map((O)=>O[+G]),sanitize:M}):A}),U},uW,B$=()=>{if(!uW)uW=[{from:w.Object({}),to:()=>w.ObjectString({}),excludeRoot:!0},{from:w.Array(w.Any()),to:()=>w.ArrayString(w.Any())}];return uW},cW,CN=()=>{if(!cW)cW=[{from:w.Object({}),to:()=>w.ObjectString({}),excludeRoot:!0},{from:w.Array(w.Any()),to:()=>w.ArrayQuery(w.Any())}];return cW},pW,Z4=()=>{if(!pW)pW=[{from:w.Number(),to:(Y)=>w.Numeric(Y),rootOnly:!0},{from:w.Boolean(),to:(Y)=>w.BooleanString(Y),rootOnly:!0}];return pW},hK=({validator:Y,modules:X,defaultConfig:$={},config:Q,dynamic:Z,normalize:W=!1,models:J,validators:M,sanitize:N})=>{let U=Y?.provider?Y:w1(Y,{modules:X,dynamic:Z,models:J,normalize:W,additionalProperties:!0,coerce:!0,additionalCoerce:B$(),validators:M,sanitize:N});if(U)U.config=rW(U.config,Q);else U=w1(w.Cookie(w.Any()),{modules:X,dynamic:Z,models:J,additionalProperties:!0,validators:M,sanitize:N}),U.config=$;return U},O6=(Y)=>Y&&Y[S]==="Import"&&Y.$defs[Y.$ref][S]==="Object"?Y.$defs[Y.$ref]:Y,s0=(Y,X)=>X?Y:"",dK=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],K$=({context:Y="c",trace:X=[],addFn:$})=>{if(!X.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let Q=0;Q<X.length;Q++)$(`let report${Q},reportChild${Q},reportErr${Q},reportErrChild${Q};let trace${Q}=${Y}[ELYSIA_TRACE]?.[${Q}]??trace[${Q}](${Y});
`);return(Q,{name:Z,total:W=0,alias:J}={})=>{if(!Z)Z="anonymous";let M=Q==="error"?"reportErr":"report";for(let N=0;N<X.length;N++)if($(`${J?"const ":""}${J??M}${N}=trace${N}.${Q}({id,event:'${Q}',name:'${Z}',begin:performance.now(),total:${W}})
`),J)$(`${M}${N}=${J}${N}
`);return{resolve(){for(let N=0;N<X.length;N++)$(`${J??M}${N}.resolve()
`)},resolveChild(N){for(let U=0;U<X.length;U++)$(`${M}Child${U}=${M}${U}.resolveChild?.shift()?.({id,event:'${Q}',name:'${N}',begin:performance.now()})
`);return(U)=>{for(let G=0;G<X.length;G++)if(U)$(`if(${U} instanceof Error){${M}Child${G}?.(${U}) }else{${M}Child${G}?.()}`);else $(`${M}Child${G}?.()
`)}}}}},A$=({schema:Y,name:X,type:$,typeAlias:Q=$,normalize:Z,ignoreTryCatch:W=!1})=>{if(!Z||!Y.Clean)return"";if(Z===!0||Z==="exactMirror"){if(W)return`${X}=validator.${Q}.Clean(${X})
`;return`try{${X}=validator.${Q}.Clean(${X})
}catch{}`}if(Z==="typebox")return`${X}=validator.${Q}.Clean(${X})
`;return""},mK=({injectResponse:Y="",normalize:X=!1,validator:$,encodeSchema:Q=!1,isStaticResponse:Z=!1,hasSanitize:W=!1,allowUnsafeValidationDetails:J=!1})=>({validate:(M,N=`c.${M}`,U)=>`c.set.status=422;throw new ValidationError('${M}',validator.${M},${N},${J}${U?","+U:""})`,response:(M="r")=>{if(Z||!$.response)return"";let N=Y+`
`;N+=`if(${M} instanceof ElysiaCustomStatusResponse){c.set.status=${M}.code
${M}=${M}.response}if(${M} instanceof Response === false)switch(c.set.status){`;for(let[U,G]of Object.entries($.response)){if(N+=`
case ${U}:
`,G.provider==="standard"){N+=`let vare${U}=validator.response[${U}].Check(${M})
if(vare${U} instanceof Promise)vare${U}=await vare${U}
if(vare${U}.issues)throw new ValidationError('response',validator.response[${U}],${M},${J},vare${U}.issues)
${M}=vare${U}.value
c.set.status=${U}
break
`;continue}let A=G.schema?.noValidate===!0;if(!A&&G.schema?.$ref&&G.schema?.$defs){let H=G.schema.$ref,P=typeof H==="string"&&H.includes("/")?H.split("/").pop():H;if(G.schema.$defs[P]?.noValidate===!0)A=!0}let O=A||W,B=({ignoreTryCatch:H=!1}={})=>A$({name:M,schema:G,type:"response",typeAlias:`response[${U}]`,normalize:X,ignoreTryCatch:H});if(O)N+=B();let z=!O&&X&&!A;if(Q&&G.hasTransform&&!A){if(N+=`try{${M}=validator.response[${U}].Encode(${M})
`,!O)N+=B({ignoreTryCatch:!0});N+=`c.set.status=${U}}catch{`+(z?`try{
`+B({ignoreTryCatch:!0})+`${M}=validator.response[${U}].Encode(${M})
}catch{throw new ValidationError('response',validator.response[${U}],${M},${J})}`:`throw new ValidationError('response',validator.response[${U}],${M}),${J}`)+"}"}else{if(!O)N+=B();if(!A)N+=`if(validator.response[${U}].Check(${M})===false)throw new ValidationError('response',validator.response[${U}],${M},${J})
c.set.status=${U}
`}N+=`break
`}return N+"}"}}),A8=(Y)=>{return(Y?.fn??Y).constructor.name==="AsyncFunction"},uK=/=>\s?response\.clone\(/,cK=/(?:return|=>)\s?\S+\(|a(?:sync|wait)/,r0=(Y)=>{let X=typeof Y==="object";if(X&&Y.isAsync!==void 0)return Y.isAsync;let $=X?Y.fn:Y;if($.constructor.name==="AsyncFunction")return!0;let Q=$.toString();if(uK.test(Q)){if(X)Y.isAsync=!1;return!1}let Z=cK.test(Q);if(X)Y.isAsync=Z;return Z},O$=(Y)=>{let X=typeof Y==="object";if(X&&Y.hasReturn!==void 0)return Y.hasReturn;let $=X?Y.fn.toString():typeof Y==="string"?Y.toString():Y,Q=$.indexOf(")");if($.charCodeAt(Q+2)===61&&$.charCodeAt(Q+5)!==123){if(X)Y.hasReturn=!0;return!0}let Z=$.includes("return");if(X)Y.hasReturn=Z;return Z},lQ=(Y)=>{let X=Y?.fn??Y;return X.constructor.name==="AsyncGeneratorFunction"||X.constructor.name==="GeneratorFunction"},D6=(Y,X,$=!1,Q=`c.${X}`)=>`try{${Y}}catch(error){if(error.constructor.name === 'TransformDecodeError'){c.set.status=422
throw error.error ?? new ValidationError('${X}',validator.${X},${Q},${$})}}`,pK=({app:Y,path:X,method:$,hooks:Q,validator:Z,handler:W,allowMeta:J=!1,inference:M})=>{let N=Y["~adapter"].composeHandler,U=Y["~adapter"].handler,G=typeof W==="function";if(!G){W=U.mapResponse(W,{headers:Y.setHeaders??{}});let j=W instanceof Response||W?.constructor?.name==="Response"&&typeof W?.clone==="function";if(Q.parse?.length&&Q.transform?.length&&Q.beforeHandle?.length&&Q.afterHandle?.length){if(j)return Function("a",`"use strict";
return function(){return a.clone()}`)(W);return Function("a",`"use strict";
return function(){return a}`)(W)}if(j){let q=W;W=()=>q.clone()}}let A=G?"handler(c)":"handler",O=!!Q.trace?.length,B="";if(M=$Z(Object.assign({handler:W},Q),M,Y.config.sucrose),N.declare){let j=N.declare(M);if(j)B+=j}if(M.server)B+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;Z.createBody?.(),Z.createQuery?.(),Z.createHeaders?.(),Z.createParams?.(),Z.createCookie?.(),Z.createResponse?.();let z=!!Z.body||!!Z.headers||!!Z.params||!!Z.query||!!Z.cookie||!!Z.response,H=M.query||!!Z.query,P=Q.parse?.length===1&&Q.parse[0].fn==="none",R=$!==""&&$!=="GET"&&$!=="HEAD"&&(M.body||!!Z.body||!!Q.parse?.length)&&!P,D=Y.setHeaders,C=D&&!!Object.keys(D).length,g=M.headers||!!Z.headers||N.preferWebstandardHeaders!==!0&&M.body,c=M.cookie||!!Z.cookie,f=Z.cookie?.config?rW(Z?.cookie?.config,Y.config.cookie):Y.config.cookie,y="",v=()=>{if(y)return y;if(f?.sign){if(!f.secrets)throw Error(`t.Cookie required secret which is not set in (${$}) ${X}.`);let j=!f.secrets?void 0:typeof f.secrets==="string"?f.secrets:f.secrets[0];if(y+=`const _setCookie = c.set.cookie
if(_setCookie){`,f.sign===!0)y+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${j}')}`;else for(let q of f.sign)y+=`if(_setCookie['${q}']?.value)c.set.cookie['${q}'].value=await signCookie(_setCookie['${q}'].value,'${j}')
`;y+=`}
`}return y},E=Y.config.normalize,k=Y.config.encodeSchema,b=Y.config.allowUnsafeValidationDetails,u=mK({normalize:E,validator:Z,encodeSchema:k,isStaticResponse:W instanceof Response,hasSanitize:!!Y.config.sanitize,allowUnsafeValidationDetails:b});if(g)B+=N.headers;if(O)B+=`const id=c[ELYSIA_REQUEST_ID]
`;let h=K$({trace:Q.trace,addFn:(j)=>{B+=j}});if(B+="try{",c){let j=(F,_)=>{let x=f?.[F]??_;if(!x)return typeof _==="string"?`${F}:"${_}",`:`${F}:${_},`;if(typeof x==="string")return`${F}:'${x}',`;if(x instanceof Date)return`${F}: new Date(${x.getTime()}),`;return`${F}:${x},`},q=f?`{secrets:${f.secrets!==void 0?typeof f.secrets==="string"?`'${f.secrets}'`:"["+f.secrets.reduce((F,_)=>F+`'${_}',`,"")+"]":"undefined"},sign:${f.sign===!0?!0:f.sign!==void 0?"["+f.sign.reduce((F,_)=>F+`'${_}',`,"")+"]":"undefined"},`+j("domain")+j("expires")+j("httpOnly")+j("maxAge")+j("path","/")+j("priority")+j("sameSite")+j("secure")+"}":"undefined";if(g)B+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${q})
`;else B+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${q})
`}if(H){let j={},q={},F=!1,_=!1;if(Z.query?.schema){let x=O6(Z.query?.schema);if(S in x&&x.properties)for(let[m,O0]of Object.entries(x.properties)){if(qX("ArrayQuery",O0))j[m]=1,F=!0;if(qX("ObjectString",O0))q[m]=1,_=!0}}B+=`if(c.qi===-1){c.query=Object.create(null)}else{c.query=parseQueryFromURL(c.url,c.qi+1,${F?JSON.stringify(j):void 0},${_?JSON.stringify(q):void 0})}`}let L0=typeof W==="function"&&r0(W),l=O||Q.afterResponse?.length?"c.response=c.responseValue= ":"",$1=Object.keys(Z.response??{}),l1=$1.length>1,KY=$1.length===0||$1.length===1&&$1[0]==="200",P1=c||R||L0||!!Q.parse?.length||!!Q.afterHandle?.some(r0)||!!Q.beforeHandle?.some(r0)||!!Q.transform?.some(r0)||!!Q.mapResponse?.some(r0)||Z.body?.provider==="standard"||Z.headers?.provider==="standard"||Z.query?.provider==="standard"||Z.params?.provider==="standard"||Z.cookie?.provider==="standard"||Object.values(Z.response??{}).find((j)=>j.provider==="standard"),WY=(typeof W==="function"?lQ(W):!1)||!!Q.beforeHandle?.some(lQ)||!!Q.afterHandle?.some(lQ)||!!Q.transform?.some(lQ),l0=M.cookie||M.set||g||O||l1||!KY||G&&C||WY,Q1,N1=()=>{if(Q1!==void 0)return Q1;if(!Q.afterResponse?.length&&!O)return"";let j="";j+=`
setImmediate(async()=>{if(c.responseValue){if(c.responseValue instanceof ElysiaCustomStatusResponse) c.set.status=c.responseValue.code
if(afterHandlerStreamListener)for await(const v of afterHandlerStreamListener){}
}
`;let q=K$({trace:Q.trace,addFn:(F)=>{j+=F}})("afterResponse",{total:Q.afterResponse?.length});if(Q.afterResponse?.length&&Q.afterResponse)for(let F=0;F<Q.afterResponse.length;F++){let _=q.resolveChild(Q.afterResponse[F].fn.name),x=r0(Q.afterResponse[F])?"await ":"";j+=`
${x}e.afterResponse[${F}](c)
`,_()}return q.resolve(),j+=`})
`,Q1=j},J0=(j="r")=>{let q=N1(),F=`${l0?"mapResponse":"mapCompactResponse"}(${l}${j}${l0?",c.set":""}${Y1})
`;if(!q)return`return ${F}`;return`const _res=${F}`+q+"return _res"},Y1=WY||N.mapResponseContext?`,${N.mapResponseContext}`:"";if(O||M.route)B+=`c.route=\`${X}\`
`;if(O||Q.afterResponse?.length)B+=`let afterHandlerStreamListener
`;let A1=h("parse",{total:Q.parse?.length});if(R){let j=!!Q.parse?.length||M.body||Z.body;if(N.parser.declare)B+=N.parser.declare;B+=`
try{`;let q=typeof Q.parse==="string"?Q.parse:Array.isArray(Q.parse)&&Q.parse.length===1?typeof Q.parse[0]==="string"?Q.parse[0]:typeof Q.parse[0].fn==="string"?Q.parse[0].fn:void 0:void 0;if(!q&&Z.body&&!Q.parse?.length){let F=Z.body.schema;if(F&&F.anyOf&&F[S]==="Union"&&F.anyOf?.length===2&&F.anyOf?.find((_)=>_[S]==="ElysiaForm"))q="formdata"}if(q&&dK.includes(q)){let F=h("parse",{total:Q.parse?.length}),_=!!Z.body?.isOptional;switch(q){case"json":case"application/json":B+=N.parser.json(_);break;case"text":case"text/plain":B+=N.parser.text(_);break;case"urlencoded":case"application/x-www-form-urlencoded":B+=N.parser.urlencoded(_);break;case"arrayBuffer":case"application/octet-stream":B+=N.parser.arrayBuffer(_);break;case"formdata":case"multipart/form-data":B+=N.parser.formData(_);break;default:if(q[0]in Y["~parser"])B+=g?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",B+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0,index)}
else{contentType=''}c.contentType=contentType
let result=parser['${q}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}F.resolve()}else if(j){B+=`
`,B+=`let contentType
if(c.request.body)`,B+=g?`contentType=c.headers['content-type']
`:`contentType=c.request.headers.get('content-type')
`;let F=!1;if(Q.parse?.length)B+=`if(contentType){
const index=contentType.indexOf(';')

if(index!==-1)contentType=contentType.substring(0,index)}else{contentType=''}let used=false
c.contentType=contentType
`;else{F=!0;let x=!!Z.body?.isOptional;B+=`if(contentType)switch(contentType.charCodeAt(12)){
case 106:`+N.parser.json(x)+`break
case 120:`+N.parser.urlencoded(x)+`break
case 111:`+N.parser.arrayBuffer(x)+`break
case 114:`+N.parser.formData(x)+`break
default:if(contentType.charCodeAt(0)===116){`+N.parser.text(x)+`}break
}`}let _=h("parse",{total:Q.parse?.length});if(Q.parse)for(let x=0;x<Q.parse.length;x++){let m=`bo${x}`;if(x!==0)B+=`
if(!used){`;if(typeof Q.parse[x].fn==="string"){let O0=_.resolveChild(Q.parse[x].fn),I0=!!Z.body?.isOptional;switch(Q.parse[x].fn){case"json":case"application/json":F=!0,B+=N.parser.json(I0);break;case"text":case"text/plain":F=!0,B+=N.parser.text(I0);break;case"urlencoded":case"application/x-www-form-urlencoded":F=!0,B+=N.parser.urlencoded(I0);break;case"arrayBuffer":case"application/octet-stream":F=!0,B+=N.parser.arrayBuffer(I0);break;case"formdata":case"multipart/form-data":F=!0,B+=N.parser.formData(I0);break;default:B+=`let ${m}=parser['${Q.parse[x].fn}'](c,contentType)
if(${m} instanceof Promise)${m}=await ${m}
if(${m}!==undefined){c.body=${m};used=true;}
`}O0()}else{let O0=_.resolveChild(Q.parse[x].fn.name);B+=`let ${m}=e.parse[${x}]
${m}=${m}(c,contentType)
if(${m} instanceof Promise)${m}=await ${m}
if(${m}!==undefined){c.body=${m};used=true}`,O0()}if(x!==0)B+="}";if(F)break}if(_.resolve(),!F){let x=!!Z.body?.isOptional;if(Q.parse?.length)B+=`
if(!used){
`;B+=`switch(contentType){case 'application/json':
`+N.parser.json(x)+`break
case 'text/plain':`+N.parser.text(x)+`break
case 'application/x-www-form-urlencoded':`+N.parser.urlencoded(x)+`break
case 'application/octet-stream':`+N.parser.arrayBuffer(x)+`break
case 'multipart/form-data':`+N.parser.formData(x)+`break
`;for(let m of Object.keys(Y["~parser"]))B+=`case '${m}':let bo${m}=parser['${m}'](c,contentType)
if(bo${m} instanceof Promise)bo${m}=await bo${m}
if(bo${m} instanceof ElysiaCustomStatusResponse){`+J0(`bo${m}`)+`}if(bo${m}!==undefined)c.body=bo${m}
break
`;if(Q.parse?.length)B+="}";B+="}"}if(Q.parse?.length)B+=`
delete c.contentType`}B+="}catch(error){throw new ParseError(error)}"}if(A1.resolve(),Q?.transform||O){let j=h("transform",{total:Q.transform?.length});if(Q.transform?.length){B+=`let transformed
`;for(let q=0;q<Q.transform.length;q++){let F=Q.transform[q],_=j.resolveChild(F.fn.name);if(B+=r0(F)?`transformed=await e.transform[${q}](c)
`:`transformed=e.transform[${q}](c)
`,F.subType==="mapDerive")B+="if(transformed instanceof ElysiaCustomStatusResponse){"+J0("transformed")+`}else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else B+="if(transformed instanceof ElysiaCustomStatusResponse){"+J0("transformed")+`}else Object.assign(c,transformed)
`;_()}}j.resolve()}let F1=[];if(Z){if(Z.headers){if(Z.headers.hasDefault)for(let[j,q]of Object.entries(F0.Default(Z.headers.schema,{}))){let F=typeof q==="object"?JSON.stringify(q):typeof q==="string"?`'${q}'`:q;if(F!==void 0)B+=`c.headers['${j}']??=${F}
`}if(B+=A$({name:"c.headers",schema:Z.headers,type:"headers",normalize:E}),Z.headers.isOptional)B+="if(isNotEmpty(c.headers)){";if(Z.headers?.provider==="standard")B+=`let vah=validator.headers.Check(c.headers)
if(vah instanceof Promise)vah=await vah
if(vah.issues){`+u.validate("headers",void 0,"vah.issues")+`}else{c.headers=vah.value}
`;else if(Z.headers?.schema?.noValidate!==!0)B+="if(validator.headers.Check(c.headers) === false){"+u.validate("headers")+"}";if(Z.headers.hasTransform)B+=D6(`c.headers=validator.headers.Decode(c.headers)
`,"headers",b);if(Z.headers.isOptional)B+="}"}if(Z.params){if(Z.params.hasDefault)for(let[j,q]of Object.entries(F0.Default(Z.params.schema,{}))){let F=typeof q==="object"?JSON.stringify(q):typeof q==="string"?`'${q}'`:q;if(F!==void 0)B+=`c.params['${j}']??=${F}
`}if(Z.params.provider==="standard")B+=`let vap=validator.params.Check(c.params)
if(vap instanceof Promise)vap=await vap
if(vap.issues){`+u.validate("params",void 0,"vap.issues")+`}else{c.params=vap.value}
`;else if(Z.params?.schema?.noValidate!==!0)B+="if(validator.params.Check(c.params)===false){"+u.validate("params")+"}";if(Z.params.hasTransform)B+=D6(`c.params=validator.params.Decode(c.params)
`,"params",b)}if(Z.query){if(S in Z.query?.schema&&Z.query.hasDefault)for(let[j,q]of Object.entries(F0.Default(Z.query.schema,{}))){let F=typeof q==="object"?JSON.stringify(q):typeof q==="string"?`'${q}'`:q;if(F!==void 0)B+=`if(c.query['${j}']===undefined)c.query['${j}']=${F}
`}if(B+=A$({name:"c.query",schema:Z.query,type:"query",normalize:E}),Z.query.isOptional)B+="if(isNotEmpty(c.query)){";if(Z.query.provider==="standard")B+=`let vaq=validator.query.Check(c.query)
if(vaq instanceof Promise)vaq=await vaq
if(vaq.issues){`+u.validate("query",void 0,"vaq.issues")+`}else{c.query=vaq.value}
`;else if(Z.query?.schema?.noValidate!==!0)B+="if(validator.query.Check(c.query)===false){"+u.validate("query")+"}";if(Z.query.hasTransform)B+=D6(`c.query=validator.query.Decode(c.query)
`,"query",b),B+=D6(`c.query=validator.query.Decode(c.query)
`,"query",b);if(Z.query.isOptional)B+="}"}if(R&&Z.body){if(Z.body.hasTransform||Z.body.isOptional)B+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&(isNotEmpty(c.body)||c.body instanceof ArrayBuffer))
`;let j=yK(Z.body.schema),q=!1;if(Z.body.hasDefault){let F=F0.Default(Z.body.schema,Z.body.schema.type==="object"||O6(Z.body.schema)[S]==="Object"?{}:void 0),_=O6(Z.body.schema);if(!j&&F&&typeof F==="object"&&(N8("File",_)||N8("Files",_))){q=!0;for(let[m,O0]of Object.entries(F))if(O0==="File"||O0==="Files")delete F[m];if(!d0(F))F=void 0}let x=typeof F==="object"?JSON.stringify(F):typeof F==="string"?`'${F}'`:F;if(F!==void 0&&F!==null)if(Array.isArray(F))B+=`if(!c.body)c.body=${x}
`;else if(typeof F==="object")B+=`c.body=Object.assign(${x},c.body)
`;else B+=`c.body=${x}
`;if(B+=A$({name:"c.body",schema:Z.body,type:"body",normalize:E}),Z.body.provider==="standard")B+=`let vab=validator.body.Check(c.body)
if(vab instanceof Promise)vab=await vab
if(vab.issues){`+u.validate("body",void 0,"vab.issues")+`}else{c.body=vab.value}
`;else if(Z.body?.schema?.noValidate!==!0)if(Z.body.isOptional)B+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+u.validate("body")+"}";else B+="if(validator.body.Check(c.body)===false){"+u.validate("body")+"}"}else if(B+=A$({name:"c.body",schema:Z.body,type:"body",normalize:E}),Z.body.provider==="standard")B+=`let vab=validator.body.Check(c.body)
if(vab instanceof Promise)vab=await vab
if(vab.issues){`+u.validate("body",void 0,"vab.issues")+`}else{c.body=vab.value}
`;else if(Z.body?.schema?.noValidate!==!0)if(Z.body.isOptional)B+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+u.validate("body")+"}";else B+="if(validator.body.Check(c.body)===false){"+u.validate("body")+"}";if(Z.body.hasTransform)B+=D6(`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`,"body",b);if(j&&Z.body.schema.anyOf?.length){let F=Object.values(Z.body.schema.anyOf);for(let _=0;_<F.length;_++){let x=F[_];if(N8("File",x)||N8("Files",x)){let m=w1(x,{modules:Y.definitions.typebox,dynamic:!Y.config.aot,models:Y.definitions.type,normalize:Y.config.normalize,additionalCoerce:Z4(),sanitize:()=>Y.config.sanitize});if(m){let O0=F1.length===0,I0=Object.entries(x.properties),C0=O0?`
`:" else ";C0+=`if(fileUnions[${F1.length}].Check(c.body)){`;let n0="",bY=0;for(let z8=0;z8<I0.length;z8++){let[l$,n$]=I0[z8];if(!n$.extension||n$[S]!=="File"&&n$[S]!=="Files")continue;if(bY)n0+=",";n0+=`fileType(c.body.${l$},${JSON.stringify(n$.extension)},'body.${l$}')`,bY++}if(n0){if(bY===1)C0+=`await ${n0}
`;else if(bY>1)C0+=`await Promise.all([${n0}])
`;C0+="}",B+=C0,F1.push(m)}}}}}else if(q||!j&&(N8("File",O6(Z.body.schema))||N8("Files",O6(Z.body.schema)))){let F="",_=0;for(let[x,m]of Object.entries(O6(Z.body.schema).properties)){if(!m.extension||m[S]!=="File"&&m[S]!=="Files")continue;if(_)F+=",";F+=`fileType(c.body.${x},${JSON.stringify(m.extension)},'body.${x}')`,_++}if(_)B+=`
`;if(_===1)B+=`await ${F}
`;else if(_>1)B+=`await Promise.all([${F}])
`}}if(Z.cookie){if(Z.cookie.config=rW(Z.cookie.config,Z.cookie?.config??{}),B+=`let cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,Z.cookie.isOptional)B+="if(isNotEmpty(c.cookie)){";if(Z.cookie.provider==="standard")B+=`let vac=validator.cookie.Check(cookieValue)
if(vac instanceof Promise)vac=await vac
if(vac.issues){`+u.validate("cookie",void 0,"vac.issues")+`}else{cookieValue=vac.value}
`,B+=`for(const k of Object.keys(cookieValue))c.cookie[k].value=cookieValue[k]
`;else if(Z.body?.schema?.noValidate!==!0){if(B+="if(validator.cookie.Check(cookieValue)===false){"+u.validate("cookie","cookieValue")+"}",Z.cookie.hasTransform)B+=D6("for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue))){c.cookie[key].value=value}","cookie",b)}if(Z.cookie.isOptional)B+="}"}}if(Q?.beforeHandle||O){let j=h("beforeHandle",{total:Q.beforeHandle?.length}),q=!1;if(Q.beforeHandle?.length)for(let F=0;F<Q.beforeHandle.length;F++){let _=Q.beforeHandle[F],x=j.resolveChild(_.fn.name),m=O$(_);if(_.subType==="resolve"||_.subType==="mapResolve"){if(!q)q=!0,B+=`
let resolved
`;if(B+=r0(_)?`resolved=await e.beforeHandle[${F}](c);
`:`resolved=e.beforeHandle[${F}](c);
`,_.subType==="mapResolve")B+="if(resolved instanceof ElysiaCustomStatusResponse){"+J0("resolved")+`}else{resolved.request=c.request
resolved.store=c.store
resolved.qi=c.qi
resolved.path=c.path
resolved.url=c.url
resolved.redirect=c.redirect
resolved.set=c.set
resolved.error=c.error
c=resolved}`;else B+="if(resolved instanceof ElysiaCustomStatusResponse){"+J0("resolved")+`}else Object.assign(c, resolved)
`;x()}else if(!m)B+=r0(_)?`await e.beforeHandle[${F}](c)
`:`e.beforeHandle[${F}](c)
`,x();else{if(B+=r0(_)?`be=await e.beforeHandle[${F}](c)
`:`be=e.beforeHandle[${F}](c)
`,x("be"),B+="if(be!==undefined){",j.resolve(),Q.afterHandle?.length||O){h("handle",{name:G?W.name:void 0}).resolve();let I0=h("afterHandle",{total:Q.afterHandle?.length});if(Q.afterHandle?.length)for(let C0=0;C0<Q.afterHandle.length;C0++){let n0=Q.afterHandle[C0],bY=O$(n0),z8=I0.resolveChild(n0.fn.name);if(B+=`c.response=c.responseValue=be
`,!bY)B+=r0(n0.fn)?`await e.afterHandle[${C0}](c, be)
`:`e.afterHandle[${C0}](c, be)
`;else B+=r0(n0.fn)?`af=await e.afterHandle[${C0}](c)
`:`af=e.afterHandle[${C0}](c)
`,B+=`if(af!==undefined) c.response=c.responseValue=be=af
`;z8("af")}I0.resolve()}if(Z.response)B+=u.response("be");let O0=h("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){B+=`c.response=c.responseValue=be
`;for(let I0=0;I0<Q.mapResponse.length;I0++){let C0=Q.mapResponse[I0],n0=O0.resolveChild(C0.fn.name);B+=`if(mr===undefined){mr=${A8(C0)?"await ":""}e.mapResponse[${I0}](c)
if(mr!==undefined)be=c.response=c.responseValue=mr}`,n0()}}O0.resolve(),B+=N1(),B+=v(),B+=`return mapEarlyResponse(${l}be,c.set${Y1})}
`}}j.resolve()}function OX(j){let q=h("handle",{name:j,alias:"reportHandler"});return()=>{if(O)B+='if(r&&(r[Symbol.iterator]||r[Symbol.asyncIterator])&&typeof r.next==="function"){'+(P1?"":"(async()=>{")+`const stream=await tee(r,3)
r=stream[0]
const listener=stream[1]
`+(O||Q.afterResponse?.length?`afterHandlerStreamListener=stream[2]
`:"")+`setImmediate(async ()=>{if(listener)for await(const v of listener){}
`,q.resolve(),B+="})"+(P1?"":"})()")+"}else{",q.resolve(),B+=`}
`}}if(Q.afterHandle?.length||O){let j=OX(G?W.name:void 0);if(Q.afterHandle?.length)B+=L0?`let r=c.response=c.responseValue=await ${A}
`:`let r=c.response=c.responseValue=${A}
`;else B+=L0?`let r=await ${A}
`:`let r=${A}
`;j();let q=h("afterHandle",{total:Q.afterHandle?.length});if(Q.afterHandle?.length)for(let _=0;_<Q.afterHandle.length;_++){let x=Q.afterHandle[_],m=O$(x),O0=q.resolveChild(x.fn.name);if(!m)B+=r0(x.fn)?`await e.afterHandle[${_}](c)
`:`e.afterHandle[${_}](c)
`,O0();else if(B+=r0(x.fn)?`af=await e.afterHandle[${_}](c)
`:`af=e.afterHandle[${_}](c)
`,O0("af"),Z.response)B+="if(af!==undefined){",q.resolve(),B+=u.response("af"),B+="c.response=c.responseValue=af}";else B+="if(af!==undefined){",q.resolve(),B+="c.response=c.responseValue=af}"}if(q.resolve(),Q.afterHandle?.length)B+=`r=c.response
`;if(Z.response)B+=u.response();B+=v();let F=h("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length)for(let _=0;_<Q.mapResponse.length;_++){let x=Q.mapResponse[_],m=F.resolveChild(x.fn.name);B+=`mr=${A8(x)?"await ":""}e.mapResponse[${_}](c)
if(mr!==undefined)r=c.response=c.responseValue=mr
`,m()}F.resolve(),B+=J0()}else{let j=OX(G?W.name:void 0);if(Z.response||Q.mapResponse?.length||O){if(B+=L0?`let r=await ${A}
`:`let r=${A}
`,j(),Z.response)B+=u.response();let q=h("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){B+=`
c.response=c.responseValue=r
`;for(let F=0;F<Q.mapResponse.length;F++){let _=Q.mapResponse[F],x=q.resolveChild(_.fn.name);B+=`
if(mr===undefined){mr=${A8(_)?"await ":""}e.mapResponse[${F}](c)
if(mr!==undefined)r=c.response=c.responseValue=mr}
`,x()}}if(q.resolve(),B+=v(),W instanceof Response)B+=N1(),B+=M.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${l}${A}.clone(),c.set${Y1})
else return ${A}.clone()`:`return ${A}.clone()`,B+=`
`;else B+=J0()}else if(c||O){B+=L0?`let r=await ${A}
`:`let r=${A}
`,j();let q=h("mapResponse",{total:Q.mapResponse?.length});if(Q.mapResponse?.length){B+=`c.response=c.responseValue= r
`;for(let F=0;F<Q.mapResponse.length;F++){let _=Q.mapResponse[F],x=q.resolveChild(_.fn.name);B+=`if(mr===undefined){mr=${A8(_)?"await ":""}e.mapResponse[${F}](c)
if(mr!==undefined)r=c.response=c.responseValue=mr}`,x()}}q.resolve(),B+=v()+J0()}else{j();let q=L0?`await ${A}`:A;if(W instanceof Response)B+=N1(),B+=M.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${l}${A}.clone(),c.set${Y1})
else return ${A}.clone()
`:`return ${A}.clone()
`;else B+=J0(q)}}if(B+=`
}catch(error){`,!P1&&Q.error?.length)B+="return(async()=>{";if(B+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,c)B+=v();if(O&&Q.trace)for(let j=0;j<Q.trace.length;j++)B+=`report${j}?.resolve(error);reportChild${j}?.(error)
`;let DX=h("error",{total:Q.error?.length});if(Q.error?.length){if(B+=`c.error=error
`,z)B+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else B+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;if(B+=`let er
`,Q.mapResponse?.length)B+=`let mep
`;for(let j=0;j<Q.error.length;j++){let q=DX.resolveChild(Q.error[j].fn.name);if(r0(Q.error[j]))B+=`er=await e.error[${j}](c)
`;else B+=`er=e.error[${j}](c)
if(er instanceof Promise)er=await er
`;if(q(),Q.mapResponse?.length){let F=h("mapResponse",{total:Q.mapResponse?.length});for(let _=0;_<Q.mapResponse.length;_++){let x=Q.mapResponse[_],m=F.resolveChild(x.fn.name);B+=`c.response=c.responseValue=er
mep=e.mapResponse[${_}](c)
if(mep instanceof Promise)er=await er
if(mep!==undefined)er=mep
`,m()}F.resolve()}if(B+=`er=mapEarlyResponse(er,set${Y1})
`,B+="if(er){",O&&Q.trace){for(let F=0;F<Q.trace.length;F++)B+=`report${F}.resolve()
`;DX.resolve()}B+="return er}"}}if(DX.resolve(),B+="return handleError(c,error,true)",!P1&&Q.error?.length)B+="})()";B+="}";let V6=N.inject?Object.keys(N.inject).join(",")+",":"",L="const {handler,handleError,hooks:e, "+s0("validator,",z)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+s0("parseQuery,",R)+s0("parseQueryFromURL,",H)+"},error:{"+s0("ValidationError,",z)+s0("ParseError",R)+"},fileType,schema,definitions,tee,ERROR_CODE,"+s0("parseCookie,",c)+s0("signCookie,",c)+s0("decodeURIComponent,",H)+"ElysiaCustomStatusResponse,"+s0("ELYSIA_TRACE,",O)+s0("ELYSIA_REQUEST_ID,",O)+s0("parser,",Q.parse?.length)+s0("getServer,",M.server)+s0("fileUnions,",F1.length)+V6+s0("TypeBoxError",z)+`}=hooks
const trace=e.trace
return ${P1?"async ":""}function handle(c){`;if(Q.beforeHandle?.length)L+=`let be
`;if(Q.afterHandle?.length)L+=`let af
`;if(Q.mapResponse?.length)L+=`let mr
`;if(J)L+=`c.schema=schema
c.defs=definitions
`;B=L+B+"}",L="";try{return Function("hooks",`"use strict";
`+B)({handler:W,hooks:UN(Q),validator:z?Z:void 0,handleError:Y.handleError,mapResponse:U.mapResponse,mapCompactResponse:U.mapCompactResponse,mapEarlyResponse:U.mapEarlyResponse,isNotEmpty:d0,utils:{parseQuery:R?L6:void 0,parseQueryFromURL:H?Z.query?.provider==="standard"?IK:oN:void 0},error:{ValidationError:z?D0:void 0,ParseError:R?gN:void 0},fileType:kN,schema:Y.router.history,definitions:Y.definitions.type,tee:DK,ERROR_CODE:sQ,parseCookie:c?mN:void 0,signCookie:c?rQ:void 0,decodeURIComponent:H?VK.default:void 0,ElysiaCustomStatusResponse:V1,ELYSIA_TRACE:O?NZ:void 0,ELYSIA_REQUEST_ID:O?P$:void 0,getServer:M.server?()=>Y.getServer():void 0,fileUnions:F1.length?F1:void 0,TypeBoxError:z?n:void 0,parser:Y["~parser"],...N.inject})}catch(j){let q=UN(Q);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof W==="function"?W.toString():W,instruction:B,hooks:{...q,transform:q?.transform?.map?.((F)=>F.toString()),resolve:q?.resolve?.map?.((F)=>F.toString()),beforeHandle:q?.beforeHandle?.map?.((F)=>F.toString()),afterHandle:q?.afterHandle?.map?.((F)=>F.toString()),mapResponse:q?.mapResponse?.map?.((F)=>F.toString()),parse:q?.parse?.map?.((F)=>F.toString()),error:q?.error?.map?.((F)=>F.toString()),afterResponse:q?.afterResponse?.map?.((F)=>F.toString()),stop:q?.stop?.map?.((F)=>F.toString())},validator:Z,definitions:Y.definitions.type,error:j}),console.log("---"),process.exit(1)}},aN=(Y,X)=>{let $="",Q=K$({trace:Y.event.trace,addFn:X??((Z)=>{$+=Z})})("request",{total:Y.event.request?.length});if(Y.event.request?.length){$+="try{";for(let Z=0;Z<Y.event.request.length;Z++){let W=Y.event.request[Z],J=O$(W),M=r0(W),N=Q.resolveChild(Y.event.request[Z].fn.name);if(J)$+=`re=mapEarlyResponse(${M?"await ":""}onRequest[${Z}](c),c.set)
`,N("re"),$+=`if(re!==undefined)return re
`;else $+=`${M?"await ":""}onRequest[${Z}](c)
`,N()}$+="}catch(error){return app.handleError(c,error,false)}"}return Q.resolve(),$},eN=(Y,X="map")=>{let $=Y.extender.higherOrderFunctions;if(!$.length)return"return "+X;let Q=Y["~adapter"].composeGeneralHandler,Z=X;for(let W=0;W<$.length;W++)Z=`hoc[${W}](${Z},${Q.parameters})`;return`return function hocMap(${Q.parameters}){return ${Z}(${Q.parameters})}`},iW=(Y)=>{let X=Y["~adapter"].composeGeneralHandler;Y.router.http.build();let $=Y["~adapter"].isWebStandard,Q=Y.event.trace?.length,Z="",W=Y.router,J=W.http.root.WS?"const route=router.find(r.method==='GET'&&r.headers.get('upgrade')==='websocket'?'WS':r.method,p)":"const route=router.find(r.method,p)";if(J+=W.http.root.ALL?`??router.find('ALL',p)
`:`
`,$)J+=`if(r.method==='HEAD'){const route=router.find('GET',p)
if(route){c.params=route.params
const _res=route.store.handler?route.store.handler(c):route.store.compile()(c)
if(_res)return getResponseLength(_res).then((length)=>{_res.headers.set('content-length', length)
return new Response(null,{status:_res.status,statusText:_res.statusText,headers:_res.headers})
})}}`;let M=`c.error=notFound
`;if(Y.event.afterResponse?.length&&!Y.event.error){M=`
c.error=notFound
`;let z=Y.event.afterResponse.some(r0)?"async":"";M+=`
setImmediate(${z}()=>{if(c.responseValue instanceof ElysiaCustomStatusResponse) c.set.status=c.responseValue.code
`;for(let H=0;H<Y.event.afterResponse.length;H++){let P=Y.event.afterResponse[H].fn;M+=`
${A8(P)?"await ":""}afterResponse[${H}](c)
`}M+=`})
`}if(Y.inference.query)M+=`
if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url,c.qi+1)}`;let N=X.error404(!!Y.event.request?.length,!!Y.event.error?.length,M);J+=N.code,J+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return route.store.compile()(c)
`;let U="";for(let[z,H]of Object.entries(W.static)){if(U+=`case'${z}':`,Y.config.strictPath!==!0)U+=`case'${G$(z)}':`;let P=U$(z);if(z!==P)U+=`case'${P}':`;if(U+="switch(r.method){","GET"in H||"WS"in H){if(U+="case 'GET':","WS"in H){if(U+=`if(r.headers.get('upgrade')==='websocket')return ht[${H.WS}].composed(c)
`,"GET"in H===!1)if("ALL"in H)U+=`return ht[${H.ALL}].composed(c)
`;else U+=`break map
`}if("GET"in H)U+=`return ht[${H.GET}].composed(c)
`}if($&&(("GET"in H)||("ALL"in H))&&"HEAD"in H===!1)U+=`case 'HEAD':const _res=ht[${H.GET??H.ALL}].composed(c)
return getResponseLength(_res).then((length)=>{_res.headers.set('content-length', length)
return new Response(null,{status:_res.status,statusText:_res.statusText,headers:_res.headers})
})
`;for(let[R,D]of Object.entries(H)){if(R==="ALL"||R==="GET"||R==="WS")continue;U+=`case '${R}':return ht[${D}].composed(c)
`}if("ALL"in H)U+=`default:return ht[${H.ALL}].composed(c)
`;else U+=`default:break map
`;U+="}"}let G=!!Y.event.request?.some(r0),A=X.inject?Object.keys(X.inject).join(",")+",":"";if(Z+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,status,redirect,getResponseLength,ElysiaCustomStatusResponse,`+s0("parseQueryFromURL,",Y.inference.query)+s0("ELYSIA_TRACE,",Q)+s0("ELYSIA_REQUEST_ID,",Q)+A+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,Y.event.request?.length)Z+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(Y.event.afterResponse?.length)Z+=`const afterResponse=app.event.afterResponse.map(x=>x.fn)
`;if(Z+=N.declare,Y.event.trace?.length)Z+="const "+Y.event.trace.map((z,H)=>`tr${H}=app.event.trace[${H}].fn`).join(",")+`
`;if(Z+=`${G?"async ":""}function map(${X.parameters}){`,Y.event.request?.length)Z+=`let re
`;if(Z+=X.createContext(Y),Y.event.trace?.length)Z+="c[ELYSIA_TRACE]=["+Y.event.trace.map((z,H)=>`tr${H}(c)`).join(",")+`]
`;if(Z+=aN(Y),U)Z+=`
map: switch(p){
`+U+"}";Z+=J+`}
`+eN(Y);let O=Y9(Y);Y.handleError=O;let B=Function("data",`"use strict";
`+Z)({app:Y,mapEarlyResponse:Y["~adapter"].handler.mapEarlyResponse,NotFoundError:J4,randomId:MZ,handleError:O,status:m0,redirect:JZ,getResponseLength:iL,ElysiaCustomStatusResponse:V1,parseQueryFromURL:Y.inference.query?oN:void 0,ELYSIA_TRACE:Q?NZ:void 0,ELYSIA_REQUEST_ID:Q?P$:void 0,...X.inject});if(P6)Bun.gc(!1);return B},Y9=(Y)=>{let X=Y.event,$="",Q=Y["~adapter"].composeError,Z=Q.inject?Object.keys(Q.inject).join(",")+",":"",W=!!Y.event.trace?.length;if($+="const {mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+s0("onError,",Y.event.error)+s0("afterResponse,",Y.event.afterResponse)+s0("trace,",Y.event.trace)+s0("onMapResponse,",Y.event.mapResponse)+s0("ELYSIA_TRACE,",W)+s0("ELYSIA_REQUEST_ID,",W)+Z+`}=inject
`,$+=`return ${Y.event.error?.find(r0)||Y.event.mapResponse?.find(r0)?"async ":""}function(context,error,skipGlobal){`,$+="",W)$+=`const id=context[ELYSIA_REQUEST_ID]
`;let J=K$({context:"context",trace:X.trace,addFn:(A)=>{$+=A}}),M=()=>{if(!X.afterResponse?.length&&!W)return"";let A="",O=X.afterResponse?.some(r0)?"async":"";A+=`
setImmediate(${O}()=>{`;let B=K$({context:"context",trace:X.trace,addFn:(z)=>{A+=z}})("afterResponse",{total:X.afterResponse?.length,name:"context"});if(X.afterResponse?.length&&X.afterResponse)for(let z=0;z<X.afterResponse.length;z++){let H=X.afterResponse[z].fn,P=B.resolveChild(H.name);A+=`
${A8(H)?"await ":""}afterResponse[${z}](context)
`,P()}return B.resolve(),A+=`})
`,A};if($+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,Q.declare)$+=Q.declare;let N=W||!!X.afterResponse?.length?"context.response = ":"";if(Y.event.error)for(let A=0;A<Y.event.error.length;A++){let O=Y.event.error[A],B=`${r0(O)?"await ":""}onError[${A}](context)
`;if($+="if(skipGlobal!==true){",O$(O)){$+=`_r=${B}
if(_r!==undefined){if(_r instanceof Response){`+M()+`return mapResponse(_r,set${Q.mapResponseContext})}if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let z=J("mapResponse",{total:X.mapResponse?.length,name:"context"});if(X.mapResponse?.length)for(let H=0;H<X.mapResponse.length;H++){let P=X.mapResponse[H],R=z.resolveChild(P.fn.name);$+=`context.response=context.responseValue=_r_r=${A8(P)?"await ":""}onMapResponse[${H}](context)
`,R()}z.resolve(),$+=M()+`return mapResponse(${N}_r,set${Q.mapResponseContext})}`}else $+=B;$+="}"}$+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){
if(error.error)error=error.error
set.status=error.status??422
`+M()+Q.validationError+`
}
`,$+="if(error instanceof Error){"+M()+`
if(typeof error.toResponse==='function')return context.response=context.responseValue=error.toResponse()
`+Q.unknownError+`
}`;let U=J("mapResponse",{total:X.mapResponse?.length,name:"context"});if($+=`
if(!context.response)context.response=context.responseValue=error.message??error
`,X.mapResponse?.length){$+=`let mr
`;for(let A=0;A<X.mapResponse.length;A++){let O=X.mapResponse[A],B=U.resolveChild(O.fn.name);$+=`if(mr===undefined){mr=${A8(O)?"await ":""}onMapResponse[${A}](context)
if(mr!==undefined)error=context.response=context.responseValue=mr}`,B()}}U.resolve(),$+=M()+`
return mapResponse(${N}error,set${Q.mapResponseContext})}`;let G=(A)=>typeof A==="function"?A:A.fn;return Function("inject",`"use strict";
`+$)({mapResponse:Y["~adapter"].handler.mapResponse,ERROR_CODE:sQ,ElysiaCustomStatusResponse:V1,onError:Y.event.error?.map(G),afterResponse:Y.event.afterResponse?.map(G),trace:Y.event.trace?.map(G),onMapResponse:Y.event.mapResponse?.map(G),ELYSIA_TRACE:W?NZ:void 0,ELYSIA_REQUEST_ID:W?P$:void 0,...Q.inject})},vX=(Y,X)=>X?Y:"",RN=(Y,X,$,Q=!1)=>{let Z="",W=Y.setHeaders,J=!!Y.event.trace?.length;if(J)Z+=`const id=randomId()
`;let M=/[:*]/.test(X.path),N=`const u=request.url,s=u.indexOf('/',${Y.config.handler?.standardHostname??!0?11:7}),qi=u.indexOf('?', s + 1)
`,U=$.query||!!X.hooks.query||!!X.hooks.standaloneValidator?.find((A)=>A.query)||Y.event.request?.length;if(U)Z+=N;let G=!$.path?"":!M?`path:'${X.path}',`:"get path(){"+(U?"":N)+`if(qi===-1)return u.substring(s)
return u.substring(s,qi)
},`;if(Z+=vX("const c=",!Q)+"{request,store,"+vX("qi,",U)+vX("params:request.params,",M)+G+vX("url:request.url,",J||$.url||U)+"redirect,status,set:{headers:"+(d0(W)?"Object.assign({},app.setHeaders)":"Object.create(null)")+",status:200}",$.server)Z+=",get server(){return app.getServer()}";if(J)Z+=",[ELYSIA_REQUEST_ID]:id";{let A="";for(let O of Object.keys(Y.singleton.decorator))A+=`,'${O}':decorator['${O}']`;Z+=A}return Z+=`}
`,Z},lW=(Y,X)=>{let $=!!Y.event.trace?.length,Q=!!Y.extender.higherOrderFunctions.length,Z=$Z(X.hooks,Y.inference);Z=$Z({handler:X.handler},Z);let W="const handler=data.handler,app=data.app,store=data.store,decorator=data.decorator,redirect=data.redirect,route=data.route,mapEarlyResponse=data.mapEarlyResponse,"+vX("randomId=data.randomId,",$)+vX("ELYSIA_REQUEST_ID=data.ELYSIA_REQUEST_ID,",$)+vX("ELYSIA_TRACE=data.ELYSIA_TRACE,",$)+vX("trace=data.trace,",$)+vX("hoc=data.hoc,",Q)+`status=data.status
`;if(Y.event.request?.length)W+=`const onRequest=app.event.request.map(x=>x.fn)
`;W+=`${Y.event.request?.find(r0)?"async":""} function map(request){`;let J=Z.query||!!X.hooks.query||!!X.hooks.standaloneValidator?.find((M)=>M.query);if($||J||Y.event.request?.length)W+=RN(Y,X,Z),W+=aN(Y),W+="return handler(c)}";else W+=`return handler(${RN(Y,X,Z,!0)})}`;return W+=eN(Y),Function("data",W)({app:Y,handler:X.compile?.()??X.composed,redirect:JZ,status:m0,hoc:Y.extender.higherOrderFunctions.map((M)=>M.fn),store:Y.store,decorator:Y.decorator,route:X.path,randomId:$?MZ:void 0,ELYSIA_TRACE:$?NZ:void 0,ELYSIA_REQUEST_ID:$?P$:void 0,trace:$?Y.event.trace?.map((M)=>M?.fn??M):void 0,mapEarlyResponse:c1})},iK=(Y,X,$)=>{if(typeof Y==="function"||Y instanceof Blob)return;if(W4(Y))return()=>Y;let Q=p1(Y,$??{headers:{}});if(!X.parse?.length&&!X.transform?.length&&!X.beforeHandle?.length&&!X.afterHandle?.length){if(Q instanceof Promise)return Q.then((Z)=>{if(!Z)return;if(!Z.headers.has("content-type"))Z.headers.append("content-type","text/plain");return Z.clone()});if(!Q.headers.has("content-type"))Q.headers.append("content-type","text/plain");return()=>Q.clone()}},jN={open(Y){Y.data.open?.(Y)},message(Y,X){Y.data.message?.(Y,X)},drain(Y){Y.data.drain?.(Y)},close(Y,X,$){Y.data.close?.(Y,X,$)}};class H${raw;data;body;constructor(Y,X,$=void 0){this.raw=Y,this.data=X,this.body=$,this.validator=Y.data?.validator,this.sendText=Y.sendText.bind(Y),this.sendBinary=Y.sendBinary.bind(Y),this.close=Y.close.bind(Y),this.terminate=Y.terminate.bind(Y),this.publishText=Y.publishText.bind(Y),this.publishBinary=Y.publishBinary.bind(Y),this.subscribe=Y.subscribe.bind(Y),this.unsubscribe=Y.unsubscribe.bind(Y),this.isSubscribed=Y.isSubscribed.bind(Y),this.cork=Y.cork.bind(Y),this.remoteAddress=Y.remoteAddress,this.binaryType=Y.binaryType,this.data=Y.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send(Y,X){if(Buffer.isBuffer(Y))return this.raw.send(Y,X);if(this.validator?.Check(Y)===!1)return this.raw.send(new D0("message",this.validator,Y).message);if(typeof Y==="object")Y=JSON.stringify(Y);return this.raw.send(Y,X)}ping(Y){if(Buffer.isBuffer(Y))return this.raw.ping(Y);if(this.validator?.Check(Y)===!1)return this.raw.send(new D0("message",this.validator,Y).message);if(typeof Y==="object")Y=JSON.stringify(Y);return this.raw.ping(Y)}pong(Y){if(Buffer.isBuffer(Y))return this.raw.pong(Y);if(this.validator?.Check(Y)===!1)return this.raw.send(new D0("message",this.validator,Y).message);if(typeof Y==="object")Y=JSON.stringify(Y);return this.raw.pong(Y)}publish(Y,X,$){if(Buffer.isBuffer(X))return this.raw.publish(Y,X,$);if(this.validator?.Check(X)===!1)return this.raw.send(new D0("message",this.validator,X).message);if(typeof X==="object")X=JSON.stringify(X);return this.raw.publish(Y,X,$)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}validator;["~types"];get id(){return this.data.id}}var lK=(Y)=>{let X=typeof Y==="function"?[Y]:Y;return async function($,Q){if(typeof Q==="string"){let Z=Q?.charCodeAt(0);if(Z===34||Z===47||Z===91||Z===123)try{Q=JSON.parse(Q)}catch{}else if(TN(Q))Q=+Q;else if(Q==="true")Q=!0;else if(Q==="false")Q=!1;else if(Q==="null")Q=null}if(X)for(let Z=0;Z<X.length;Z++){let W=X[Z]($,Q);if(W instanceof Promise)W=await W;if(W!==void 0)return W}return Q}},nK=(Y)=>{let X=($,Q)=>{if(Q instanceof Promise)return Q.then((J)=>X($,J));if(Buffer.isBuffer(Q))return $.send(Q.toString());if(Q===void 0)return;let Z=(J)=>{if(Y?.Check(J)===!1)return $.send(new D0("message",Y,J).message);if(typeof J==="object")return $.send(JSON.stringify(J));$.send(J)};if(typeof Q?.next!=="function")return void Z(Q);let W=Q.next();if(W instanceof Promise)return(async()=>{let J=await W;if(Y?.Check(J)===!1)return $.send(new D0("message",Y,J).message);if(Z(J.value),!J.done)for await(let M of Q)Z(M)})();if(Z(W.value),!W.done)for(let J of Q)Z(J)};return X},oK=/:.+?\?(?=\/|$)/,X9=(Y)=>{let X=oK.exec(Y);if(!X)return[Y];let $=[],Q=Y.slice(0,X.index),Z=X[0].slice(0,-1),W=Y.slice(X.index+X[0].length);$.push(Q.slice(0,-1)),$.push(Q+Z);for(let J of X9(W)){if(!J)continue;if(!J.startsWith("/:"))$.push(Q.slice(0,-1)+J);$.push(Q+Z+J)}return $},W4=(Y)=>{return typeof Y==="object"&&Y!==null&&(Y.toString()==="[object HTMLBundle]"||typeof Y.index==="string")},$9={GET:!0,HEAD:!0,OPTIONS:!0,DELETE:!0,PATCH:!0,POST:!0,PUT:!0},nW=(Y)=>{if(!Y.config.aot||!Y.config.systemRouter)return;let X={},$=(Z,W)=>{let J=encodeURI(Z.path);if(X[J]){if(!X[J][Z.method])X[J][Z.method]=W}else X[J]={[Z.method]:W}},Q=Y.routeTree;for(let Z of Y.router.history){if(typeof Z.handler!=="function")continue;let W=Z.method;if(W==="GET"&&`WS_${Z.path}`in Q||W==="WS"||Z.path.charCodeAt(Z.path.length-1)===42||!(W in $9))continue;if(W==="ALL"){if(!(`WS_${Z.path}`in Q))X[Z.path]=Z.hooks?.config?.mount?Z.hooks.trace||Y.event.trace||Y.extender.higherOrderFunctions?lW(Y,Z):Z.hooks.mount||Z.handler:Z.handler;continue}let J,M=Y.config.precompile?lW(Y,Z):(N)=>{if(J)return J(N);return(J=lW(Y,Z))(N)};for(let N of X9(Z.path))$({method:W,path:N},M)}return X},w6=(Y,X)=>{if(!X)return Y;for(let $ of Object.keys(X)){if(Y[$]===X[$])continue;if(!Y[$]){Y[$]=X[$];continue}if(Y[$]&&X[$]){if(typeof Y[$]==="function"||Y[$]instanceof Response){Y[$]=X[$];continue}Y[$]={...Y[$],...X[$]}}}return Y},tK={...S6,name:"bun",handler:{mapResponse:p1,mapEarlyResponse:c1,mapCompactResponse:dX,createStaticHandler:EK,createNativeStaticHandler:iK},composeHandler:{...S6.composeHandler,headers:tW?`c.headers=c.request.headers.toJSON()
`:`c.headers={}
for(const [k,v] of c.request.headers.entries())c.headers[k]=v
`},listen(Y){return(X,$)=>{if(typeof Bun>"u")throw Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(Y.compile(),typeof X==="string"){if(!TN(X))throw Error("Port must be a numeric value");X=parseInt(X)}let Q=(W,{withAsync:J=!1}={})=>{let M={},N=[];for(let[U,G]of Object.entries(W))if(U=encodeURI(U),bN){if(!G)continue;for(let[A,O]of Object.entries(G)){if(!O||!(A in $9))continue;if(O instanceof Promise){if(J){if(!M[U])M[U]={};N.push(O.then((B)=>{if(B instanceof Response)M[U][A]=B;if(W4(B))M[U][A]=B}))}continue}if(!(O instanceof Response)&&!W4(O))continue;if(!M[U])M[U]={};M[U][A]=O}}else{if(!G)continue;if(G instanceof Promise){if(J){if(!M[U])M[U]={};N.push(G.then((A)=>{if(A instanceof Response)M[U]=A}))}continue}if(!(G instanceof Response))continue;M[U]=G}if(J)return Promise.all(N).then(()=>M);return M},Z=typeof X==="object"?{development:!G8,reusePort:!0,idleTimeout:30,...Y.config.serve||{},...X||{},routes:w6(w6(Q(Y.router.response),nW(Y)),Y.config.serve?.routes),websocket:{...Y.config.websocket||{},...jN||{},...X.websocket||{}},fetch:Y.fetch}:{development:!G8,reusePort:!0,idleTimeout:30,...Y.config.serve||{},routes:w6(w6(Q(Y.router.response),nW(Y)),Y.config.serve?.routes),websocket:{...Y.config.websocket||{},...jN||{}},port:X,fetch:Y.fetch};if(Y.server=Bun.serve(Z),Y.event.start)for(let W=0;W<Y.event.start.length;W++)Y.event.start[W].fn(Y);if($)$(Y.server);process.on("beforeExit",async()=>{if(Y.server){if(await Y.server.stop?.(),Y.server=null,Y.event.stop)for(let W=0;W<Y.event.stop.length;W++)Y.event.stop[W].fn(Y)}}),Y.promisedModules.then(async()=>{Y.server?.reload({...Z,fetch:Y.fetch,routes:w6(w6(await Q(Y.router.response,{withAsync:!0}),nW(Y)),Y.config.serve?.routes)}),Bun?.gc(!1)})}},async stop(Y,X){if(Y.server){if(await Y.server.stop(X),Y.server=null,Y.event.stop?.length)for(let $=0;$<Y.event.stop.length;$++)Y.event.stop[$].fn(Y)}else console.log("Elysia isn't running. Call `app.listen` to start the server.",Error().stack)},ws(Y,X,$){let{parse:Q,body:Z,response:W,...J}=$,M=w1(Z,{modules:Y.definitions.typebox,models:Y.definitions.type,normalize:Y.config.normalize}),N=w1(W,{modules:Y.definitions.typebox,models:Y.definitions.type,normalize:Y.config.normalize});Y.route("WS",X,async(U)=>{let G=U.server??Y.server,{set:A,path:O,qi:B,headers:z,query:H,params:P}=U;if(U.validator=N,$.upgrade){if(typeof $.upgrade==="function"){let y=$.upgrade(U);if(y instanceof Promise)await y}else if($.upgrade)Object.assign(A.headers,$.upgrade)}if(A.cookie&&d0(A.cookie)){let y=uN(A.cookie);if(y)A.headers["set-cookie"]=y}if(A.headers["set-cookie"]&&Array.isArray(A.headers["set-cookie"]))A.headers=cN(new Headers(A.headers),A.headers["set-cookie"]);let R=nK(N),D=lK(Q),C;if(typeof $.beforeHandle==="function"){let y=$.beforeHandle(U);if(y instanceof Promise)await y}let g=[...$.error?Array.isArray($.error)?$.error:[$.error]:[],...(Y.event.error??[]).map((y)=>typeof y==="function"?y:y.fn)].filter((y)=>y),c=g.length>0,f=!c?()=>{}:async(y,v)=>{for(let E of g){let k=E(Object.assign(U,{error:v}));if(k instanceof Promise)k=await k;if(await R(y,k),k)break}};if(G?.upgrade(U.request,{headers:d0(A.headers)?A.headers:void 0,data:{...U,get id(){if(C)return C;return C=MZ()},validator:N,ping(y,v){$.ping?.(y,v)},pong(y,v){$.pong?.(y,v)},open:async(y)=>{try{await R(y,$.open?.(new H$(y,U)))}catch(v){f(y,v)}},message:async(y,v)=>{let E=await D(y,v);if(M?.Check(E)===!1){let k=new D0("message",M,E);if(!c)return void y.send(k.message);return f(y,k)}try{await R(y,$.message?.(new H$(y,U,E),E))}catch(k){f(y,k)}},drain:async(y)=>{try{await R(y,$.drain?.(new H$(y,U)))}catch(v){f(y,v)}},close:async(y,v,E)=>{try{await R(y,$.close?.(new H$(y,U),v,E))}catch(k){f(y,k)}}}}))return;return A.status=400,"Expected a websocket connection"},{...J,websocket:$})}},oW=(Y,X)=>{let $=Y.schema;if(!$)return;if($.$defs?.[$.$ref])$=$.$defs[$.$ref];if(!$?.properties)return;for(let[Q,Z]of Object.entries($.properties))X[Q]??=Z.default},_N=(Y)=>{let{mapResponse:X,mapEarlyResponse:$}=Y["~adapter"].handler,Q=Y.setHeaders;return async(Z)=>{let W=Z.url,J=W.indexOf("/",11),M=W.indexOf("?",J+1),N=M===-1?W.substring(J):W.substring(J,M),U={cookie:{},status:200,headers:Q?{...Q}:{}},G=Object.assign({},Y.singleton.decorator,{set:U,store:Y.singleton.store,request:Z,path:N,qi:M,error:m0,status:m0,redirect:JZ});try{if(Y.event.request)for(let E=0;E<Y.event.request.length;E++){let k=Y.event.request[E].fn,b=k(G);if(b instanceof Promise)b=await b;if(b=$(b,U),b)return G.response=b}let A=Z.method==="GET"&&Z.headers.get("upgrade")?.toLowerCase()==="websocket"?"WS":Z.method,O=Y.router.dynamic.find(Z.method,N)??Y.router.dynamic.find(A,N)??Y.router.dynamic.find("ALL",N);if(!O)throw G.query=M===-1?{}:L6(W.substring(M+1)),new J4;let{handle:B,hooks:z,validator:H,content:P,route:R}=O.store,D;if(Z.method!=="GET"&&Z.method!=="HEAD")if(P)switch(P){case"application/json":D=await Z.json();break;case"text/plain":D=await Z.text();break;case"application/x-www-form-urlencoded":D=L6(await Z.text());break;case"application/octet-stream":D=await Z.arrayBuffer();break;case"multipart/form-data":D={};let E=await Z.formData();for(let k of E.keys()){if(D[k])continue;let b=E.getAll(k);if(b.length===1)D[k]=b[0];else D[k]=b}break}else{let E;if(Z.body)E=Z.headers.get("content-type");if(E){let k=E.indexOf(";");if(k!==-1)E=E.slice(0,k);if(G.contentType=E,z.parse)for(let b=0;b<z.parse.length;b++){let u=z.parse[b].fn;if(typeof u==="string")switch(u){case"json":case"application/json":D=await Z.json();break;case"text":case"text/plain":D=await Z.text();break;case"urlencoded":case"application/x-www-form-urlencoded":D=L6(await Z.text());break;case"arrayBuffer":case"application/octet-stream":D=await Z.arrayBuffer();break;case"formdata":case"multipart/form-data":D={};let h=await Z.formData();for(let l of h.keys()){if(D[l])continue;let $1=h.getAll(l);if($1.length===1)D[l]=$1[0];else D[l]=$1}break;default:let L0=Y["~parser"][u];if(L0){let l=L0(G,E);if(l instanceof Promise)l=await l;if(l){D=l;break}}break}else{let h=u(G,E);if(h instanceof Promise)h=await h;if(h){D=h;break}}}if(delete G.contentType,D===void 0)switch(E){case"application/json":D=await Z.json();break;case"text/plain":D=await Z.text();break;case"application/x-www-form-urlencoded":D=L6(await Z.text());break;case"application/octet-stream":D=await Z.arrayBuffer();break;case"multipart/form-data":D={};let b=await Z.formData();for(let u of b.keys()){if(D[u])continue;let h=b.getAll(u);if(h.length===1)D[u]=h[0];else D[u]=h}break}}}G.route=R,G.body=D,G.params=O?.params||void 0,G.query=M===-1?{}:L6(W.substring(M+1)),G.headers={};for(let[E,k]of Z.headers.entries())G.headers[E]=k;let C={domain:Y.config.cookie?.domain??H?.cookie?.config.domain,expires:Y.config.cookie?.expires??H?.cookie?.config.expires,httpOnly:Y.config.cookie?.httpOnly??H?.cookie?.config.httpOnly,maxAge:Y.config.cookie?.maxAge??H?.cookie?.config.maxAge,path:Y.config.cookie?.path??H?.cookie?.config.path,priority:Y.config.cookie?.priority??H?.cookie?.config.priority,partitioned:Y.config.cookie?.partitioned??H?.cookie?.config.partitioned,sameSite:Y.config.cookie?.sameSite??H?.cookie?.config.sameSite,secure:Y.config.cookie?.secure??H?.cookie?.config.secure,secrets:Y.config.cookie?.secrets??H?.cookie?.config.secrets,sign:Y.config.cookie?.sign??H?.cookie?.config.sign},g=Z.headers.get("cookie");G.cookie=await mN(G.set,g,C);let c=H?.createHeaders?.();if(c)oW(c,G.headers);let f=H?.createParams?.();if(f)oW(f,G.params);let y=H?.createQuery?.();if(y)oW(y,G.query);if(z.transform)for(let E=0;E<z.transform.length;E++){let k=z.transform[E],b=k.fn(G);if(b instanceof Promise)b=await b;if(b instanceof V1){let u=$(b,G.set);if(u)return G.response=u}if(k.subType==="derive")Object.assign(G,b)}if(H){if(c){let E=structuredClone(G.headers);for(let[k,b]of Z.headers)E[k]=b;if(H.headers.Check(E)===!1)throw new D0("header",H.headers,E)}else if(H.headers?.Decode)G.headers=H.headers.Decode(G.headers);if(f?.Check(G.params)===!1)throw new D0("params",H.params,G.params);else if(H.params?.Decode)G.params=H.params.Decode(G.params);if(H.query?.schema){let E=H.query.schema;if(E.$defs?.[E.$ref])E=E.$defs[E.$ref];let k=E.properties;for(let b of Object.keys(k)){let u=k[b];if((u.type==="array"||u.items?.type==="string")&&typeof G.query[b]==="string"&&G.query[b])G.query[b]=G.query[b].split(",")}}if(y?.Check(G.query)===!1)throw new D0("query",H.query,G.query);else if(H.query?.Decode)G.query=H.query.Decode(G.query);if(H.createCookie?.()){let E={};for(let[k,b]of Object.entries(G.cookie))E[k]=b.value;if(H.cookie.Check(E)===!1)throw new D0("cookie",H.cookie,E);else if(H.cookie?.Decode)E=H.cookie.Decode(E)}if(H.createBody?.()?.Check(D)===!1)throw new D0("body",H.body,D);else if(H.body?.Decode)G.body=H.body.Decode(D)}if(z.beforeHandle)for(let E=0;E<z.beforeHandle.length;E++){let k=z.beforeHandle[E],b=k.fn(G);if(b instanceof Promise)b=await b;if(b instanceof V1){let u=$(b,G.set);if(u)return G.response=u}if(k.subType==="resolve"){Object.assign(G,b);continue}if(b!==void 0){if(G.response=b,z.afterHandle)for(let h=0;h<z.afterHandle.length;h++){let L0=z.afterHandle[h].fn(G);if(L0 instanceof Promise)L0=await L0;if(L0)b=L0}let u=$(b,G.set);if(u)return G.response=u}}let v=typeof B==="function"?B(G):B;if(v instanceof Promise)v=await v;if(!z.afterHandle?.length){let E=v instanceof V1,k=E?v.code:U.status?typeof U.status==="string"?D$[U.status]:U.status:200;if(E)U.status=k,v=v.response;let b=H?.createResponse?.()?.[k];if(b?.Check(v)===!1)if(b?.Clean){let u=b.Clean(v);if(b?.Check(u)===!1)throw new D0("response",b,v);v=u}else throw new D0("response",b,v);if(b?.Encode)v=b.Encode(v);if(b?.Clean)v=b.Clean(v)}else{G.response=v;for(let E=0;E<z.afterHandle.length;E++){let k=z.afterHandle[E].fn(G);if(k instanceof Promise)k=await k;let b=k instanceof V1,u=b?k.code:U.status?typeof U.status==="string"?D$[U.status]:U.status:200;if(b)U.status=u,k=k.response;let h=H?.createResponse?.()?.[u];if(h?.Check(k)===!1)if(h?.Clean){let l=h.Clean(k);if(h?.Check(l)===!1)throw new D0("response",h,k);k=l}else throw new D0("response",h,k);if(h?.Encode)G.response=k=h.Encode(k);if(h?.Clean)G.response=k=h.Clean(k);let L0=$(k,G.set);if(L0!==void 0)return G.response=L0}}if(G.set.cookie&&C?.sign){let E=!C.secrets?void 0:typeof C.secrets==="string"?C.secrets:C.secrets[0];if(C.sign===!0){if(E)for(let[k,b]of Object.entries(G.set.cookie))G.set.cookie[k].value=await rQ(b.value,E)}else{let k=H?.cookie?.schema?.properties;if(E)for(let b of C.sign){if(!(b in k))continue;if(G.set.cookie[b]?.value)G.set.cookie[b].value=await rQ(G.set.cookie[b].value,E)}}}return X(G.response=v,G.set)}catch(A){let O=A instanceof _Q&&A.error?A.error:A;return Y.handleError(G,O)}finally{if(Y.event.afterResponse)setImmediate(async()=>{for(let A of Y.event.afterResponse)await A.fn(G)})}}},rK=(Y)=>{let{mapResponse:X}=Y["~adapter"].handler;return async($,Q)=>{let Z=Object.assign($,{error:Q,code:Q.code});if(Z.set=$.set,Y.event.error)for(let W=0;W<Y.event.error.length;W++){let J=Y.event.error[W].fn(Z);if(J instanceof Promise)J=await J;if(J!==void 0&&J!==null)return $.response=X(J,$.set)}return new Response(typeof Q.cause==="string"?Q.cause:Q.message,{headers:$.set.headers,status:Q.status??500})}};class B1{config;server=null;dependencies={};"~Prefix"="";"~Singleton"=null;"~Definitions"=null;"~Metadata"=null;"~Ephemeral"=null;"~Volatile"=null;"~Routes"=null;singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:w.Module({}),type:{},error:{}};extender={macro:{},higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){if(!this.global&&!this.scoped&&!this.local)return{body:void 0,headers:void 0,params:void 0,query:void 0,cookie:void 0,response:void 0};return J$(J$(this.global,this.scoped),this.local)}};standaloneValidator={global:null,scoped:null,local:null};event={};telemetry;router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new K6({lazy:!0,onParam:$N.default});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new K6({onParam:$N.default});return this["~dynamic"]},static:{},response:{},history:[]};routeTree={};get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}getGlobalDefinitions(){return this.definitions}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,path:!1,route:!1,url:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new xN(console.error,()=>{});return this._promisedModules}constructor(Y={}){if(Y.tags)if(!Y.detail)Y.detail={tags:Y.tags};else Y.detail.tags=Y.tags;if(this.config={aot:X4.ELYSIA_AOT!=="false",nativeStaticResponse:!0,systemRouter:!0,encodeSchema:!0,normalize:!0,...Y,prefix:Y.prefix?Y.prefix.charCodeAt(0)===47?Y.prefix:`/${Y.prefix}`:void 0,cookie:{path:"/",...Y?.cookie},experimental:Y?.experimental??{},seed:Y?.seed===void 0?"":Y?.seed},this["~adapter"]=Y.adapter??(typeof Bun<"u"?tK:S6),Y?.analytic&&(Y?.name||Y?.seed!==void 0))this.telemetry={stack:Error().stack}}"~adapter";env(Y,X=X4){if(w1(Y,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0,sanitize:()=>this.config.sanitize}).Check(X)===!1){let $=new D0("env",Y,X);throw Error($.all.map((Q)=>Q.summary).join(`
`))}return this}wrap(Y){return this.extender.higherOrderFunctions.push({checksum:N$(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Y.toString()})),fn:Y}),this}get models(){let Y={};for(let X of Object.keys(this.definitions.type))Y[X]=w1(this.definitions.typebox.Import(X));return Y.modules=this.definitions.typebox,Y}add(Y,X,$,Q,Z){let W=Z?.skipPrefix??!1,J=Z?.allowMeta??!1;Q??={},this.applyMacro(Q);let M=[];if(Q.standaloneValidator)M=M.concat(Q.standaloneValidator);if(this.standaloneValidator.local)M=M.concat(this.standaloneValidator.local);if(this.standaloneValidator.scoped)M=M.concat(this.standaloneValidator.scoped);if(this.standaloneValidator.global)M=M.concat(this.standaloneValidator.global);if(X!==""&&X.charCodeAt(0)!==47)X="/"+X;if(this.config.prefix&&!W)X=this.config.prefix+X;if(Q?.type)switch(Q.type){case"text":Q.type="text/plain";break;case"json":Q.type="application/json";break;case"formdata":Q.type="multipart/form-data";break;case"urlencoded":Q.type="application/x-www-form-urlencoded";break;case"arrayBuffer":Q.type="application/octet-stream";break;default:break}let N=this.validator.getCandidate(),U={body:Q?.body??N?.body,headers:Q?.headers??N?.headers,params:Q?.params??N?.params,query:Q?.query??N?.query,cookie:Q?.cookie??N?.cookie,response:Q?.response??N?.response},G=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,A=()=>{let E=this.definitions.type,k=!this.config.aot,b=this.config.normalize,u=this.definitions.typebox,h=()=>this.config.sanitize,L0=()=>{if(U.cookie||M.find((l)=>l.cookie))return hK({modules:u,validator:U.cookie,defaultConfig:this.config.cookie,normalize:b,config:U.cookie?.config??{},dynamic:k,models:E,validators:M.map((l)=>l.cookie),sanitize:h})};return G?{body:w1(U.body,{modules:u,dynamic:k,models:E,normalize:b,additionalCoerce:Z4(),validators:M.map((l)=>l.body),sanitize:h}),headers:w1(U.headers,{modules:u,dynamic:k,models:E,additionalProperties:!0,coerce:!0,additionalCoerce:B$(),validators:M.map((l)=>l.headers),sanitize:h}),params:w1(U.params,{modules:u,dynamic:k,models:E,coerce:!0,additionalCoerce:B$(),validators:M.map((l)=>l.params),sanitize:h}),query:w1(U.query,{modules:u,dynamic:k,models:E,normalize:b,coerce:!0,additionalCoerce:CN(),validators:M.map((l)=>l.query),sanitize:h}),cookie:L0(),response:FN(U.response,{modules:u,dynamic:k,models:E,normalize:b,validators:M.map((l)=>l.response),sanitize:h})}:{createBody(){if(this.body)return this.body;return this.body=w1(U.body,{modules:u,dynamic:k,models:E,normalize:b,additionalCoerce:Z4(),validators:M.map((l)=>l.body),sanitize:h})},createHeaders(){if(this.headers)return this.headers;return this.headers=w1(U.headers,{modules:u,dynamic:k,models:E,normalize:b,additionalProperties:!b,coerce:!0,additionalCoerce:B$(),validators:M.map((l)=>l.headers),sanitize:h})},createParams(){if(this.params)return this.params;return this.params=w1(U.params,{modules:u,dynamic:k,models:E,normalize:b,coerce:!0,additionalCoerce:B$(),validators:M.map((l)=>l.params),sanitize:h})},createQuery(){if(this.query)return this.query;return this.query=w1(U.query,{modules:u,dynamic:k,models:E,normalize:b,coerce:!0,additionalCoerce:CN(),validators:M.map((l)=>l.query),sanitize:h})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=L0()},createResponse(){if(this.response)return this.response;return this.response=FN(U.response,{modules:u,dynamic:k,models:E,normalize:b,validators:M.map((l)=>l.response),sanitize:h})}}};if(N.body||N.cookie||N.headers||N.params||N.query||N.response)Q=x8(Q,N);if(Q.tags)if(!Q.detail)Q.detail={tags:Q.tags};else Q.detail.tags=Q.tags;if(d0(this.config.detail))Q.detail=E1(Object.assign({},this.config.detail),Q.detail);let O=d0(this.event)?x8(this.event,GN(Q)):{...yL(GN(Q))};if(M.length)Object.assign(O,{standaloneValidator:M});if(this.config.aot===!1){let E=A();this.router.dynamic.add(Y,X,{validator:E,hooks:O,content:Q?.type,handle:$,route:X});let k=U$(X,{dynamic:!0});if(X!==k)this.router.dynamic.add(Y,k,{validator:E,hooks:O,content:Q?.type,handle:$,route:X});if(!this.config.strictPath){let b=G$(X);this.router.dynamic.add(Y,b,{validator:E,hooks:O,content:Q?.type,handle:$,route:X});let u=U$(b);if(b!==u)this.router.dynamic.add(Y,b,{validator:E,hooks:O,content:Q?.type,handle:$,route:X})}this.router.history.push({method:Y,path:X,composed:null,handler:$,compile:void 0,hooks:O});return}let B=this["~adapter"].handler,z=typeof $!=="function"?()=>{let E={redirect:JZ,request:this["~adapter"].isWebStandard?new Request(`http://ely.sia${X}`,{method:Y}):void 0,server:null,set:{headers:Object.assign({},this.setHeaders)},status:m0,store:this.store};try{this.event.request?.map((b)=>{if(typeof b.fn==="function")return b.fn(E);if(typeof b==="function")return b(E)})}catch(b){let u;if(E.error=b,this.event.error?.some((h)=>{if(typeof h.fn==="function")return u=h.fn(E);if(typeof h==="function")return u=h(E)}),u!==void 0)$=u}let k=B.createNativeStaticHandler?.($,O,E.set);return k instanceof Promise?k.then((b)=>{if(b)return b}):k?.()}:void 0,H=this.config.nativeStaticResponse===!0,P=(E)=>{if(!H||!z)return;if(bN)if(this.router.response[E])this.router.response[E][Y]=z();else this.router.response[E]={[Y]:z()};else this.router.response[E]=z()};P(X);let R,D=()=>{if(R)return R;return R=pK({app:this,path:X,method:Y,hooks:O,validator:A(),handler:typeof $!=="function"&&typeof B.createStaticHandler!=="function"?()=>$:$,allowMeta:J,inference:this.inference})},C;if(`${Y}_${X}`in this.routeTree)for(let E=0;E<this.router.history.length;E++){let k=this.router.history[E];if(k.path===X&&k.method===Y){C=E;break}}else this.routeTree[`${Y}_${X}`]=this.router.history.length;let g=C??this.router.history.length,c=G?D():(E)=>(this.router.history[g].composed=D())(E);if(C!==void 0)this.router.history[C]=Object.assign({method:Y,path:X,composed:c,compile:D,handler:$,hooks:O},M.length?{standaloneValidators:M}:void 0,Q.webSocket?{websocket:Q.websocket}:void 0);else this.router.history.push(Object.assign({method:Y,path:X,composed:c,compile:D,handler:$,hooks:O},Q.webSocket?{websocket:Q.websocket}:void 0));let f={handler:G?c:void 0,compile(){return this.handler=D()}},y=this.router.static,v=X.indexOf(":")===-1&&X.indexOf("*")===-1;if(Y==="WS"){if(v){if(X in y)y[X][Y]=g;else y[X]={[Y]:g};return}if(this.router.http.add("WS",X,f),!this.config.strictPath)this.router.http.add("WS",G$(X),f);let E=U$(X,{dynamic:!0});if(X!==E)this.router.http.add("WS",E,f);return}if(v){if(X in y)y[X][Y]=g;else y[X]={[Y]:g};if(!this.config.strictPath)P(G$(X))}else{if(this.router.http.add(Y,X,f),!this.config.strictPath){let k=G$(X);P(k),this.router.http.add(Y,k,f)}let E=U$(X,{dynamic:!0});if(X!==E)this.router.http.add(Y,E,f),P(E)}}setHeaders;headers(Y){if(!Y)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=E1(this.setHeaders,Y),this}onStart(Y){return this.on("start",Y),this}onRequest(Y){return this.on("request",Y),this}onParse(Y,X){if(!X){if(typeof Y==="string")return this.on("parse",this["~parser"][Y]);return this.on("parse",Y)}return this.on(Y,"parse",X)}parser(Y,X){return this["~parser"][Y]=X,this}onTransform(Y,X){if(!X)return this.on("transform",Y);return this.on(Y,"transform",X)}resolve(Y,X){if(!X)X=Y,Y={as:"local"};let $={subType:"resolve",fn:X};return this.onBeforeHandle(Y,$)}mapResolve(Y,X){if(!X)X=Y,Y={as:"local"};let $={subType:"mapResolve",fn:X};return this.onBeforeHandle(Y,$)}onBeforeHandle(Y,X){if(!X)return this.on("beforeHandle",Y);return this.on(Y,"beforeHandle",X)}onAfterHandle(Y,X){if(!X)return this.on("afterHandle",Y);return this.on(Y,"afterHandle",X)}mapResponse(Y,X){if(!X)return this.on("mapResponse",Y);return this.on(Y,"mapResponse",X)}onAfterResponse(Y,X){if(!X)return this.on("afterResponse",Y);return this.on(Y,"afterResponse",X)}trace(Y,X){if(!X)X=Y,Y={as:"local"};if(!Array.isArray(X))X=[X];for(let $ of X)this.on(Y,"trace",TK($));return this}error(Y,X){switch(typeof Y){case"string":return X.prototype[sQ]=Y,this.definitions.error[Y]=X,this;case"function":return this.definitions.error=Y(this.definitions.error),this}for(let[$,Q]of Object.entries(Y))Q.prototype[sQ]=$,this.definitions.error[$]=Q;return this}onError(Y,X){if(!X)return this.on("error",Y);return this.on(Y,"error",X)}onStop(Y){return this.on("stop",Y),this}on(Y,X,$){let Q;switch(typeof Y){case"string":Q=Y,$=X;break;case"object":if(Q=X,!Array.isArray(X)&&typeof X==="object")$=X;break}if(Array.isArray($))$=D1($);else if(typeof $==="function")$=[{fn:$}];else $=[$];let Z=$;for(let W of Z)if(W.scope=typeof Y==="string"?"local":Y?.as??"local",Q==="resolve"||Q==="derive")W.subType=Q;if(Q!=="trace")this.inference=$Z({[Q]:Z.map((W)=>W.fn)},this.inference,this.config.sucrose);for(let W of Z){let J=hL(W,"global",{skipIfHasType:!0});switch(Q){case"start":this.event.start??=[],this.event.start.push(J);break;case"request":this.event.request??=[],this.event.request.push(J);break;case"parse":this.event.parse??=[],this.event.parse.push(J);break;case"transform":this.event.transform??=[],this.event.transform.push(J);break;case"derive":this.event.transform??=[],this.event.transform.push(D1(J,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(J);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push(D1(J,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(J);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(J);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(J);break;case"trace":this.event.trace??=[],this.event.trace.push(J);break;case"error":this.event.error??=[],this.event.error.push(J);break;case"stop":this.event.stop??=[],this.event.stop.push(J);break}}return this}as(Y){if(M8(this.event.parse,Y),M8(this.event.transform,Y),M8(this.event.beforeHandle,Y),M8(this.event.afterHandle,Y),M8(this.event.mapResponse,Y),M8(this.event.afterResponse,Y),M8(this.event.trace,Y),M8(this.event.error,Y),Y==="scoped"){if(this.validator.scoped=J$(this.validator.scoped,this.validator.local),this.validator.local=null,this.standaloneValidator.local!==null)this.standaloneValidator.scoped||=[],this.standaloneValidator.scoped.push(...this.standaloneValidator.local),this.standaloneValidator.local=null}else if(Y==="global"){if(this.validator.global=J$(this.validator.global,J$(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null,this.standaloneValidator.local!==null)this.standaloneValidator.scoped||=[],this.standaloneValidator.scoped.push(...this.standaloneValidator.local),this.standaloneValidator.local=null;if(this.standaloneValidator.scoped!==null)this.standaloneValidator.global||=[],this.standaloneValidator.global.push(...this.standaloneValidator.scoped),this.standaloneValidator.scoped=null}return this}group(Y,X,$){let Q=new B1({...this.config,prefix:""});Q.singleton={...this.singleton},Q.definitions={...this.definitions},Q.getServer=()=>this.getServer(),Q.inference=BN(this.inference),Q.extender={...this.extender},Q["~parser"]=this["~parser"],Q.standaloneValidator={local:[...this.standaloneValidator.local??[]],scoped:[...this.standaloneValidator.scoped??[]],global:[...this.standaloneValidator.global??[]]};let Z=typeof X==="object",W=(Z?$:X)(Q);if(this.singleton=E1(this.singleton,Q.singleton),this.definitions=E1(this.definitions,Q.definitions),W.event.request?.length)this.event.request=[...this.event.request||[],...W.event.request||[]];if(W.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...W.event.mapResponse||[]];return this.model(W.definitions.type),Object.values(Q.router.history).forEach(({method:J,path:M,handler:N,hooks:U})=>{if(M=(Z?"":this.config.prefix??"")+Y+M,Z){let{body:G,headers:A,query:O,params:B,cookie:z,response:H,...P}=X,R=U,D=G||A||O||B||z||H;this.add(J,M,N,x8(P,{...R||{},error:!R.error?W.event.error:Array.isArray(R.error)?[...R.error??[],...W.event.error??[]]:[R.error,...W.event.error??[]],standaloneValidator:!D?R.standaloneValidator:[...R.standaloneValidator??[],{body:G,headers:A,query:O,params:B,cookie:z,response:H}]}),void 0)}else this.add(J,M,N,x8(U,{error:W.event.error}),{skipPrefix:!0})}),this}guard(Y,X){if(!X){if(typeof Y==="object"){if(this.applyMacro(Y),Y.detail)if(this.config.detail)this.config.detail=E1(Object.assign({},this.config.detail),Y.detail);else this.config.detail=Y.detail;if(Y.tags)if(!this.config.detail)this.config.detail={tags:Y.tags};else this.config.detail.tags=Y.tags;let Z=Y.as??"local";if(Y.schema==="standalone"){if(!this.standaloneValidator[Z])this.standaloneValidator[Z]=[];let W=!Y?.response?void 0:typeof Y.response==="string"||(S in Y.response)||("~standard"in Y.response)?{200:Y.response}:Y?.response;this.standaloneValidator[Z].push({body:Y.body,headers:Y.headers,params:Y.params,query:Y.query,response:W,cookie:Y.cookie})}else this.validator[Z]={body:Y.body??this.validator[Z]?.body,headers:Y.headers??this.validator[Z]?.headers,params:Y.params??this.validator[Z]?.params,query:Y.query??this.validator[Z]?.query,response:Y.response??this.validator[Z]?.response,cookie:Y.cookie??this.validator[Z]?.cookie};if(Y.parse)this.on({as:Z},"parse",Y.parse);if(Y.transform)this.on({as:Z},"transform",Y.transform);if(Y.derive)this.on({as:Z},"derive",Y.derive);if(Y.beforeHandle)this.on({as:Z},"beforeHandle",Y.beforeHandle);if(Y.resolve)this.on({as:Z},"resolve",Y.resolve);if(Y.afterHandle)this.on({as:Z},"afterHandle",Y.afterHandle);if(Y.mapResponse)this.on({as:Z},"mapResponse",Y.mapResponse);if(Y.afterResponse)this.on({as:Z},"afterResponse",Y.afterResponse);if(Y.error)this.on({as:Z},"error",Y.error);return this}return this.guard({},Y)}let $=new B1({...this.config,prefix:""});$.singleton={...this.singleton},$.definitions={...this.definitions},$.inference=BN(this.inference),$.extender={...this.extender},$.getServer=()=>this.getServer();let Q=X($);if(this.singleton=E1(this.singleton,$.singleton),this.definitions=E1(this.definitions,$.definitions),Q.getServer=()=>this.server,Q.event.request?.length)this.event.request=[...this.event.request||[],...Q.event.request||[]];if(Q.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...Q.event.mapResponse||[]];return this.model(Q.definitions.type),Object.values($.router.history).forEach(({method:Z,path:W,handler:J,hooks:M})=>{let{body:N,headers:U,query:G,params:A,cookie:O,response:B,...z}=Y,H=N||U||G||A||O||B;this.add(Z,W,J,x8(z,{...M||{},error:!M.error?Q.event.error:Array.isArray(M.error)?[...M.error??[],...Q.event.error??[]]:[M.error,...Q.event.error??[]],standaloneValidator:!H?M.standaloneValidator:[...M.standaloneValidator??[],{body:N,headers:U,query:G,params:A,cookie:O,response:B}]}))}),this}use(Y){if(!Y)return this;if(Array.isArray(Y)){let X=this;for(let $ of Y)X=X.use($);return X}if(Y instanceof Promise)return this.promisedModules.add(Y.then((X)=>{if(typeof X==="function")return X(this);if(X instanceof B1)return this._use(X).compile();if(X.constructor?.name==="Elysia")return this._use(X).compile();if(typeof X.default==="function")return X.default(this);if(X.default instanceof B1)return this._use(X.default);if(X.constructor?.name==="Elysia")return this._use(X.default);if(X.constructor?.name==="_Elysia")return this._use(X.default);try{return this._use(X.default)}catch($){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),$}}).then((X)=>{if(X&&typeof X.compile==="function")X.compile();return X})),this;return this._use(Y)}propagatePromiseModules(Y){if(Y.promisedModules.size<=0)return this;for(let X of Y.promisedModules.promises)this.promisedModules.add(X.then(($)=>{if(!$)return;let Q=this._use($);if(Q instanceof Promise)return Q.then((Z)=>{if(Z)Z.compile();else $.compile()});return $.compile()}));return this}_use(Y){if(typeof Y==="function"){let Q=Y(this);if(Q instanceof Promise)return this.promisedModules.add(Q.then((Z)=>{if(Z instanceof B1){Z.getServer=()=>this.getServer(),Z.getGlobalRoutes=()=>this.getGlobalRoutes(),Z.getGlobalDefinitions=()=>this.getGlobalDefinitions(),Z.model(this.definitions.type),Z.error(this.definitions.error);for(let{method:W,path:J,handler:M,hooks:N}of Object.values(Z.router.history))this.add(W,J,M,N,void 0);if(Z===this)return;return this.propagatePromiseModules(Z),Z}if(typeof Z==="function")return Z(this);if(typeof Z.default==="function")return Z.default(this);return this._use(Z)}).then((Z)=>{if(Z&&typeof Z.compile==="function")Z.compile();return Z})),this;return Q}this.propagatePromiseModules(Y);let X=Y.config.name,$=Y.config.seed;if(Y.getParent=()=>this,Y.getServer=()=>this.getServer(),Y.getGlobalRoutes=()=>this.getGlobalRoutes(),Y.getGlobalDefinitions=()=>this.getGlobalDefinitions(),Y.standaloneValidator?.scoped)if(this.standaloneValidator.local)this.standaloneValidator.local=this.standaloneValidator.local.concat(Y.standaloneValidator.scoped);else this.standaloneValidator.local=Y.standaloneValidator.scoped;if(Y.standaloneValidator?.global)if(this.standaloneValidator.global)this.standaloneValidator.global=this.standaloneValidator.global.concat(Y.standaloneValidator.global);else this.standaloneValidator.global=Y.standaloneValidator.global;if(d0(Y["~parser"]))this["~parser"]={...Y["~parser"],...this["~parser"]};if(Y.setHeaders)this.headers(Y.setHeaders);if(X){if(!(X in this.dependencies))this.dependencies[X]=[];let Q=$!==void 0?N$(X+JSON.stringify($)):0;if(!this.dependencies[X].some(({checksum:Z})=>Q===Z))this.extender.macro={...this.extender.macro,...Y.extender.macro},this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Y.extender.higherOrderFunctions)}else{if(d0(Y.extender.macro))this.extender.macro={...this.extender.macro,...Y.extender.macro};if(Y.extender.higherOrderFunctions.length)this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(Y.extender.higherOrderFunctions)}if(Y.extender.higherOrderFunctions.length){pL(this.extender.higherOrderFunctions);let Q=[];for(let Z=0;Z<this.extender.higherOrderFunctions.length;Z++){let W=this.extender.higherOrderFunctions[Z];if(W.checksum){if(Q.includes(W.checksum))this.extender.higherOrderFunctions.splice(Z,1),Z--;Q.push(W.checksum)}}Q.length=0}if(this.inference=$4(this.inference,Y.inference),d0(Y.singleton.decorator))this.decorate(Y.singleton.decorator);if(d0(Y.singleton.store))this.state(Y.singleton.store);if(d0(Y.definitions.type))this.model(Y.definitions.type);if(d0(Y.definitions.error))this.error(Y.definitions.error);if(d0(Y.extender.macro))this.extender.macro={...this.extender.macro,...Y.extender.macro};for(let{method:Q,path:Z,handler:W,hooks:J}of Object.values(Y.router.history))this.add(Q,Z,W,J);if(X){if(!(X in this.dependencies))this.dependencies[X]=[];let Q=$!==void 0?N$(X+JSON.stringify($)):0;if(this.dependencies[X].some(({checksum:Z})=>Q===Z))return this;if(this.dependencies[X].push(this.config?.analytic?{name:Y.config.name,seed:Y.config.seed,checksum:Q,dependencies:Y.dependencies,stack:Y.telemetry?.stack,routes:Y.router.history,decorators:Y.singleton,store:Y.singleton.store,error:Y.definitions.error,derive:Y.event.transform?.filter((Z)=>Z?.subType==="derive").map((Z)=>({fn:Z.toString(),stack:Error().stack??""})),resolve:Y.event.transform?.filter((Z)=>Z?.subType==="resolve").map((Z)=>({fn:Z.toString(),stack:Error().stack??""}))}:{name:Y.config.name,seed:Y.config.seed,checksum:Q,dependencies:Y.dependencies}),d0(Y.event))this.event=ZN(this.event,WN(Y.event),Q)}else if(d0(Y.event))this.event=ZN(this.event,WN(Y.event));if(Y.validator.global)this.validator.global=x8(this.validator.global,{...Y.validator.global});if(Y.validator.scoped)this.validator.local=x8(this.validator.local,{...Y.validator.scoped});return this}macro(Y,X){if(typeof Y==="string"&&!X)throw Error("Macro function is required");if(typeof Y==="string")this.extender.macro[Y]=X;else this.extender.macro={...this.extender.macro,...Y};return this}applyMacro(Y,X=Y,{iteration:$=0,applied:Q={}}={}){if($>=16)return;let Z=this.extender.macro;for(let[W,J]of Object.entries(X)){if(W in Z===!1)continue;let M=typeof Z[W]==="function"?Z[W](J):Z[W];if(!M||typeof Z[W]==="object"&&J===!1)return;let N=N$(W+JSON.stringify(M.seed??J));if(N in Q)continue;Q[N]=!0;for(let[U,G]of Object.entries(M)){if(U==="seed")continue;if(U in lL){mL(Y,U,G),delete Y[W];continue}if(U==="detail"){if(!Y.detail)Y.detail={};Y.detail=E1(Y.detail,G,{mergeArray:!0}),delete Y[W];continue}if(U in Z){this.applyMacro(Y,{[U]:G},{applied:Q,iteration:$+1}),delete Y[W];continue}if((U==="derive"||U==="resolve")&&typeof G==="function")G={fn:G,subType:U};switch(typeof Y[U]){case"function":Y[U]=[Y[U],G];break;case"object":if(Array.isArray(Y[U]))Y[U].push(G);else Y[U]=[Y[U],G];break;case"undefined":Y[U]=G;break}delete Y[W]}}}mount(Y,X,$){if(Y instanceof B1||typeof Y==="function"||Y.length===0||Y==="/"){let J=typeof Y==="function"?Y:Y instanceof B1?Y.compile().fetch:X instanceof B1?X.compile().fetch:typeof X==="function"?X:(()=>{throw Error("Invalid handler")})(),M=({request:N,path:U})=>J(new Request(QN(N.url,U),{method:N.method,headers:N.headers,signal:N.signal,credentials:N.credentials,referrerPolicy:N.referrerPolicy,duplex:N.duplex,redirect:N.redirect,mode:N.mode,keepalive:N.keepalive,integrity:N.integrity,body:N.body}));return this.route("ALL","/*",M,{parse:"none",...$,detail:{...$?.detail,hide:!0},config:{mount:J}}),this}let Q=X instanceof B1?X.compile().fetch:typeof X==="function"?X:(()=>{throw Error("Invalid handler")})(),Z=Y.length-(Y.endsWith("*")?1:0),W=({request:J,path:M})=>Q(new Request(QN(J.url,M.slice(Z)||"/"),{method:J.method,headers:J.headers,signal:J.signal,credentials:J.credentials,referrerPolicy:J.referrerPolicy,duplex:J.duplex,redirect:J.redirect,mode:J.mode,keepalive:J.keepalive,integrity:J.integrity,body:J.body}));return this.route("ALL",Y,W,{parse:"none",...$,detail:{...$?.detail,hide:!0},config:{mount:Q}}),this.route("ALL",Y+(Y.endsWith("/")?"*":"/*"),W,{parse:"none",...$,detail:{...$?.detail,hide:!0},config:{mount:Q}}),this}get(Y,X,$){return this.add("GET",Y,X,$),this}post(Y,X,$){return this.add("POST",Y,X,$),this}put(Y,X,$){return this.add("PUT",Y,X,$),this}patch(Y,X,$){return this.add("PATCH",Y,X,$),this}delete(Y,X,$){return this.add("DELETE",Y,X,$),this}options(Y,X,$){return this.add("OPTIONS",Y,X,$),this}all(Y,X,$){return this.add("ALL",Y,X,$),this}head(Y,X,$){return this.add("HEAD",Y,X,$),this}connect(Y,X,$){return this.add("CONNECT",Y,X,$),this}route(Y,X,$,Q){return this.add(Y.toUpperCase(),X,$,Q,Q?.config),this}ws(Y,X){if(this["~adapter"].ws)this["~adapter"].ws(this,Y,X);else console.warn("Current adapter doesn't support WebSocket");return this}state(Y,X,$){if(X===void 0)$=Y,Y={as:"append"},X="";else if($===void 0){if(typeof Y==="string")$=X,X=Y,Y={as:"append"};else if(typeof Y==="object")$=X,X=""}let{as:Q}=Y;if(typeof X!=="string")return this;switch(typeof $){case"object":if(!$||!d0($))return this;if(X){if(X in this.singleton.store)this.singleton.store[X]=E1(this.singleton.store[X],$,{override:Q==="override"});else this.singleton.store[X]=$;return this}if($===null)return this;return this.singleton.store=E1(this.singleton.store,$,{override:Q==="override"}),this;case"function":if(X){if(Q==="override"||!(X in this.singleton.store))this.singleton.store[X]=$}else this.singleton.store=$(this.singleton.store);return this;default:if(Q==="override"||!(X in this.singleton.store))this.singleton.store[X]=$;return this}}decorate(Y,X,$){if(X===void 0)$=Y,Y={as:"append"},X="";else if($===void 0){if(typeof Y==="string")$=X,X=Y,Y={as:"append"};else if(typeof Y==="object")$=X,X=""}let{as:Q}=Y;if(typeof X!=="string")return this;switch(typeof $){case"object":if(X){if(X in this.singleton.decorator)this.singleton.decorator[X]=E1(this.singleton.decorator[X],$,{override:Q==="override"});else this.singleton.decorator[X]=$;return this}if($===null)return this;return this.singleton.decorator=E1(this.singleton.decorator,$,{override:Q==="override"}),this;case"function":if(X){if(Q==="override"||!(X in this.singleton.decorator))this.singleton.decorator[X]=$}else this.singleton.decorator=$(this.singleton.decorator);return this;default:if(Q==="override"||!(X in this.singleton.decorator))this.singleton.decorator[X]=$;return this}}derive(Y,X){if(!X)X=Y,Y={as:"local"};let $={subType:"derive",fn:X};return this.onTransform(Y,$)}model(Y,X){let $=(Q)=>{let Z={};for(let W in Q)if(!("~standard"in Q[W]))Z[W]=Q[W];return Z};switch(typeof Y){case"object":let Q={},Z=Object.entries(Y);if(!Z.length)return this;for(let[M,N]of Z){if(M in this.definitions.type)continue;if("~standard"in N)this.definitions.type[M]=N;else Q[M]=this.definitions.type[M]=N,Q[M].$id??=`#/components/schemas/${M}`}return this.definitions.typebox=w.Module({...this.definitions.typebox.$defs,...Q}),this;case"function":let W=Y(this.definitions.type);return this.definitions.type=W,this.definitions.typebox=w.Module($(W)),this;case"string":if(!X)break;if(this.definitions.type[Y]=X,"~standard"in X)return this;let J={...X,id:X.$id??`#/components/schemas/${Y}`};return this.definitions.typebox=w.Module({...this.definitions.typebox.$defs,...J}),this}if(!X)return this;if(this.definitions.type[Y]=X,"~standard"in X)return this;return this.definitions.typebox=w.Module({...this.definitions.typebox.$defs,[Y]:X}),this}Ref(Y){return w.Ref(Y)}mapDerive(Y,X){if(!X)X=Y,Y={as:"local"};let $={subType:"mapDerive",fn:X};return this.onTransform(Y,$)}affix(Y,X,$){if($==="")return this;let Q=["_","-"," "],Z=(N)=>N[0].toUpperCase()+N.slice(1),W=Y==="prefix"?(N,U)=>Q.includes(N.at(-1)??"")?N+U:N+Z(U):Q.includes($.at(-1)??"")?(N,U)=>U+N:(N,U)=>U+Z(N),J=(N)=>{let U={};switch(N){case"decorator":for(let G in this.singleton.decorator)U[W($,G)]=this.singleton.decorator[G];this.singleton.decorator=U;break;case"state":for(let G in this.singleton.store)U[W($,G)]=this.singleton.store[G];this.singleton.store=U;break;case"model":for(let G in this.definitions.type)U[W($,G)]=this.definitions.type[G];this.definitions.type=U;break;case"error":for(let G in this.definitions.error)U[W($,G)]=this.definitions.error[G];this.definitions.error=U;break}},M=Array.isArray(X)?X:[X];for(let N of M.some((U)=>U==="all")?["decorator","state","model","error"]:M)J(N);return this}prefix(Y,X){return this.affix("prefix",Y,X)}suffix(Y,X){return this.affix("suffix",Y,X)}compile(){if(this["~adapter"].beforeCompile?.(this),this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?iW(this):_N(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=iW(this),this}handle=async(Y)=>this.fetch(Y);fetch=(Y)=>{return(this.fetch=this.config.aot?iW(this):_N(this))(Y)};handleError=async(Y,X)=>{return(this.handleError=this.config.aot?Y9(this):rK(this))(Y,X)};listen=(Y,X)=>{return this["~adapter"].listen(this)(Y,X),this};stop=async(Y)=>{return await this["~adapter"].stop?.(this,Y),this};[Symbol.dispose]=()=>{if(this.server)this.stop()};get modules(){return this.promisedModules}}import sK from"path";var aK=sK.join(import.meta.dir,"animeTV.db").toString(),$0=new Bun.SQL({adapter:"sqlite",filename:aK,create:!0,readwrite:!0});var eK=Number(process.env.CACHE_TTL)||300000;class GZ{db;constructor(){this.db=$0}static create(){return new GZ}async get(Y){try{let X=await this.db`SELECT value,createdAt FROM cache WHERE id = ${Y} LIMIT 1`.values();if(X.length===0)return null;return X[0][0]}catch(X){return null}}async set(Y,X){if(!X||Array.isArray(X)&&X.length===0)return;await this.db`
      INSERT OR REPLACE INTO cache (id, value, createdAt)
      VALUES (${Y}, ${X}, CURRENT_TIMESTAMP)
    `;return}async delete(Y){await this.db`DELETE FROM cache WHERE id = ${Y}`;return}clear(){return this.db`DELETE FROM cache WHERE createdAt <= datetime('now', '-${eK} milliseconds')  `}}class U4{static async getHomePageListAnime(){let X=await L1.get("getHomePageListAnime");if(X)try{return JSON.parse(X)}catch{await L1.delete("getHomePageListAnime")}let $;try{$=await QY("getHomePageListAnime",{})}catch(Q){throw m0(500,{error:"Failed to fetch anime list from source"})}if(!$.success)throw m0(404,{error:"Anime home list not found"});return await L1.set("getHomePageListAnime",JSON.stringify($.content)),$.content}}var Q9=w.Object({id:w.Number(),name:w.String(),cap:w.Number(),slug:w.String({pattern:"^[a-z0-9]+(?:-[a-z0-9]+)*$"}),imgUrl:w.Union([w.String(),w.Null()])}),B4=w.Object({error:w.String()});var R$;((UZ)=>(UZ.animeVideo=w.Object({foundUrl:w.Union([w.String(),w.Null()]),cap:w.String()}),UZ.animeVideoInvalid=w.Object({error:w.String()})))(R$||={});class BZ{static async getVideoSource(Y,X){let[$]=await $0`SELECT * FROM plugins_manifest`;if(!$)throw m0(500,{error:"Manifest not found"});let Q=`getAnimeStreamingLinks-${Y}-${X}`,Z=await L1.get(Q);if(Z)try{return JSON.parse(Z)}catch{await L1.delete(Q)}let W;try{W=await QY("getAnimeStreamingLinks",{url:[`${$.urlPage}/media/${Y}/${X}`]})}catch(J){throw m0(500,{error:"Failed to fetch video source"})}if(!W.success||W.content.length===0)throw m0(404,{error:"Video source not found"});return await L1.set(Q,JSON.stringify(W.content[0])),W.content[0]}static async getEpisodes(Y){let X="getEpisodeList-"+Y,$=await L1.get(X);if($)try{return JSON.parse($)}catch{await L1.delete(X)}let Q;try{Q=await QY("getEpisodeList",{slug:Y})}catch(Z){throw m0(500,{error:"Failed to fetch anime list from source"})}if(!Q.success)throw m0(404,{error:"Anime home list not found"});return await L1.set(X,JSON.stringify(Q.content)),Q.content}}var Z9=w.Object({genres:w.Optional(w.Array(w.String())),category:w.Optional(w.String()),status:w.Optional(w.String())}),py=w.Object({error:w.String()});var W9=w.Object({id:w.Number(),name:w.String(),slug:w.String(),imgUrl:w.Union([w.String(),w.Null()])}),ny=w.Object({error:w.String(),numberPages:w.String()});class A4{static async getSearchAnimeResults(Y,X,$){let Q="getSearchAnime-"+Y+(X?"-"+X:"")+($?"-"+JSON.stringify($):""),Z=await L1.get(Q);if(Z)try{return JSON.parse(Z)}catch{await L1.delete(Q)}let W;try{W=await QY("getSearchAnime",{args:{query:Y,page:X,category:$?.category,genres:$?.genres,status:$?.status}})}catch(J){throw m0(500,{error:"Failed to fetch anime list from source"})}if(!W.success)throw m0(404,{error:"Anime catalog list not found"});return await L1.set(Q,JSON.stringify(W.content)),W.content}}var H4=w.Object({cap:w.Number(),watched:w.Boolean(),last_position_seconds:w.Number()}),z4=w.Object({id:w.Number(),name:w.String(),imgUrl:w.Union([w.String(),w.Null()]),description:w.Union([w.String(),w.Null()]),slug:w.String(),status:w.String(),date:w.Number(),genres:w.Array(w.String()),caps:w.Number(),favorited:w.Boolean({default:!1}),lastEpisode:w.Union([w.Number(),w.Null()])}),j$=w.Object({error:w.String()});var{randomUUIDv7:q4}=globalThis.Bun;var g0={async findBySlug(Y){let[X]=await $0`SELECT * FROM animes WHERE slug = ${Y}`;return X?X:null},async isFavorited(Y){let[X]=await $0`
      SELECT COUNT(*) FROM favorites WHERE anime_id = ${Y}
    `;return X?Boolean(X["COUNT(*)"]):!1},async getLastEpisode(Y){let[X]=await $0`
      SELECT last_episode FROM activity_history WHERE anime_id = ${Y} LIMIT 1
    `;return X?X.last_episode:null},async findEpisodesWithHistory(Y,X=1){return(await $0`
      SELECT e.cap, h.watched, h.last_position_seconds
      FROM episodes e
      LEFT JOIN history h
        ON h.cap_number = e.cap
       AND h.anime_id = e.anime_id
       AND h.user_id = ${X}
      WHERE e.anime_id = ${Y};
    `.values()).map((Q)=>({cap:Q[0],watched:Boolean(Q[1]),last_position_seconds:Q[2]??0}))},async insertAnime(Y,X){await $0`
      INSERT INTO animes (id, name, description, img_url, status, slug, date, genres, caps)
      VALUES (${Y.id}, ${Y.name}, ${Y.description}, ${Y.imgUrl},
              ${Y.status}, ${X}, ${Y.date}, ${JSON.stringify(Y.genres)}, ${Y.caps})
    `},async insertInitialEpisodesAndHistory(Y,X,$=1){await $0.begin(async(Q)=>{for(let Z=1;Z<=X;Z++){let W=q4();await Q`
          INSERT INTO episodes (id, cap, anime_id)
          VALUES (${W}, ${Z}, ${Y})
          ON CONFLICT(anime_id, cap) DO NOTHING
        `,await Q`
          INSERT INTO history (id, user_id, anime_id, cap_number)
          VALUES (${q4()}, ${$}, ${Y}, ${Z})
          ON CONFLICT(user_id, anime_id, cap_number) DO NOTHING
        `}})},async update(Y,X){await $0`UPDATE animes SET name = ${Y.name}, description = ${Y.description}, img_url = ${Y.imgUrl}, status = ${Y.status}, date = ${Y.date}, genres = ${JSON.stringify(Y.genres)}, caps = ${Y.caps}, updated_at = datetime('now') WHERE slug = ${X}`},async insertOrUpdateHistory(Y,X,$=1,Q,Z){await $0`
      INSERT INTO history (id, user_id, anime_id, cap_number, last_position_seconds, watched)
      VALUES (${q4()}, ${$}, ${Y}, ${X}, ${Q}, ${Z})
      ON CONFLICT(user_id, anime_id, cap_number)
      DO UPDATE SET last_position_seconds = ${Q}, watched = ${Z}, updated_at = CURRENT_TIMESTAMP
    `}};class AZ{static async getAnimeDetails(Y){let X=await g0.findBySlug(Y);if(X){let J=await g0.findEpisodesWithHistory(X.id),M=await g0.isFavorited(X.id),N=await g0.getLastEpisode(X.id);return{details:{id:X.id,name:X.name,description:X.description,imgUrl:X.img_url,status:X.status,slug:X.slug,date:X.date,genres:JSON.parse(X.genres),caps:X.caps,favorited:M,lastEpisode:N},episodes:J}}let $;try{$=await QY("getAnimeDetails",{slug:Y})}catch{throw m0(500,{error:"Failed to fetch anime list from source"})}if(!$.success)throw m0(404,{error:"Anime not found"});await g0.insertAnime($.content,Y),await g0.insertInitialEpisodesAndHistory($.content.id,$.content.caps);let Q=await g0.findEpisodesWithHistory($.content.id),Z=await g0.getLastEpisode($.content.id),W=await g0.isFavorited($.content.id);return{details:{...$.content,lastEpisode:Z,favorited:W,slug:Y},episodes:Q}}static async updateAnime(Y){if(!await g0.findBySlug(Y))throw m0(404,{error:"Anime not found"});let $;try{$=await QY("getAnimeDetails",{slug:Y})}catch{throw m0(500,{error:"Failed to fetch anime list from source"})}if(!$.success)throw m0(404,{error:"Anime not found"});await g0.update($.content,Y),await g0.insertInitialEpisodesAndHistory($.content.id,$.content.caps),await g0.getLastEpisode($.content.id);let Q=await g0.findEpisodesWithHistory($.content.id),Z=await g0.getLastEpisode($.content.id),W=await g0.isFavorited($.content.id);return{details:{...$.content,slug:Y,favorited:W,lastEpisode:Z},episodes:Q}}}class O4{static async getHistoryVideo(Y,X){let[$]=await $0`SELECT watched,last_position_seconds
    from history WHERE anime_id = ${Y} AND cap_number = ${X}`;if(!$)return await g0.insertOrUpdateHistory(Y,X,1,0,!1),{watched:!1,last_position_seconds:0};return{watched:Boolean($.watched),last_position_seconds:$.last_position_seconds}}}class D4{static async getSchedule(){let X=await L1.get("getAnimeSchedule");if(X)try{return JSON.parse(X)}catch{await L1.delete("getAnimeSchedule")}let $;try{$=await QY("getAnimeSchedule",{})}catch{throw m0(500,{error:"Failed to fetch anime list from source"})}return await L1.set("getAnimeSchedule",JSON.stringify($.content)),$.content}}var w4=new B1({prefix:"/anime"});w4.get("/episodes/:slug",async({params:{slug:Y}})=>{return await BZ.getEpisodes(Y)}).get("/home",async()=>{return await U4.getHomePageListAnime()},{response:{200:w.Array(Q9),400:B4,500:B4}}).get("/video/:slug/:cap/:id",async({params:{slug:Y,cap:X,id:$}})=>{let Q=await BZ.getVideoSource(Y,X),Z=await O4.getHistoryVideo($,X),W=await g0.isFavorited($);return{result:Q,favorited:W,history:Z}},{params:w.Object({slug:w.String(),cap:w.Number(),id:w.Number()}),response:{200:w.Object({result:R$.animeVideo,favorited:w.Boolean(),history:w.Object({watched:w.Boolean(),last_position_seconds:w.Number()})}),400:R$.animeVideoInvalid,500:R$.animeVideoInvalid}}).get("/schedule",async()=>{return await D4.getSchedule()}).get("/search",async({query:Y})=>{let{status:X,genres:$,category:Q,querySearch:Z,page:W}=Y;return await A4.getSearchAnimeResults(Z,W,{genres:$,status:X,category:Q})},{query:w.Object({querySearch:w.String({default:" "}),page:w.Optional(w.Number()),...Z9.properties}),response:w.Object({results:w.Array(W9),numberPages:w.Number()})}).get("/details/:slug",async({params:{slug:Y}})=>{return await AZ.getAnimeDetails(Y)},{params:w.Object({slug:w.String()}),response:{200:w.Object({details:z4,episodes:w.Array(H4)}),404:j$,500:j$}}).get("/details/update/:slug",async({params:{slug:Y}})=>{return await AZ.updateAnime(Y)},{params:w.Object({slug:w.String()}),response:{200:w.Object({details:z4,episodes:w.Array(H4)}),404:j$,500:j$}});var YS=typeof new Headers()?.toJSON==="function",XS=(Y)=>{if(YS)return Object.keys(Y.toJSON()).join(", ");let X="",$=0;return Y.forEach((Q,Z)=>{if($)X=X+", "+Z;else X=Z;$++}),X},J9=(Y)=>{let{aot:X=!0,origin:$=!0,methods:Q=!0,allowedHeaders:Z=!0,exposeHeaders:W=!0,credentials:J=!0,maxAge:M=5,preflight:N=!0}=Y??{};if(Array.isArray(Z))Z=Z.join(", ");if(Array.isArray(W))W=W.join(", ");let U=typeof $==="boolean"?void 0:Array.isArray($)?$:[$],G=new B1({name:"@elysiajs/cors",seed:Y,aot:X}),A=U?.some((D)=>D==="*"),O={};if(U){for(let D of U)if(typeof D==="string")O[D]=!0}let B=(D,C,g)=>{if(Array.isArray(D))return D.some((c)=>B(c,C,g));switch(typeof D){case"string":if(g in O)return!0;let c=g.indexOf("://");if(c!==-1)g=g.slice(c+3);return D===g;case"function":return D(C)===!0;case"object":if(D instanceof RegExp)return D.test(g)}return!1},z=(D,C)=>{if($===!0){D.headers.vary="*",D.headers["access-control-allow-origin"]=C.headers.get("Origin")||"*";return}if(A){D.headers.vary="*",D.headers["access-control-allow-origin"]="*";return}if(!U?.length)return;let g=[];if(U.length){let c=C.headers.get("Origin")??"";for(let f=0;f<U.length;f++)if(B(U[f],C,c)===!0){D.headers.vary=$?"Origin":"*",D.headers["access-control-allow-origin"]=c||"*";return}}if(D.headers.vary="Origin",g.length)D.headers["access-control-allow-origin"]=g.join(", ")},H=(D,C)=>{if(!C)return;if(Q===!0)return D.headers["access-control-allow-methods"]=C??"*";if(Q===!1||!Q?.length)return;if(Q==="*")return D.headers["access-control-allow-methods"]="*";if(!Array.isArray(Q))return D.headers["access-control-allow-methods"]=Q;D.headers["access-control-allow-methods"]=Q.join(", ")},P={};if(typeof W==="string")P["access-control-expose-headers"]=W;if(typeof Z==="string")P["access-control-allow-headers"]=Z;if(J===!0)P["access-control-allow-credentials"]="true";G.headers(P);function R({set:D,request:C,headers:g}){if(z(D,C),H(D,C.headers.get("access-control-request-method")),Z===!0||W===!0){if(Z===!0)D.headers["access-control-allow-headers"]=g["access-control-request-headers"];if(W===!0)D.headers["access-control-expose-headers"]=Object.keys(g).join(",")}if(M)D.headers["access-control-max-age"]=M.toString();return new Response(null,{status:204})}if(N)G.options("/",R).options("/*",R);return G.onRequest(function({set:C,request:g}){if(z(C,g),H(C,g.method),Z===!0||W===!0){let c=XS(g.headers);if(Z===!0)C.headers["access-control-allow-headers"]=c;if(W===!0)C.headers["access-control-expose-headers"]=c}})};function ZY(Y,X,$,Q,Z,W,J,M){return ZY.fromTZ(ZY.tp(Y,X,$,Q,Z,W,J),M)}ZY.fromTZISO=(Y,X,$)=>{return ZY.fromTZ($S(Y,X),$)};ZY.fromTZ=function(Y,X){let $=new Date(Date.UTC(Y.y,Y.m-1,Y.d,Y.h,Y.i,Y.s)),Q=L4(Y.tz,$),Z=new Date($.getTime()-Q),W=L4(Y.tz,Z);if(W-Q===0)return Z;else{let J=new Date($.getTime()-W),M=L4(Y.tz,J);if(M-W===0)return J;else if(!X&&M-W>0)return J;else if(!X)return Z;else throw Error("Invalid date passed to fromTZ()")}};ZY.toTZ=function(Y,X){let $=Y.toLocaleString("en-US",{timeZone:X}).replace(/[\u202f]/," "),Q=new Date($);return{y:Q.getFullYear(),m:Q.getMonth()+1,d:Q.getDate(),h:Q.getHours(),i:Q.getMinutes(),s:Q.getSeconds(),tz:X}};ZY.tp=(Y,X,$,Q,Z,W,J)=>{return{y:Y,m:X,d:$,h:Q,i:Z,s:W,tz:J}};function L4(Y,X=new Date){let $=X.toLocaleString("en-US",{timeZone:Y,timeZoneName:"short"}).split(" ").slice(-1)[0],Q=X.toLocaleString("en-US").replace(/[\u202f]/," ");return Date.parse(`${Q} GMT`)-Date.parse(`${Q} ${$}`)}function $S(Y,X){let $=new Date(Date.parse(Y));if(isNaN($))throw Error("minitz: Invalid ISO8601 passed to parser.");let Q=Y.substring(9);if(Y.includes("Z")||Q.includes("-")||Q.includes("+"))return ZY.tp($.getUTCFullYear(),$.getUTCMonth()+1,$.getUTCDate(),$.getUTCHours(),$.getUTCMinutes(),$.getUTCSeconds(),"Etc/UTC");else return ZY.tp($.getFullYear(),$.getMonth()+1,$.getDate(),$.getHours(),$.getMinutes(),$.getSeconds(),X)}ZY.minitz=ZY;function QS(Y){if(Y===void 0)Y={};if(delete Y.name,Y.legacyMode=Y.legacyMode===void 0?!0:Y.legacyMode,Y.paused=Y.paused===void 0?!1:Y.paused,Y.maxRuns=Y.maxRuns===void 0?1/0:Y.maxRuns,Y.catch=Y.catch===void 0?!1:Y.catch,Y.interval=Y.interval===void 0?0:parseInt(Y.interval,10),Y.utcOffset=Y.utcOffset===void 0?void 0:parseInt(Y.utcOffset,10),Y.unref=Y.unref===void 0?!1:Y.unref,Y.startAt)Y.startAt=new K1(Y.startAt,Y.timezone);if(Y.stopAt)Y.stopAt=new K1(Y.stopAt,Y.timezone);if(Y.interval!==null){if(isNaN(Y.interval))throw Error("CronOptions: Supplied value for interval is not a number");else if(Y.interval<0)throw Error("CronOptions: Supplied value for interval can not be negative")}if(Y.utcOffset!==void 0){if(isNaN(Y.utcOffset))throw Error("CronOptions: Invalid value passed for utcOffset, should be number representing minutes offset from UTC.");else if(Y.utcOffset<-870||Y.utcOffset>870)throw Error("CronOptions: utcOffset out of bounds.");if(Y.utcOffset!==void 0&&Y.timezone)throw Error("CronOptions: Combining 'utcOffset' with 'timezone' is not allowed.")}if(Y.unref!==!0&&Y.unref!==!1)throw Error("CronOptions: Unref should be either true, false or undefined(false).");return Y}var N9=[31,28,31,30,31,30,31,31,30,31,30,31],cX=[["month","year",0],["day","month",-1],["hour","day",0],["minute","hour",0],["second","minute",0]];function K1(Y,X){if(this.tz=X,Y&&Y instanceof Date)if(!isNaN(Y))this.fromDate(Y);else throw TypeError("CronDate: Invalid date passed to CronDate constructor");else if(Y===void 0)this.fromDate(new Date);else if(Y&&typeof Y==="string")this.fromString(Y);else if(Y instanceof K1)this.fromCronDate(Y);else throw TypeError("CronDate: Invalid type ("+typeof Y+") passed to CronDate constructor")}K1.prototype.fromDate=function(Y){if(this.tz!==void 0)if(typeof this.tz==="number")this.ms=Y.getUTCMilliseconds(),this.second=Y.getUTCSeconds(),this.minute=Y.getUTCMinutes()+this.tz,this.hour=Y.getUTCHours(),this.day=Y.getUTCDate(),this.month=Y.getUTCMonth(),this.year=Y.getUTCFullYear(),this.apply();else{let X=ZY.toTZ(Y,this.tz);this.ms=Y.getMilliseconds(),this.second=X.s,this.minute=X.i,this.hour=X.h,this.day=X.d,this.month=X.m-1,this.year=X.y}else this.ms=Y.getMilliseconds(),this.second=Y.getSeconds(),this.minute=Y.getMinutes(),this.hour=Y.getHours(),this.day=Y.getDate(),this.month=Y.getMonth(),this.year=Y.getFullYear()};K1.prototype.fromCronDate=function(Y){this.tz=Y.tz,this.year=Y.year,this.month=Y.month,this.day=Y.day,this.hour=Y.hour,this.minute=Y.minute,this.second=Y.second,this.ms=Y.ms};K1.prototype.apply=function(){if(this.month>11||this.day>N9[this.month]||this.hour>59||this.minute>59||this.second>59||this.hour<0||this.minute<0||this.second<0){let Y=new Date(Date.UTC(this.year,this.month,this.day,this.hour,this.minute,this.second,this.ms));return this.ms=Y.getUTCMilliseconds(),this.second=Y.getUTCSeconds(),this.minute=Y.getUTCMinutes(),this.hour=Y.getUTCHours(),this.day=Y.getUTCDate(),this.month=Y.getUTCMonth(),this.year=Y.getUTCFullYear(),!0}else return!1};K1.prototype.fromString=function(Y){return this.fromDate(ZY.fromTZISO(Y,this.tz))};K1.prototype.findNext=function(Y,X,$,Q){let Z=this[X],W;if($.lastDayOfMonth||$.lastWeekdayOfMonth)if(this.month!==1)W=N9[this.month];else W=new Date(Date.UTC(this.year,this.month+1,0,0,0,0,0)).getUTCDate();let J=!$.starDOW&&X=="day"?new Date(Date.UTC(this.year,this.month,1,0,0,0,0)).getUTCDay():void 0;for(let M=this[X]+Q;M<$[X].length;M++){let N=$[X][M];if(X==="day"&&$.lastDayOfMonth&&M-Q==W)N=!0;if(X==="day"&&!$.starDOW){let U=$.dayOfWeek[(J+(M-Q-1))%7];if(U&&$.lastWeekdayOfMonth)U=U&&M-Q>W-7;if(Y.legacyMode&&!$.starDOM)N=N||U;else N=N&&U}if(N)return this[X]=M-Q,Z!==this[X]?2:1}return 3};K1.prototype.recurse=function(Y,X,$){let Q=this.findNext(X,cX[$][0],Y,cX[$][2]);if(Q>1){let Z=$+1;while(Z<cX.length)this[cX[Z][0]]=-cX[Z][2],Z++;if(Q===3)return this[cX[$][1]]++,this[cX[$][0]]=-cX[$][2],this.apply(),this.recurse(Y,X,0);else if(this.apply())return this.recurse(Y,X,$-1)}if($+=1,$>=cX.length)return this;else if(this.year>=3000)return null;else return this.recurse(Y,X,$)};K1.prototype.increment=function(Y,X,$){return this.second+=X.interval>1&&$?X.interval:1,this.ms=0,this.apply(),this.recurse(Y,X,0)};K1.prototype.getDate=function(Y){if(Y||this.tz===void 0)return new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.ms);else if(typeof this.tz==="number")return new Date(Date.UTC(this.year,this.month,this.day,this.hour,this.minute-this.tz,this.second,this.ms));else return ZY(this.year,this.month+1,this.day,this.hour,this.minute,this.second,this.tz)};K1.prototype.getTime=function(){return this.getDate().getTime()};function QX(Y,X){this.pattern=Y,this.timezone=X,this.second=Array(60).fill(0),this.minute=Array(60).fill(0),this.hour=Array(24).fill(0),this.day=Array(31).fill(0),this.month=Array(12).fill(0),this.dayOfWeek=Array(8).fill(0),this.lastDayOfMonth=!1,this.lastWeekdayOfMonth=!1,this.starDOM=!1,this.starDOW=!1,this.parse()}QX.prototype.parse=function(){if(!(typeof this.pattern==="string"||this.pattern.constructor===String))throw TypeError("CronPattern: Pattern has to be of type string.");if(this.pattern.indexOf("@")>=0)this.pattern=this.handleNicknames(this.pattern).trim();let Y=this.pattern.replace(/\s+/g," ").split(" ");if(Y.length<5||Y.length>6)throw TypeError("CronPattern: invalid configuration format ('"+this.pattern+"'), exacly five or six space separated parts required.");if(Y.length===5)Y.unshift("0");if(Y[3].indexOf("L")>=0)Y[3]=Y[3].replace("L",""),this.lastDayOfMonth=!0;if(Y[5].indexOf("L")>=0)Y[5]=Y[5].replace("L",""),this.lastWeekdayOfMonth=!0;if(Y[3]=="*")this.starDOM=!0;if(Y[4].length>=3)Y[4]=this.replaceAlphaMonths(Y[4]);if(Y[5].length>=3)Y[5]=this.replaceAlphaDays(Y[5]);if(Y[5]=="*")this.starDOW=!0;if(this.pattern.indexOf("?")>=0){let X=new K1(new Date,this.timezone).getDate(!0);if(Y[0]=Y[0].replace("?",X.getSeconds()),Y[1]=Y[1].replace("?",X.getMinutes()),Y[2]=Y[2].replace("?",X.getHours()),!this.starDOM)Y[3]=Y[3].replace("?",X.getDate());if(Y[4]=Y[4].replace("?",X.getMonth()+1),!this.starDOW)Y[5]=Y[5].replace("?",X.getDay())}if(this.throwAtIllegalCharacters(Y),this.partToArray("second",Y[0],0),this.partToArray("minute",Y[1],0),this.partToArray("hour",Y[2],0),this.partToArray("day",Y[3],-1),this.partToArray("month",Y[4],-1),this.partToArray("dayOfWeek",Y[5],0),this.dayOfWeek[7])this.dayOfWeek[0]=1};QX.prototype.partToArray=function(Y,X,$){let Q=this[Y];if(X==="*")return Q.fill(1);let Z=X.split(",");if(Z.length>1)for(let W=0;W<Z.length;W++)this.partToArray(Y,Z[W],$);else if(X.indexOf("-")!==-1&&X.indexOf("/")!==-1)this.handleRangeWithStepping(X,Y,$);else if(X.indexOf("-")!==-1)this.handleRange(X,Y,$);else if(X.indexOf("/")!==-1)this.handleStepping(X,Y,$);else if(X!=="")this.handleNumber(X,Y,$)};QX.prototype.throwAtIllegalCharacters=function(Y){let X=/[^/*0-9,-]+/;for(let $=0;$<Y.length;$++)if(X.test(Y[$]))throw TypeError("CronPattern: configuration entry "+$+" ("+Y[$]+") contains illegal characters.")};QX.prototype.handleNumber=function(Y,X,$){let Q=parseInt(Y,10)+$;if(isNaN(Q))throw TypeError("CronPattern: "+X+" is not a number: '"+Y+"'");if(Q<0||Q>=this[X].length)throw TypeError("CronPattern: "+X+" value out of range: '"+Y+"'");this[X][Q]=1};QX.prototype.handleRangeWithStepping=function(Y,X,$){let Q=Y.match(/^(\d+)-(\d+)\/(\d+)$/);if(Q===null)throw TypeError("CronPattern: Syntax error, illegal range with stepping: '"+Y+"'");let[,Z,W,J]=Q;if(Z=parseInt(Z,10)+$,W=parseInt(W,10)+$,J=parseInt(J,10),isNaN(Z))throw TypeError("CronPattern: Syntax error, illegal lower range (NaN)");if(isNaN(W))throw TypeError("CronPattern: Syntax error, illegal upper range (NaN)");if(isNaN(J))throw TypeError("CronPattern: Syntax error, illegal stepping: (NaN)");if(J===0)throw TypeError("CronPattern: Syntax error, illegal stepping: 0");if(J>this[X].length)throw TypeError("CronPattern: Syntax error, steps cannot be greater than maximum value of part ("+this[X].length+")");if(Z<0||W>=this[X].length)throw TypeError("CronPattern: Value out of range: '"+Y+"'");if(Z>W)throw TypeError("CronPattern: From value is larger than to value: '"+Y+"'");for(let M=Z;M<=W;M+=J)this[X][M]=1};QX.prototype.handleRange=function(Y,X,$){let Q=Y.split("-");if(Q.length!==2)throw TypeError("CronPattern: Syntax error, illegal range: '"+Y+"'");let Z=parseInt(Q[0],10)+$,W=parseInt(Q[1],10)+$;if(isNaN(Z))throw TypeError("CronPattern: Syntax error, illegal lower range (NaN)");else if(isNaN(W))throw TypeError("CronPattern: Syntax error, illegal upper range (NaN)");if(Z<0||W>=this[X].length)throw TypeError("CronPattern: Value out of range: '"+Y+"'");if(Z>W)throw TypeError("CronPattern: From value is larger than to value: '"+Y+"'");for(let J=Z;J<=W;J++)this[X][J]=1};QX.prototype.handleStepping=function(Y,X){let $=Y.split("/");if($.length!==2)throw TypeError("CronPattern: Syntax error, illegal stepping: '"+Y+"'");let Q=0;if($[0]!=="*")Q=parseInt($[0],10);let Z=parseInt($[1],10);if(isNaN(Z))throw TypeError("CronPattern: Syntax error, illegal stepping: (NaN)");if(Z===0)throw TypeError("CronPattern: Syntax error, illegal stepping: 0");if(Z>this[X].length)throw TypeError("CronPattern: Syntax error, max steps for part is ("+this[X].length+")");for(let W=Q;W<this[X].length;W+=Z)this[X][W]=1};QX.prototype.replaceAlphaDays=function(Y){return Y.replace(/-sun/gi,"-7").replace(/sun/gi,"0").replace(/mon/gi,"1").replace(/tue/gi,"2").replace(/wed/gi,"3").replace(/thu/gi,"4").replace(/fri/gi,"5").replace(/sat/gi,"6")};QX.prototype.replaceAlphaMonths=function(Y){return Y.replace(/jan/gi,"1").replace(/feb/gi,"2").replace(/mar/gi,"3").replace(/apr/gi,"4").replace(/may/gi,"5").replace(/jun/gi,"6").replace(/jul/gi,"7").replace(/aug/gi,"8").replace(/sep/gi,"9").replace(/oct/gi,"10").replace(/nov/gi,"11").replace(/dec/gi,"12")};QX.prototype.handleNicknames=function(Y){let X=Y.trim().toLowerCase();if(X==="@yearly"||X==="@annually")return"0 0 1 1 *";else if(X==="@monthly")return"0 0 1 * *";else if(X==="@weekly")return"0 0 * * 0";else if(X==="@daily")return"0 0 * * *";else if(X==="@hourly")return"0 * * * *";else return Y};function HZ(Y){return Object.prototype.toString.call(Y)==="[object Function]"||typeof Y==="function"||Y instanceof Function}function ZS(Y){if(typeof Deno<"u"&&typeof Deno.unrefTimer<"u")Deno.unrefTimer(Y);else if(Y&&typeof Y.unref<"u")Y.unref()}var M9=30000,_$=[];function i0(Y,X,$){if(!(this instanceof i0))return new i0(Y,X,$);let Q,Z;if(HZ(X))Z=X;else if(typeof X==="object")Q=X;else if(X!==void 0)throw Error("Cron: Invalid argument passed for optionsIn. Should be one of function, or object (options).");if(HZ($))Z=$;else if(typeof $==="object")Q=$;else if($!==void 0)throw Error("Cron: Invalid argument passed for funcIn. Should be one of function, or object (options).");if(this.name=Q?Q.name:void 0,this.options=QS(Q),this._states={kill:!1,blocking:!1,previousRun:void 0,currentRun:void 0,once:void 0,currentTimeout:void 0,maxRuns:Q?Q.maxRuns:void 0,paused:Q?Q.paused:!1,pattern:void 0},Y&&(Y instanceof Date||typeof Y==="string"&&Y.indexOf(":")>0))this._states.once=new K1(Y,this.options.timezone||this.options.utcOffset);else this._states.pattern=new QX(Y,this.options.timezone);if(this.name)if(_$.find((J)=>J.name===this.name))throw Error("Cron: Tried to initialize new named job '"+this.name+"', but name already taken.");else _$.push(this);if(Z!==void 0)this.fn=Z,this.schedule();return this}i0.prototype.nextRun=function(Y){let X=this._next(Y);return X?X.getDate():null};i0.prototype.nextRuns=function(Y,X){if(Y>this._states.maxRuns)Y=this._states.maxRuns;let $=[],Q=X||this._states.currentRun;while(Y--&&(Q=this.nextRun(Q)))$.push(Q);return $};i0.prototype.getPattern=function(){return this._states.pattern?this._states.pattern.pattern:void 0};i0.prototype.isRunning=function(){let Y=this.msToNext(this._states.currentRun),X=!this._states.paused,$=this.fn!==void 0,Q=!this._states.kill;return X&&$&&Q&&Y!==null};i0.prototype.isStopped=function(){return this._states.kill};i0.prototype.isBusy=function(){return this._states.blocking};i0.prototype.currentRun=function(){return this._states.currentRun?this._states.currentRun.getDate():null};i0.prototype.previousRun=function(){return this._states.previousRun?this._states.previousRun.getDate():null};i0.prototype.msToNext=function(Y){let X=this._next(Y);if(Y=new K1(Y,this.options.timezone||this.options.utcOffset),X)return X.getTime(!0)-Y.getTime(!0);else return null};i0.prototype.stop=function(){if(this._states.kill=!0,this._states.currentTimeout)clearTimeout(this._states.currentTimeout);let Y=_$.indexOf(this);if(Y>=0)_$.splice(Y,1)};i0.prototype.pause=function(){return this._states.paused=!0,!this._states.kill};i0.prototype.resume=function(){return this._states.paused=!1,!this._states.kill};i0.prototype.schedule=function(Y,X){if(Y&&this.fn)throw Error("Cron: It is not allowed to schedule two functions using the same Croner instance.");else if(Y)this.fn=Y;let $=this.msToNext(X?X:this._states.currentRun),Q=this.nextRun(X?X:this._states.currentRun);if($===null||Q===null)return this;if($>M9)$=M9;if(this._states.currentTimeout=setTimeout(()=>this._checkTrigger(Q),$),this._states.currentTimeout&&this.options.unref)ZS(this._states.currentTimeout);return this};i0.prototype._trigger=async function(Y){if(this._states.blocking=!0,this._states.currentRun=new K1(void 0,this.options.timezone||this.options.utcOffset),this.options.catch)try{await this.fn(this,this.options.context)}catch(X){if(HZ(this.options.catch))this.options.catch(X,this)}else await this.fn(this,this.options.context);this._states.previousRun=new K1(Y,this.options.timezone||this.options.utcOffset),this._states.blocking=!1};i0.prototype.trigger=async function(){await this._trigger()};i0.prototype._checkTrigger=function(Y){let X=new Date,$=!this._states.paused&&X.getTime()>=Y,Q=this._states.blocking&&this.options.protect;if($&&!Q)this._states.maxRuns--,this._trigger();else if($&&Q&&HZ(this.options.protect))setTimeout(()=>this.options.protect(this),0);this.schedule(void 0,X)};i0.prototype._next=function(Y){let X=Y||this._states.currentRun?!0:!1;if(Y=new K1(Y,this.options.timezone||this.options.utcOffset),this.options.startAt&&Y&&Y.getTime()<this.options.startAt.getTime())Y=this.options.startAt;let $=this._states.once||new K1(Y,this.options.timezone||this.options.utcOffset).increment(this._states.pattern,this.options,X);if(this._states.once&&this._states.once.getTime()<=Y.getTime())return null;else if($===null||this._states.maxRuns<=0||this._states.kill||this.options.stopAt&&$.getTime()>=this.options.stopAt.getTime())return null;else return $};i0.Cron=i0;i0.scheduledJobs=_$;var G9=((Y)=>{return Y[Y.SUNDAY=0]="SUNDAY",Y[Y.MONDAY=1]="MONDAY",Y[Y.TUESDAY=2]="TUESDAY",Y[Y.WEDNESDAY=3]="WEDNESDAY",Y[Y.THURSDAY=4]="THURSDAY",Y[Y.FRIDAY=5]="FRIDAY",Y[Y.SATURDAY=6]="SATURDAY",Y})(G9||{}),U9=((Y)=>{return Y.EVERY_SECOND="* * * * * *",Y.EVERY_5_SECONDS="*/5 * * * * *",Y.EVERY_10_SECONDS="*/10 * * * * *",Y.EVERY_30_SECONDS="*/30 * * * * *",Y.EVERY_MINUTE="*/1 * * * *",Y.EVERY_5_MINUTES="0 */5 * * * *",Y.EVERY_10_MINUTES="0 */10 * * * *",Y.EVERY_30_MINUTES="0 */30 * * * *",Y.EVERY_HOUR="0 0-23/1 * * *",Y.EVERY_2_HOURS="0 0-23/2 * * *",Y.EVERY_3_HOURS="0 0-23/3 * * *",Y.EVERY_4_HOURS="0 0-23/4 * * *",Y.EVERY_5_HOURS="0 0-23/5 * * *",Y.EVERY_6_HOURS="0 0-23/6 * * *",Y.EVERY_7_HOURS="0 0-23/7 * * *",Y.EVERY_8_HOURS="0 0-23/8 * * *",Y.EVERY_9_HOURS="0 0-23/9 * * *",Y.EVERY_10_HOURS="0 0-23/10 * * *",Y.EVERY_11_HOURS="0 0-23/11 * * *",Y.EVERY_12_HOURS="0 0-23/12 * * *",Y.EVERY_DAY_AT_1AM="0 01 * * *",Y.EVERY_DAY_AT_2AM="0 02 * * *",Y.EVERY_DAY_AT_3AM="0 03 * * *",Y.EVERY_DAY_AT_4AM="0 04 * * *",Y.EVERY_DAY_AT_5AM="0 05 * * *",Y.EVERY_DAY_AT_6AM="0 06 * * *",Y.EVERY_DAY_AT_7AM="0 07 * * *",Y.EVERY_DAY_AT_8AM="0 08 * * *",Y.EVERY_DAY_AT_9AM="0 09 * * *",Y.EVERY_DAY_AT_10AM="0 10 * * *",Y.EVERY_DAY_AT_11AM="0 11 * * *",Y.EVERY_DAY_AT_NOON="0 12 * * *",Y.EVERY_DAY_AT_1PM="0 13 * * *",Y.EVERY_DAY_AT_2PM="0 14 * * *",Y.EVERY_DAY_AT_3PM="0 15 * * *",Y.EVERY_DAY_AT_4PM="0 16 * * *",Y.EVERY_DAY_AT_5PM="0 17 * * *",Y.EVERY_DAY_AT_6PM="0 18 * * *",Y.EVERY_DAY_AT_7PM="0 19 * * *",Y.EVERY_DAY_AT_8PM="0 20 * * *",Y.EVERY_DAY_AT_9PM="0 21 * * *",Y.EVERY_DAY_AT_10PM="0 22 * * *",Y.EVERY_DAY_AT_11PM="0 23 * * *",Y.EVERY_DAY_AT_MIDNIGHT="0 0 * * *",Y.EVERY_WEEK="0 0 * * 0",Y.EVERY_WEEKDAY="0 0 * * 1-5",Y.EVERY_WEEKEND="0 0 * * 6,0",Y.EVERY_1ST_DAY_OF_MONTH_AT_MIDNIGHT="0 0 1 * *",Y.EVERY_1ST_DAY_OF_MONTH_AT_NOON="0 12 1 * *",Y.EVERY_2ND_HOUR="0 */2 * * *",Y.EVERY_2ND_HOUR_FROM_1AM_THROUGH_11PM="0 1-23/2 * * *",Y.EVERY_2ND_MONTH="0 0 1 */2 *",Y.EVERY_QUARTER="0 0 1 */3 *",Y.EVERY_6_MONTHS="0 0 1 */6 *",Y.EVERY_YEAR="0 0 1 1 *",Y.EVERY_30_MINUTES_BETWEEN_9AM_AND_5PM="0 */30 9-17 * * *",Y.EVERY_30_MINUTES_BETWEEN_9AM_AND_6PM="0 */30 9-18 * * *",Y.EVERY_30_MINUTES_BETWEEN_10AM_AND_7PM="0 */30 10-19 * * *",Y})(U9||{}),WS={everySeconds(Y=1){return`*/${Y} * * * * *`},everyMinutes(Y=1){return`0 */${Y} * * * *`},everyHours(Y=1){return`0 0-23/${Y} * * *`},everyHoursAt(Y,X=0){return`${X} 0-23/${Y} * * *`},everyDayAt(Y="00:00"){let[X,$]=Y.split(":");return`${$} ${X} * * *`},everyWeekOn(Y,X="00:00"){let[$,Q]=X.split(":");return`${Q} ${$} * * ${Y}`},everyWeekdayAt(Y="00:00"){let[X,$]=Y.split(":");return`${$} ${X} * * 1-5`},everyWeekendAt(Y="00:00"){let[X,$]=Y.split(":");return`${$} ${X} * * 6,0`},everySecond(){return"* * * * * *"},everyMinute(){return"*/1 * * * *"},hourly(){return"0 0-23/1 * * *"},daily(){return"0 0 * * *"},everyWeekday(){return"0 0 * * 1-5"},everyWeekend(){return"0 0 * * 6,0"},weekly(){return"0 0 * * 0"},monthly(){return"0 0 1 * *"},everyQuarter(){return"0 0 1 */3 *"},yearly(){return"0 0 1 1 *"}},B9={...WS,...G9,...U9},JS=({pattern:Y,name:X,run:$,...Q})=>(Z)=>{if(!Y)throw Error("pattern is required");if(!X)throw Error("name is required");return Z.state((W)=>{let J=Z.singleton.store?.cron??{};return{...W,cron:{...J,[X]:new i0(Y,Q,()=>$(Z.singleton.store))}}})},A9=JS;var H9=w.Object({anime_id:w.Number(),name:w.String(),slug:w.String(),img_url:w.String(),last_episode:w.Number()}),K4=w.Object({error:w.String()});var S4={async getHistory(){return await $0`SELECT anime_id,name,slug,img_url,last_episode FROM activity_history ORDER BY updated_at DESC`},async insertOrUpdateHistory(Y,X,$,Q,Z){await $0`INSERT INTO activity_history (id,user_id,anime_id,name,slug,img_url,last_episode,updated_at) values(${Bun.randomUUIDv7()},1,${Y},${$},${Q},${Z},${X},datetime('now')) ON CONFLICT(user_id, anime_id) DO UPDATE SET last_episode = ${X}, img_url = ${Z}, updated_at = datetime('now')`}};var z9=new B1({prefix:"/history"}).get("/",async({status:Y})=>{try{let X=await S4.getHistory();if(X.length===0)return Y(404,{error:"Not Found"});return Y(200,X)}catch(X){throw Y(500,{error:"Internal Server Error"})}},{response:{200:w.Array(H9),404:K4,500:K4}}).post("/add/:cap/:id",async({body:{name:Y,slug:X,imgUrl:$,watched:Q,seconds:Z},status:W,params:{cap:J,id:M}})=>{try{if((await $0`SELECT * FROM history WHERE user_id = 1 AND anime_id = ${M}`).length==0)return await g0.insertOrUpdateHistory(M,J,1,0,!1),W(200,{success:!0});return await g0.insertOrUpdateHistory(M,J,1,Z,Q),await S4.insertOrUpdateHistory(M,J,Y,X,$),W(200,{success:!0})}catch{throw W(500,{error:"Internal Server Error"})}},{body:w.Object({name:w.String(),slug:w.String(),imgUrl:w.String(),watched:w.Boolean(),seconds:w.Number()}),params:w.Object({cap:w.Number(),id:w.Number()})}).put("/toggle/watched",async({body:Y,status:X})=>{let{cap:$,anime_id:Q,watched:Z}=Y;try{return await g0.insertOrUpdateHistory(Q,$,1,0,Z),X(214,{success:!0,message:"Estado actualizado"})}catch(W){throw X(500,{error:"Internal Server Error"})}},{body:w.Object({anime_id:w.Number(),cap:w.Number(),watched:w.Boolean()}),response:{214:w.Object({success:w.Boolean(),message:w.String()}),500:w.Object({error:w.String()})}});var{randomUUIDv7:MS}=globalThis.Bun;function q9(Y,X,$){let Q={},Z=Object.keys($.properties);for(let W=0;W<Z.length;W++)Q[Z[W]]=Y[X[W]];return Q}var E$=w.Object({id:w.Number(),name:w.String(),slug:w.String(),imgUrl:w.String()}),V$=w.Object({error:w.String()});var NS=["anime_id","name","slug","img_url"],zZ={async get(){return(await $0`
      SELECT anime_id, name, slug, img_url
      FROM favorites
      ORDER BY updated_at DESC
    `).map((X)=>q9(X,NS,E$))},async create(Y){let{id:X,name:$,slug:Q,imgUrl:Z}=Y;await $0`INSERT INTO favorites (id,user_id,anime_id, name, slug, img_url) VALUES (${MS()},"1", ${X}, ${$}, ${Q}, ${Z}) `},async delete(Y){return await $0`DELETE FROM favorites WHERE anime_id = ${Y}`}};var O9=new B1({prefix:"/favorite"}).get("/",async({status:Y})=>{try{let X=await zZ.get();if(!X)throw Y(404,{error:"Not Found"});return X}catch(X){throw Y(500,{error:"Server Error"})}},{response:{200:w.Array(E$),404:V$,500:V$}}).post("/",async({body:Y,status:X})=>{try{return await zZ.create(Y),X(201,{success:!0,message:"Favorite created"})}catch($){throw X(500,{error:"Server Error"})}},{body:E$,response:{201:w.Object({success:w.Boolean(),message:w.String()}),400:V$,500:V$}}).delete("/:id",async({status:Y,params:{id:X}})=>{try{return await zZ.delete(X),Y(204)}catch($){throw Y(500)}},{params:w.Object({id:w.Number()})});var D9=new B1().use(J9()).onRequest(({request:Y})=>{console.log(`[${new Date().toISOString()}] ${Y.method} ${Y.url}`)}).use(w4).use(z9).use(O9).use(A9({name:"clearCache",pattern:B9.EVERY_10_MINUTES,async run(Y){if(Boolean((await $0`SELECT EXISTS(SELECT 1 FROM cache)`.values())[0][0]))await $0`DELETE FROM cache WHERE createdAt <= datetime('now', '-5 minutes')`}}));console.log("Server running at http://localhost:3000");import UP from"os";var T4=JY(K9(),1);var ZX=Object.create(null);ZX.open="0";ZX.close="1";ZX.ping="2";ZX.pong="3";ZX.message="4";ZX.upgrade="5";ZX.noop="6";var I$=Object.create(null);Object.keys(ZX).forEach((Y)=>{I$[ZX[Y]]=Y});var T$={type:"error",data:"parser error"};var x$=({type:Y,data:X},$,Q)=>{if(X instanceof ArrayBuffer||ArrayBuffer.isView(X))return Q($?X:"b"+S9(X,!0).toString("base64"));return Q(ZX[Y]+(X||""))},S9=(Y,X)=>{if(Buffer.isBuffer(Y)||Y instanceof Uint8Array&&!X)return Y;else if(Y instanceof ArrayBuffer)return Buffer.from(Y);else return Buffer.from(Y.buffer,Y.byteOffset,Y.byteLength)},F4;function P9(Y,X){if(Y.data instanceof ArrayBuffer||ArrayBuffer.isView(Y.data))return X(S9(Y.data,!1));x$(Y,!0,($)=>{if(!F4)F4=new TextEncoder;X(F4.encode($))})}var b$=(Y,X)=>{if(typeof Y!=="string")return{type:"message",data:F9(Y,X)};let $=Y.charAt(0);if($==="b"){let Q=Buffer.from(Y.substring(1),"base64");return{type:"message",data:F9(Q,X)}}if(!I$[$])return T$;return Y.length>1?{type:I$[$],data:Y.substring(1)}:{type:I$[$]}},F9=(Y,X)=>{switch(X){case"arraybuffer":if(Y instanceof ArrayBuffer)return Y;else if(Buffer.isBuffer(Y))return Y.buffer.slice(Y.byteOffset,Y.byteOffset+Y.byteLength);else return Y.buffer;case"nodebuffer":default:if(Buffer.isBuffer(Y))return Y;else return Buffer.from(Y)}};var C9=String.fromCharCode(30),R9=(Y,X)=>{let $=Y.length,Q=Array($),Z=0;Y.forEach((W,J)=>{x$(W,!1,(M)=>{if(Q[J]=M,++Z===$)X(Q.join(C9))})})},j9=(Y,X)=>{let $=Y.split(C9),Q=[];for(let Z=0;Z<$.length;Z++){let W=b$($[Z],X);if(Q.push(W),W.type==="error")break}return Q};function _9(){return new TransformStream({transform(Y,X){P9(Y,($)=>{let Q=$.length,Z;if(Q<126)Z=new Uint8Array(1),new DataView(Z.buffer).setUint8(0,Q);else if(Q<65536){Z=new Uint8Array(3);let W=new DataView(Z.buffer);W.setUint8(0,126),W.setUint16(1,Q)}else{Z=new Uint8Array(9);let W=new DataView(Z.buffer);W.setUint8(0,127),W.setBigUint64(1,BigInt(Q))}if(Y.data&&typeof Y.data!=="string")Z[0]|=128;X.enqueue(Z),X.enqueue($)})}})}var C4;function qZ(Y){return Y.reduce((X,$)=>X+$.length,0)}function OZ(Y,X){if(Y[0].length===X)return Y.shift();let $=new Uint8Array(X),Q=0;for(let Z=0;Z<X;Z++)if($[Z]=Y[0][Q++],Q===Y[0].length)Y.shift(),Q=0;if(Y.length&&Q<Y[0].length)Y[0]=Y[0].slice(Q);return $}function E9(Y,X){if(!C4)C4=new TextDecoder;let $=[],Q=0,Z=-1,W=!1;return new TransformStream({transform(J,M){$.push(J);while(!0){if(Q===0){if(qZ($)<1)break;let N=OZ($,1);if(W=(N[0]&128)===128,Z=N[0]&127,Z<126)Q=3;else if(Z===126)Q=1;else Q=2}else if(Q===1){if(qZ($)<2)break;let N=OZ($,2);Z=new DataView(N.buffer,N.byteOffset,N.length).getUint16(0),Q=3}else if(Q===2){if(qZ($)<8)break;let N=OZ($,8),U=new DataView(N.buffer,N.byteOffset,N.length),G=U.getUint32(0);if(G>Math.pow(2,21)-1){M.enqueue(T$);break}Z=G*Math.pow(2,32)+U.getUint32(4),Q=3}else{if(qZ($)<Z)break;let N=OZ($,Z);M.enqueue(b$(W?N:C4.decode(N),X)),Q=0}if(Z===0||Z>Y){M.enqueue(T$);break}}}})}var R4=4;function k0(Y){if(Y)return US(Y)}function US(Y){for(var X in k0.prototype)Y[X]=k0.prototype[X];return Y}k0.prototype.on=k0.prototype.addEventListener=function(Y,X){return this._callbacks=this._callbacks||{},(this._callbacks["$"+Y]=this._callbacks["$"+Y]||[]).push(X),this};k0.prototype.once=function(Y,X){function $(){this.off(Y,$),X.apply(this,arguments)}return $.fn=X,this.on(Y,$),this};k0.prototype.off=k0.prototype.removeListener=k0.prototype.removeAllListeners=k0.prototype.removeEventListener=function(Y,X){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var $=this._callbacks["$"+Y];if(!$)return this;if(arguments.length==1)return delete this._callbacks["$"+Y],this;var Q;for(var Z=0;Z<$.length;Z++)if(Q=$[Z],Q===X||Q.fn===X){$.splice(Z,1);break}if($.length===0)delete this._callbacks["$"+Y];return this};k0.prototype.emit=function(Y){this._callbacks=this._callbacks||{};var X=Array(arguments.length-1),$=this._callbacks["$"+Y];for(var Q=1;Q<arguments.length;Q++)X[Q-1]=arguments[Q];if($){$=$.slice(0);for(var Q=0,Z=$.length;Q<Z;++Q)$[Q].apply(this,X)}return this};k0.prototype.emitReserved=k0.prototype.emit;k0.prototype.listeners=function(Y){return this._callbacks=this._callbacks||{},this._callbacks["$"+Y]||[]};k0.prototype.hasListeners=function(Y){return!!this.listeners(Y).length};var pX=process.nextTick,i1=global,V9="nodebuffer";function I9(){return new T9}function BS(Y){let X=Y.split("; "),$=X[0].indexOf("=");if($===-1)return;let Q=X[0].substring(0,$).trim();if(!Q.length)return;let Z=X[0].substring($+1).trim();if(Z.charCodeAt(0)===34)Z=Z.slice(1,-1);let W={name:Q,value:Z};for(let J=1;J<X.length;J++){let M=X[J].split("=");if(M.length!==2)continue;let N=M[0].trim(),U=M[1].trim();switch(N){case"Expires":W.expires=new Date(U);break;case"Max-Age":let G=new Date;G.setUTCSeconds(G.getUTCSeconds()+parseInt(U,10)),W.expires=G;break;default:}}return W}class T9{constructor(){this._cookies=new Map}parseCookies(Y){if(!Y)return;Y.forEach((X)=>{let $=BS(X);if($)this._cookies.set($.name,$)})}get cookies(){let Y=Date.now();return this._cookies.forEach((X,$)=>{var Q;if(((Q=X.expires)===null||Q===void 0?void 0:Q.getTime())<Y)this._cookies.delete($)}),this._cookies.entries()}addCookies(Y){let X=[];for(let[$,Q]of this.cookies)X.push(`${$}=${Q.value}`);if(X.length)Y.setDisableHeaderCheck(!0),Y.setRequestHeader("cookie",X.join("; "))}appendCookies(Y){for(let[X,$]of this.cookies)Y.append("cookie",`${X}=${$.value}`)}}function DZ(Y,...X){return X.reduce(($,Q)=>{if(Y.hasOwnProperty(Q))$[Q]=Y[Q];return $},{})}var AS=i1.setTimeout,HS=i1.clearTimeout;function iX(Y,X){if(X.useNativeTimers)Y.setTimeoutFn=AS.bind(i1),Y.clearTimeoutFn=HS.bind(i1);else Y.setTimeoutFn=i1.setTimeout.bind(i1),Y.clearTimeoutFn=i1.clearTimeout.bind(i1)}var zS=1.33;function x9(Y){if(typeof Y==="string")return qS(Y);return Math.ceil((Y.byteLength||Y.size)*zS)}function qS(Y){let X=0,$=0;for(let Q=0,Z=Y.length;Q<Z;Q++)if(X=Y.charCodeAt(Q),X<128)$+=1;else if(X<2048)$+=2;else if(X<55296||X>=57344)$+=3;else Q++,$+=4;return $}function wZ(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function b9(Y){let X="";for(let $ in Y)if(Y.hasOwnProperty($)){if(X.length)X+="&";X+=encodeURIComponent($)+"="+encodeURIComponent(Y[$])}return X}function g9(Y){let X={},$=Y.split("&");for(let Q=0,Z=$.length;Q<Z;Q++){let W=$[Q].split("=");X[decodeURIComponent(W[0])]=decodeURIComponent(W[1])}return X}var u9=JY(xY(),1),iS=u9.default("engine.io-client:transport");class E4 extends Error{constructor(Y,X,$){super(Y);this.description=X,this.context=$,this.type="TransportError"}}class H8 extends k0{constructor(Y){super();this.writable=!1,iX(this,Y),this.opts=Y,this.query=Y.query,this.socket=Y.socket,this.supportsBinary=!Y.forceBase64}onError(Y,X,$){return super.emitReserved("error",new E4(Y,X,$)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){if(this.readyState==="opening"||this.readyState==="open")this.doClose(),this.onClose();return this}send(Y){if(this.readyState==="open")this.write(Y);else iS("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(Y){let X=b$(Y,this.socket.binaryType);this.onPacket(X)}onPacket(Y){super.emitReserved("packet",Y)}onClose(Y){this.readyState="closed",super.emitReserved("close",Y)}pause(Y){}createUri(Y,X={}){return Y+"://"+this._hostname()+this._port()+this.opts.path+this._query(X)}_hostname(){let Y=this.opts.hostname;return Y.indexOf(":")===-1?Y:"["+Y+"]"}_port(){if(this.opts.port&&(this.opts.secure&&Number(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80))return":"+this.opts.port;else return""}_query(Y){let X=b9(Y);return X.length?"?"+X:""}}var c9=JY(xY(),1),WX=c9.default("engine.io-client:polling");class FZ extends H8{constructor(){super(...arguments);this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(Y){this.readyState="pausing";let X=()=>{WX("paused"),this.readyState="paused",Y()};if(this._polling||!this.writable){let $=0;if(this._polling)WX("we are currently polling - waiting to pause"),$++,this.once("pollComplete",function(){WX("pre-pause polling complete"),--$||X()});if(!this.writable)WX("we are currently writing - waiting to pause"),$++,this.once("drain",function(){WX("pre-pause writing complete"),--$||X()})}else X()}_poll(){WX("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(Y){WX("polling got data %s",Y);let X=($)=>{if(this.readyState==="opening"&&$.type==="open")this.onOpen();if($.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket($)};if(j9(Y,this.socket.binaryType).forEach(X),this.readyState!=="closed")if(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open")this._poll();else WX('ignoring poll - transport state "%s"',this.readyState)}doClose(){let Y=()=>{WX("writing close packet"),this.write([{type:"close"}])};if(this.readyState==="open")WX("transport open - closing"),Y();else WX("transport not open - deferring close"),this.once("open",Y)}write(Y){this.writable=!1,R9(Y,(X)=>{this.doWrite(X,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let Y=this.opts.secure?"https":"http",X=this.query||{};if(this.opts.timestampRequests!==!1)X[this.opts.timestampParam]=wZ();if(!this.supportsBinary&&!X.sid)X.b64=1;return this.createUri(Y,X)}}var p9=!1;try{p9=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(Y){}var i9=p9;var n9=JY(xY(),1),V4=n9.default("engine.io-client:polling");function lS(){}class I4 extends FZ{constructor(Y){super(Y);if(typeof location<"u"){let X=location.protocol==="https:",$=location.port;if(!$)$=X?"443":"80";this.xd=typeof location<"u"&&Y.hostname!==location.hostname||$!==Y.port}}doWrite(Y,X){let $=this.request({method:"POST",data:Y});$.on("success",X),$.on("error",(Q,Z)=>{this.onError("xhr post error",Q,Z)})}doPoll(){V4("xhr poll");let Y=this.request();Y.on("data",this.onData.bind(this)),Y.on("error",(X,$)=>{this.onError("xhr poll error",X,$)}),this.pollXhr=Y}}class JX extends k0{constructor(Y,X,$){super();this.createRequest=Y,iX(this,$),this._opts=$,this._method=$.method||"GET",this._uri=X,this._data=$.data!==void 0?$.data:null,this._create()}_create(){var Y;let X=DZ(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");X.xdomain=!!this._opts.xd;let $=this._xhr=this.createRequest(X);try{V4("xhr open %s: %s",this._method,this._uri),$.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){$.setDisableHeaderCheck&&$.setDisableHeaderCheck(!0);for(let Q in this._opts.extraHeaders)if(this._opts.extraHeaders.hasOwnProperty(Q))$.setRequestHeader(Q,this._opts.extraHeaders[Q])}}catch(Q){}if(this._method==="POST")try{$.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(Q){}try{$.setRequestHeader("Accept","*/*")}catch(Q){}if((Y=this._opts.cookieJar)===null||Y===void 0||Y.addCookies($),"withCredentials"in $)$.withCredentials=this._opts.withCredentials;if(this._opts.requestTimeout)$.timeout=this._opts.requestTimeout;$.onreadystatechange=()=>{var Q;if($.readyState===3)(Q=this._opts.cookieJar)===null||Q===void 0||Q.parseCookies($.getResponseHeader("set-cookie"));if($.readyState!==4)return;if($.status===200||$.status===1223)this._onLoad();else this.setTimeoutFn(()=>{this._onError(typeof $.status==="number"?$.status:0)},0)},V4("xhr data %s",this._data),$.send(this._data)}catch(Q){this.setTimeoutFn(()=>{this._onError(Q)},0);return}if(typeof document<"u")this._index=JX.requestsCount++,JX.requests[this._index]=this}_onError(Y){this.emitReserved("error",Y,this._xhr),this._cleanup(!0)}_cleanup(Y){if(typeof this._xhr>"u"||this._xhr===null)return;if(this._xhr.onreadystatechange=lS,Y)try{this._xhr.abort()}catch(X){}if(typeof document<"u")delete JX.requests[this._index];this._xhr=null}_onLoad(){let Y=this._xhr.responseText;if(Y!==null)this.emitReserved("data",Y),this.emitReserved("success"),this._cleanup()}abort(){this._cleanup()}}JX.requestsCount=0;JX.requests={};if(typeof document<"u"){if(typeof attachEvent==="function")attachEvent("onunload",l9);else if(typeof addEventListener==="function"){let Y="onpagehide"in i1?"pagehide":"unload";addEventListener(Y,l9,!1)}}function l9(){for(let Y in JX.requests)if(JX.requests.hasOwnProperty(Y))JX.requests[Y].abort()}var ch=function(){let Y=nS({xdomain:!1});return Y&&Y.responseType!==null}();function nS(Y){let X=Y.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!X||i9))return new XMLHttpRequest}catch($){}if(!X)try{return new i1[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch($){}}var oS=T4.default||T4;class g$ extends I4{request(Y={}){var X;return Object.assign(Y,{xd:this.xd,cookieJar:(X=this.socket)===null||X===void 0?void 0:X._cookieJar},this.opts),new JX(($)=>new oS($),this.uri(),Y)}}import*as t9 from"ws";var o9=JY(xY(),1),tS=o9.default("engine.io-client:websocket"),rS=typeof navigator<"u"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";class x4 extends H8{get name(){return"websocket"}doOpen(){let Y=this.uri(),X=this.opts.protocols,$=rS?{}:DZ(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");if(this.opts.extraHeaders)$.headers=this.opts.extraHeaders;try{this.ws=this.createSocket(Y,X,$)}catch(Q){return this.emitReserved("error",Q)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{if(this.opts.autoUnref)this.ws._socket.unref();this.onOpen()},this.ws.onclose=(Y)=>this.onClose({description:"websocket connection closed",context:Y}),this.ws.onmessage=(Y)=>this.onData(Y.data),this.ws.onerror=(Y)=>this.onError("websocket error",Y)}write(Y){this.writable=!1;for(let X=0;X<Y.length;X++){let $=Y[X],Q=X===Y.length-1;x$($,this.supportsBinary,(Z)=>{try{this.doWrite($,Z)}catch(W){tS("websocket closed before onclose event")}if(Q)pX(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){if(typeof this.ws<"u")this.ws.onerror=()=>{},this.ws.close(),this.ws=null}uri(){let Y=this.opts.secure?"wss":"ws",X=this.query||{};if(this.opts.timestampRequests)X[this.opts.timestampParam]=wZ();if(!this.supportsBinary)X.b64=1;return this.createUri(Y,X)}}var sh=i1.WebSocket||i1.MozWebSocket;class k$ extends x4{createSocket(Y,X,$){var Q;if((Q=this.socket)===null||Q===void 0?void 0:Q._cookieJar){$.headers=$.headers||{},$.headers.cookie=typeof $.headers.cookie==="string"?[$.headers.cookie]:$.headers.cookie||[];for(let[Z,W]of this.socket._cookieJar.cookies)$.headers.cookie.push(`${Z}=${W.value}`)}return new t9.WebSocket(Y,X,$)}doWrite(Y,X){let $={};if(Y.options)$.compress=Y.options.compress;if(this.opts.perMessageDeflate){if((typeof X==="string"?Buffer.byteLength(X):X.length)<this.opts.perMessageDeflate.threshold)$.compress=!1}this.ws.send(X,$)}}var r9=JY(xY(),1),f$=r9.default("engine.io-client:webtransport");class y$ extends H8{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(Y){return this.emitReserved("error",Y)}this._transport.closed.then(()=>{f$("transport closed gracefully"),this.onClose()}).catch((Y)=>{f$("transport closed due to %s",Y),this.onError("webtransport error",Y)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then((Y)=>{let X=E9(Number.MAX_SAFE_INTEGER,this.socket.binaryType),$=Y.readable.pipeThrough(X).getReader(),Q=_9();Q.readable.pipeTo(Y.writable),this._writer=Q.writable.getWriter();let Z=()=>{$.read().then(({done:J,value:M})=>{if(J){f$("session is closed");return}f$("received chunk: %o",M),this.onPacket(M),Z()}).catch((J)=>{f$("an error occurred while reading: %s",J)})};Z();let W={type:"open"};if(this.query.sid)W.data=`{"sid":"${this.query.sid}"}`;this._writer.write(W).then(()=>this.onOpen())})})}write(Y){this.writable=!1;for(let X=0;X<Y.length;X++){let $=Y[X],Q=X===Y.length-1;this._writer.write($).then(()=>{if(Q)pX(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var Y;(Y=this._transport)===null||Y===void 0||Y.close()}}var b4={websocket:k$,webtransport:y$,polling:g$};var sS=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,aS=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function E6(Y){if(Y.length>8000)throw"URI too long";let X=Y,$=Y.indexOf("["),Q=Y.indexOf("]");if($!=-1&&Q!=-1)Y=Y.substring(0,$)+Y.substring($,Q).replace(/:/g,";")+Y.substring(Q,Y.length);let Z=sS.exec(Y||""),W={},J=14;while(J--)W[aS[J]]=Z[J]||"";if($!=-1&&Q!=-1)W.source=X,W.host=W.host.substring(1,W.host.length-1).replace(/;/g,":"),W.authority=W.authority.replace("[","").replace("]","").replace(/;/g,":"),W.ipv6uri=!0;return W.pathNames=eS(W,W.path),W.queryKey=YP(W,W.query),W}function eS(Y,X){let $=/\/{2,9}/g,Q=X.replace($,"/").split("/");if(X.slice(0,1)=="/"||X.length===0)Q.splice(0,1);if(X.slice(-1)=="/")Q.splice(Q.length-1,1);return Q}function YP(Y,X){let $={};return X.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(Q,Z,W){if(Z)$[Z]=W}),$}var s9=JY(xY(),1),V0=s9.default("engine.io-client:socket"),g4=typeof addEventListener==="function"&&typeof removeEventListener==="function",v$=[];if(g4)addEventListener("offline",()=>{V0("closing %d connection(s) because the network was lost",v$.length),v$.forEach((Y)=>Y())},!1);class lX extends k0{constructor(Y,X){super();if(this.binaryType=V9,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,Y&&typeof Y==="object")X=Y,Y=null;if(Y){let $=E6(Y);if(X.hostname=$.host,X.secure=$.protocol==="https"||$.protocol==="wss",X.port=$.port,$.query)X.query=$.query}else if(X.host)X.hostname=E6(X.host).host;if(iX(this,X),this.secure=X.secure!=null?X.secure:typeof location<"u"&&location.protocol==="https:",X.hostname&&!X.port)X.port=this.secure?"443":"80";if(this.hostname=X.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=X.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},X.transports.forEach(($)=>{let Q=$.prototype.name;this.transports.push(Q),this._transportsByName[Q]=$}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},X),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query==="string")this.opts.query=g9(this.opts.query);if(g4){if(this.opts.closeOnBeforeunload)this._beforeunloadEventListener=()=>{if(this.transport)this.transport.removeAllListeners(),this.transport.close()},addEventListener("beforeunload",this._beforeunloadEventListener,!1);if(this.hostname!=="localhost")V0("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},v$.push(this._offlineEventListener)}if(this.opts.withCredentials)this._cookieJar=I9();this._open()}createTransport(Y){V0('creating transport "%s"',Y);let X=Object.assign({},this.opts.query);if(X.EIO=R4,X.transport=Y,this.id)X.sid=this.id;let $=Object.assign({},this.opts,{query:X,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[Y]);return V0("options: %j",$),new this._transportsByName[Y]($)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let Y=this.opts.rememberUpgrade&&lX.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let X=this.createTransport(Y);X.open(),this.setTransport(X)}setTransport(Y){if(V0("setting transport %s",Y.name),this.transport)V0("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners();this.transport=Y,Y.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(X)=>this._onClose("transport close",X))}onOpen(){V0("socket open"),this.readyState="open",lX.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(Y){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(V0('socket receive: type "%s", data "%s"',Y.type,Y.data),this.emitReserved("packet",Y),this.emitReserved("heartbeat"),Y.type){case"open":this.onHandshake(JSON.parse(Y.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let X=Error("server error");X.code=Y.data,this._onError(X);break;case"message":this.emitReserved("data",Y.data),this.emitReserved("message",Y.data);break}else V0('packet received with socket readyState "%s"',this.readyState)}onHandshake(Y){if(this.emitReserved("handshake",Y),this.id=Y.sid,this.transport.query.sid=Y.sid,this._pingInterval=Y.pingInterval,this._pingTimeout=Y.pingTimeout,this._maxPayload=Y.maxPayload,this.onOpen(),this.readyState==="closed")return;this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let Y=this._pingInterval+this._pingTimeout;if(this._pingTimeoutTime=Date.now()+Y,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},Y),this.opts.autoUnref)this._pingTimeoutTimer.unref()}_onDrain(){if(this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0)this.emitReserved("drain");else this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let Y=this._getWritablePackets();V0("flushing %d packets in socket",Y.length),this.transport.send(Y),this._prevBufferLen=Y.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let X=1;for(let $=0;$<this.writeBuffer.length;$++){let Q=this.writeBuffer[$].data;if(Q)X+=x9(Q);if($>0&&X>this._maxPayload)return V0("only send %d out of %d packets",$,this.writeBuffer.length),this.writeBuffer.slice(0,$);X+=2}return V0("payload size is %d (max: %d)",X,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let Y=Date.now()>this._pingTimeoutTime;if(Y)V0("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,pX(()=>{this._onClose("ping timeout")},this.setTimeoutFn);return Y}write(Y,X,$){return this._sendPacket("message",Y,X,$),this}send(Y,X,$){return this._sendPacket("message",Y,X,$),this}_sendPacket(Y,X,$,Q){if(typeof X==="function")Q=X,X=void 0;if(typeof $==="function")Q=$,$=null;if(this.readyState==="closing"||this.readyState==="closed")return;$=$||{},$.compress=$.compress!==!1;let Z={type:Y,data:X,options:$};if(this.emitReserved("packetCreate",Z),this.writeBuffer.push(Z),Q)this.once("flush",Q);this.flush()}close(){let Y=()=>{this._onClose("forced close"),V0("socket closing - telling transport to close"),this.transport.close()},X=()=>{this.off("upgrade",X),this.off("upgradeError",X),Y()},$=()=>{this.once("upgrade",X),this.once("upgradeError",X)};if(this.readyState==="opening"||this.readyState==="open")if(this.readyState="closing",this.writeBuffer.length)this.once("drain",()=>{if(this.upgrading)$();else Y()});else if(this.upgrading)$();else Y();return this}_onError(Y){if(V0("socket error %j",Y),lX.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return V0("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",Y),this._onClose("transport error",Y)}_onClose(Y,X){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(V0('socket close with reason: "%s"',Y),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),g4){if(this._beforeunloadEventListener)removeEventListener("beforeunload",this._beforeunloadEventListener,!1);if(this._offlineEventListener){let $=v$.indexOf(this._offlineEventListener);if($!==-1)V0("removing listener for the 'offline' event"),v$.splice($,1)}}this.readyState="closed",this.id=null,this.emitReserved("close",Y,X),this.writeBuffer=[],this._prevBufferLen=0}}}lX.protocol=R4;class k4 extends lX{constructor(){super(...arguments);this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade){V0("starting upgrade probes");for(let Y=0;Y<this._upgrades.length;Y++)this._probe(this._upgrades[Y])}}_probe(Y){V0('probing transport "%s"',Y);let X=this.createTransport(Y),$=!1;lX.priorWebsocketSuccess=!1;let Q=()=>{if($)return;V0('probe transport "%s" opened',Y),X.send([{type:"ping",data:"probe"}]),X.once("packet",(G)=>{if($)return;if(G.type==="pong"&&G.data==="probe"){if(V0('probe transport "%s" pong',Y),this.upgrading=!0,this.emitReserved("upgrading",X),!X)return;lX.priorWebsocketSuccess=X.name==="websocket",V0('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{if($)return;if(this.readyState==="closed")return;V0("changing transport and sending upgrade packet"),U(),this.setTransport(X),X.send([{type:"upgrade"}]),this.emitReserved("upgrade",X),X=null,this.upgrading=!1,this.flush()})}else{V0('probe transport "%s" failed',Y);let A=Error("probe error");A.transport=X.name,this.emitReserved("upgradeError",A)}})};function Z(){if($)return;$=!0,U(),X.close(),X=null}let W=(G)=>{let A=Error("probe error: "+G);A.transport=X.name,Z(),V0('probe transport "%s" failed because of error: %s',Y,G),this.emitReserved("upgradeError",A)};function J(){W("transport closed")}function M(){W("socket closed")}function N(G){if(X&&G.name!==X.name)V0('"%s" works - aborting "%s"',G.name,X.name),Z()}let U=()=>{X.removeListener("open",Q),X.removeListener("error",W),X.removeListener("close",J),this.off("close",M),this.off("upgrading",N)};if(X.once("open",Q),X.once("error",W),X.once("close",J),this.once("close",M),this.once("upgrading",N),this._upgrades.indexOf("webtransport")!==-1&&Y!=="webtransport")this.setTimeoutFn(()=>{if(!$)X.open()},200);else X.open()}onHandshake(Y){this._upgrades=this._filterUpgrades(Y.upgrades),super.onHandshake(Y)}_filterUpgrades(Y){let X=[];for(let $=0;$<Y.length;$++)if(~this.transports.indexOf(Y[$]))X.push(Y[$]);return X}}class h$ extends k4{constructor(Y,X={}){let $=typeof Y==="object"?Y:X;if(!$.transports||$.transports&&typeof $.transports[0]==="string")$.transports=($.transports||["polling","websocket","webtransport"]).map((Q)=>b4[Q]).filter((Q)=>!!Q);super(Y,$)}}var Sd=h$.protocol;var e9=JY(xY(),1),a9=e9.default("socket.io-client:url");function YG(Y,X="",$){let Q=Y;if($=$||typeof location<"u"&&location,Y==null)Y=$.protocol+"//"+$.host;if(typeof Y==="string"){if(Y.charAt(0)==="/")if(Y.charAt(1)==="/")Y=$.protocol+Y;else Y=$.host+Y;if(!/^(https?|wss?):\/\//.test(Y))if(a9("protocol-less url %s",Y),typeof $<"u")Y=$.protocol+"//"+Y;else Y="https://"+Y;a9("parse %s",Y),Q=E6(Y)}if(!Q.port){if(/^(http|ws)$/.test(Q.protocol))Q.port="80";else if(/^(http|ws)s$/.test(Q.protocol))Q.port="443"}Q.path=Q.path||"/";let W=Q.host.indexOf(":")!==-1?"["+Q.host+"]":Q.host;return Q.id=Q.protocol+"://"+W+":"+Q.port+X,Q.href=Q.protocol+"://"+W+($&&$.port===Q.port?"":":"+Q.port),Q}var d4={};wX(d4,{protocol:()=>JG,PacketType:()=>W0,Encoder:()=>MG,Decoder:()=>h4});var ZP=typeof ArrayBuffer==="function",WP=(Y)=>{return typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(Y):Y.buffer instanceof ArrayBuffer},XG=Object.prototype.toString,JP=typeof Blob==="function"||typeof Blob<"u"&&XG.call(Blob)==="[object BlobConstructor]",MP=typeof File==="function"||typeof File<"u"&&XG.call(File)==="[object FileConstructor]";function m$(Y){return ZP&&(Y instanceof ArrayBuffer||WP(Y))||JP&&Y instanceof Blob||MP&&Y instanceof File}function d$(Y,X){if(!Y||typeof Y!=="object")return!1;if(Array.isArray(Y)){for(let $=0,Q=Y.length;$<Q;$++)if(d$(Y[$]))return!0;return!1}if(m$(Y))return!0;if(Y.toJSON&&typeof Y.toJSON==="function"&&arguments.length===1)return d$(Y.toJSON(),!0);for(let $ in Y)if(Object.prototype.hasOwnProperty.call(Y,$)&&d$(Y[$]))return!0;return!1}function $G(Y){let X=[],$=Y.data,Q=Y;return Q.data=f4($,X),Q.attachments=X.length,{packet:Q,buffers:X}}function f4(Y,X){if(!Y)return Y;if(m$(Y)){let $={_placeholder:!0,num:X.length};return X.push(Y),$}else if(Array.isArray(Y)){let $=Array(Y.length);for(let Q=0;Q<Y.length;Q++)$[Q]=f4(Y[Q],X);return $}else if(typeof Y==="object"&&!(Y instanceof Date)){let $={};for(let Q in Y)if(Object.prototype.hasOwnProperty.call(Y,Q))$[Q]=f4(Y[Q],X);return $}return Y}function QG(Y,X){return Y.data=y4(Y.data,X),delete Y.attachments,Y}function y4(Y,X){if(!Y)return Y;if(Y&&Y._placeholder===!0)if(typeof Y.num==="number"&&Y.num>=0&&Y.num<X.length)return X[Y.num];else throw Error("illegal attachments");else if(Array.isArray(Y))for(let $=0;$<Y.length;$++)Y[$]=y4(Y[$],X);else if(typeof Y==="object"){for(let $ in Y)if(Object.prototype.hasOwnProperty.call(Y,$))Y[$]=y4(Y[$],X)}return Y}var WG=JY(xY(),1),v4=WG.default("socket.io-parser"),NP=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],JG=5,W0;(function(Y){Y[Y.CONNECT=0]="CONNECT",Y[Y.DISCONNECT=1]="DISCONNECT",Y[Y.EVENT=2]="EVENT",Y[Y.ACK=3]="ACK",Y[Y.CONNECT_ERROR=4]="CONNECT_ERROR",Y[Y.BINARY_EVENT=5]="BINARY_EVENT",Y[Y.BINARY_ACK=6]="BINARY_ACK"})(W0||(W0={}));class MG{constructor(Y){this.replacer=Y}encode(Y){if(v4("encoding packet %j",Y),Y.type===W0.EVENT||Y.type===W0.ACK){if(d$(Y))return this.encodeAsBinary({type:Y.type===W0.EVENT?W0.BINARY_EVENT:W0.BINARY_ACK,nsp:Y.nsp,data:Y.data,id:Y.id})}return[this.encodeAsString(Y)]}encodeAsString(Y){let X=""+Y.type;if(Y.type===W0.BINARY_EVENT||Y.type===W0.BINARY_ACK)X+=Y.attachments+"-";if(Y.nsp&&Y.nsp!=="/")X+=Y.nsp+",";if(Y.id!=null)X+=Y.id;if(Y.data!=null)X+=JSON.stringify(Y.data,this.replacer);return v4("encoded %j as %s",Y,X),X}encodeAsBinary(Y){let X=$G(Y),$=this.encodeAsString(X.packet),Q=X.buffers;return Q.unshift($),Q}}function ZG(Y){return Object.prototype.toString.call(Y)==="[object Object]"}class h4 extends k0{constructor(Y){super();this.reviver=Y}add(Y){let X;if(typeof Y==="string"){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");X=this.decodeString(Y);let $=X.type===W0.BINARY_EVENT;if($||X.type===W0.BINARY_ACK){if(X.type=$?W0.EVENT:W0.ACK,this.reconstructor=new NG(X),X.attachments===0)super.emitReserved("decoded",X)}else super.emitReserved("decoded",X)}else if(m$(Y)||Y.base64){if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");else if(X=this.reconstructor.takeBinaryData(Y),X)this.reconstructor=null,super.emitReserved("decoded",X)}else throw Error("Unknown type: "+Y)}decodeString(Y){let X=0,$={type:Number(Y.charAt(0))};if(W0[$.type]===void 0)throw Error("unknown packet type "+$.type);if($.type===W0.BINARY_EVENT||$.type===W0.BINARY_ACK){let Z=X+1;while(Y.charAt(++X)!=="-"&&X!=Y.length);let W=Y.substring(Z,X);if(W!=Number(W)||Y.charAt(X)!=="-")throw Error("Illegal attachments");$.attachments=Number(W)}if(Y.charAt(X+1)==="/"){let Z=X+1;while(++X){if(Y.charAt(X)===",")break;if(X===Y.length)break}$.nsp=Y.substring(Z,X)}else $.nsp="/";let Q=Y.charAt(X+1);if(Q!==""&&Number(Q)==Q){let Z=X+1;while(++X){let W=Y.charAt(X);if(W==null||Number(W)!=W){--X;break}if(X===Y.length)break}$.id=Number(Y.substring(Z,X+1))}if(Y.charAt(++X)){let Z=this.tryParse(Y.substr(X));if(h4.isPayloadValid($.type,Z))$.data=Z;else throw Error("invalid payload")}return v4("decoded %s as %j",Y,$),$}tryParse(Y){try{return JSON.parse(Y,this.reviver)}catch(X){return!1}}static isPayloadValid(Y,X){switch(Y){case W0.CONNECT:return ZG(X);case W0.DISCONNECT:return X===void 0;case W0.CONNECT_ERROR:return typeof X==="string"||ZG(X);case W0.EVENT:case W0.BINARY_EVENT:return Array.isArray(X)&&(typeof X[0]==="number"||typeof X[0]==="string"&&NP.indexOf(X[0])===-1);case W0.ACK:case W0.BINARY_ACK:return Array.isArray(X)}}destroy(){if(this.reconstructor)this.reconstructor.finishedReconstruction(),this.reconstructor=null}}class NG{constructor(Y){this.packet=Y,this.buffers=[],this.reconPack=Y}takeBinaryData(Y){if(this.buffers.push(Y),this.buffers.length===this.reconPack.attachments){let X=QG(this.reconPack,this.buffers);return this.finishedReconstruction(),X}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function LY(Y,X,$){return Y.on(X,$),function(){Y.off(X,$)}}var GG=JY(xY(),1),S1=GG.default("socket.io-client:socket"),GP=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class u$ extends k0{constructor(Y,X,$){super();if(this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=Y,this.nsp=X,$&&$.auth)this.auth=$.auth;if(this._opts=Object.assign({},$),this.io._autoConnect)this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let Y=this.io;this.subs=[LY(Y,"open",this.onopen.bind(this)),LY(Y,"packet",this.onpacket.bind(this)),LY(Y,"error",this.onerror.bind(this)),LY(Y,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){if(this.connected)return this;if(this.subEvents(),!this.io._reconnecting)this.io.open();if(this.io._readyState==="open")this.onopen();return this}open(){return this.connect()}send(...Y){return Y.unshift("message"),this.emit.apply(this,Y),this}emit(Y,...X){var $,Q,Z;if(GP.hasOwnProperty(Y))throw Error('"'+Y.toString()+'" is a reserved event name');if(X.unshift(Y),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(X),this;let W={type:W0.EVENT,data:X};if(W.options={},W.options.compress=this.flags.compress!==!1,typeof X[X.length-1]==="function"){let U=this.ids++;S1("emitting packet with ack id %d",U);let G=X.pop();this._registerAckCallback(U,G),W.id=U}let J=(Q=($=this.io.engine)===null||$===void 0?void 0:$.transport)===null||Q===void 0?void 0:Q.writable,M=this.connected&&!((Z=this.io.engine)===null||Z===void 0?void 0:Z._hasPingExpired());if(this.flags.volatile&&!J)S1("discard packet as the transport is not currently writable");else if(M)this.notifyOutgoingListeners(W),this.packet(W);else this.sendBuffer.push(W);return this.flags={},this}_registerAckCallback(Y,X){var $;let Q=($=this.flags.timeout)!==null&&$!==void 0?$:this._opts.ackTimeout;if(Q===void 0){this.acks[Y]=X;return}let Z=this.io.setTimeoutFn(()=>{delete this.acks[Y];for(let J=0;J<this.sendBuffer.length;J++)if(this.sendBuffer[J].id===Y)S1("removing packet with ack id %d from the buffer",Y),this.sendBuffer.splice(J,1);S1("event with ack id %d has timed out after %d ms",Y,Q),X.call(this,Error("operation has timed out"))},Q),W=(...J)=>{this.io.clearTimeoutFn(Z),X.apply(this,J)};W.withError=!0,this.acks[Y]=W}emitWithAck(Y,...X){return new Promise(($,Q)=>{let Z=(W,J)=>{return W?Q(W):$(J)};Z.withError=!0,X.push(Z),this.emit(Y,...X)})}_addToQueue(Y){let X;if(typeof Y[Y.length-1]==="function")X=Y.pop();let $={id:this._queueSeq++,tryCount:0,pending:!1,args:Y,flags:Object.assign({fromQueue:!0},this.flags)};Y.push((Q,...Z)=>{if($!==this._queue[0])return;if(Q!==null){if($.tryCount>this._opts.retries){if(S1("packet [%d] is discarded after %d tries",$.id,$.tryCount),this._queue.shift(),X)X(Q)}}else if(S1("packet [%d] was successfully sent",$.id),this._queue.shift(),X)X(null,...Z);return $.pending=!1,this._drainQueue()}),this._queue.push($),this._drainQueue()}_drainQueue(Y=!1){if(S1("draining queue"),!this.connected||this._queue.length===0)return;let X=this._queue[0];if(X.pending&&!Y){S1("packet [%d] has already been sent and is waiting for an ack",X.id);return}X.pending=!0,X.tryCount++,S1("sending packet [%d] (try n\xB0%d)",X.id,X.tryCount),this.flags=X.flags,this.emit.apply(this,X.args)}packet(Y){Y.nsp=this.nsp,this.io._packet(Y)}onopen(){if(S1("transport is open - connecting"),typeof this.auth=="function")this.auth((Y)=>{this._sendConnectPacket(Y)});else this._sendConnectPacket(this.auth)}_sendConnectPacket(Y){this.packet({type:W0.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},Y):Y})}onerror(Y){if(!this.connected)this.emitReserved("connect_error",Y)}onclose(Y,X){S1("close (%s)",Y),this.connected=!1,delete this.id,this.emitReserved("disconnect",Y,X),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((Y)=>{if(!this.sendBuffer.some(($)=>String($.id)===Y)){let $=this.acks[Y];if(delete this.acks[Y],$.withError)$.call(this,Error("socket has been disconnected"))}})}onpacket(Y){if(Y.nsp!==this.nsp)return;switch(Y.type){case W0.CONNECT:if(Y.data&&Y.data.sid)this.onconnect(Y.data.sid,Y.data.pid);else this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case W0.EVENT:case W0.BINARY_EVENT:this.onevent(Y);break;case W0.ACK:case W0.BINARY_ACK:this.onack(Y);break;case W0.DISCONNECT:this.ondisconnect();break;case W0.CONNECT_ERROR:this.destroy();let $=Error(Y.data.message);$.data=Y.data.data,this.emitReserved("connect_error",$);break}}onevent(Y){let X=Y.data||[];if(S1("emitting event %j",X),Y.id!=null)S1("attaching ack callback to event"),X.push(this.ack(Y.id));if(this.connected)this.emitEvent(X);else this.receiveBuffer.push(Object.freeze(X))}emitEvent(Y){if(this._anyListeners&&this._anyListeners.length){let X=this._anyListeners.slice();for(let $ of X)$.apply(this,Y)}if(super.emit.apply(this,Y),this._pid&&Y.length&&typeof Y[Y.length-1]==="string")this._lastOffset=Y[Y.length-1]}ack(Y){let X=this,$=!1;return function(...Q){if($)return;$=!0,S1("sending ack %j",Q),X.packet({type:W0.ACK,id:Y,data:Q})}}onack(Y){let X=this.acks[Y.id];if(typeof X!=="function"){S1("bad ack %s",Y.id);return}if(delete this.acks[Y.id],S1("calling ack %s with %j",Y.id,Y.data),X.withError)Y.data.unshift(null);X.apply(this,Y.data)}onconnect(Y,X){S1("socket connected with id %s",Y),this.id=Y,this.recovered=X&&this._pid===X,this._pid=X,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((Y)=>this.emitEvent(Y)),this.receiveBuffer=[],this.sendBuffer.forEach((Y)=>{this.notifyOutgoingListeners(Y),this.packet(Y)}),this.sendBuffer=[]}ondisconnect(){S1("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){if(this.subs)this.subs.forEach((Y)=>Y()),this.subs=void 0;this.io._destroy(this)}disconnect(){if(this.connected)S1("performing disconnect (%s)",this.nsp),this.packet({type:W0.DISCONNECT});if(this.destroy(),this.connected)this.onclose("io client disconnect");return this}close(){return this.disconnect()}compress(Y){return this.flags.compress=Y,this}get volatile(){return this.flags.volatile=!0,this}timeout(Y){return this.flags.timeout=Y,this}onAny(Y){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(Y),this}prependAny(Y){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(Y),this}offAny(Y){if(!this._anyListeners)return this;if(Y){let X=this._anyListeners;for(let $=0;$<X.length;$++)if(Y===X[$])return X.splice($,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(Y){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(Y),this}prependAnyOutgoing(Y){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(Y),this}offAnyOutgoing(Y){if(!this._anyOutgoingListeners)return this;if(Y){let X=this._anyOutgoingListeners;for(let $=0;$<X.length;$++)if(Y===X[$])return X.splice($,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(Y){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let X=this._anyOutgoingListeners.slice();for(let $ of X)$.apply(this,Y.data)}}}function k8(Y){Y=Y||{},this.ms=Y.min||100,this.max=Y.max||1e4,this.factor=Y.factor||2,this.jitter=Y.jitter>0&&Y.jitter<=1?Y.jitter:0,this.attempts=0}k8.prototype.duration=function(){var Y=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var X=Math.random(),$=Math.floor(X*this.jitter*Y);Y=(Math.floor(X*10)&1)==0?Y-$:Y+$}return Math.min(Y,this.max)|0};k8.prototype.reset=function(){this.attempts=0};k8.prototype.setMin=function(Y){this.ms=Y};k8.prototype.setMax=function(Y){this.max=Y};k8.prototype.setJitter=function(Y){this.jitter=Y};var UG=JY(xY(),1),g1=UG.default("socket.io-client:manager");class c$ extends k0{constructor(Y,X){var $;super();if(this.nsps={},this.subs=[],Y&&typeof Y==="object")X=Y,Y=void 0;X=X||{},X.path=X.path||"/socket.io",this.opts=X,iX(this,X),this.reconnection(X.reconnection!==!1),this.reconnectionAttempts(X.reconnectionAttempts||1/0),this.reconnectionDelay(X.reconnectionDelay||1000),this.reconnectionDelayMax(X.reconnectionDelayMax||5000),this.randomizationFactor(($=X.randomizationFactor)!==null&&$!==void 0?$:0.5),this.backoff=new k8({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(X.timeout==null?20000:X.timeout),this._readyState="closed",this.uri=Y;let Q=X.parser||d4;if(this.encoder=new Q.Encoder,this.decoder=new Q.Decoder,this._autoConnect=X.autoConnect!==!1,this._autoConnect)this.open()}reconnection(Y){if(!arguments.length)return this._reconnection;if(this._reconnection=!!Y,!Y)this.skipReconnect=!0;return this}reconnectionAttempts(Y){if(Y===void 0)return this._reconnectionAttempts;return this._reconnectionAttempts=Y,this}reconnectionDelay(Y){var X;if(Y===void 0)return this._reconnectionDelay;return this._reconnectionDelay=Y,(X=this.backoff)===null||X===void 0||X.setMin(Y),this}randomizationFactor(Y){var X;if(Y===void 0)return this._randomizationFactor;return this._randomizationFactor=Y,(X=this.backoff)===null||X===void 0||X.setJitter(Y),this}reconnectionDelayMax(Y){var X;if(Y===void 0)return this._reconnectionDelayMax;return this._reconnectionDelayMax=Y,(X=this.backoff)===null||X===void 0||X.setMax(Y),this}timeout(Y){if(!arguments.length)return this._timeout;return this._timeout=Y,this}maybeReconnectOnOpen(){if(!this._reconnecting&&this._reconnection&&this.backoff.attempts===0)this.reconnect()}open(Y){if(g1("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;g1("opening %s",this.uri),this.engine=new h$(this.uri,this.opts);let X=this.engine,$=this;this._readyState="opening",this.skipReconnect=!1;let Q=LY(X,"open",function(){$.onopen(),Y&&Y()}),Z=(J)=>{if(g1("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",J),Y)Y(J);else this.maybeReconnectOnOpen()},W=LY(X,"error",Z);if(this._timeout!==!1){let J=this._timeout;g1("connect attempt will timeout after %d",J);let M=this.setTimeoutFn(()=>{g1("connect attempt timed out after %d",J),Q(),Z(Error("timeout")),X.close()},J);if(this.opts.autoUnref)M.unref();this.subs.push(()=>{this.clearTimeoutFn(M)})}return this.subs.push(Q),this.subs.push(W),this}connect(Y){return this.open(Y)}onopen(){g1("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let Y=this.engine;this.subs.push(LY(Y,"ping",this.onping.bind(this)),LY(Y,"data",this.ondata.bind(this)),LY(Y,"error",this.onerror.bind(this)),LY(Y,"close",this.onclose.bind(this)),LY(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(Y){try{this.decoder.add(Y)}catch(X){this.onclose("parse error",X)}}ondecoded(Y){pX(()=>{this.emitReserved("packet",Y)},this.setTimeoutFn)}onerror(Y){g1("error",Y),this.emitReserved("error",Y)}socket(Y,X){let $=this.nsps[Y];if(!$)$=new u$(this,Y,X),this.nsps[Y]=$;else if(this._autoConnect&&!$.active)$.connect();return $}_destroy(Y){let X=Object.keys(this.nsps);for(let $ of X)if(this.nsps[$].active){g1("socket %s is still active, skipping close",$);return}this._close()}_packet(Y){g1("writing packet %j",Y);let X=this.encoder.encode(Y);for(let $=0;$<X.length;$++)this.engine.write(X[$],Y.options)}cleanup(){g1("cleanup"),this.subs.forEach((Y)=>Y()),this.subs.length=0,this.decoder.destroy()}_close(){g1("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(Y,X){var $;if(g1("closed due to %s",Y),this.cleanup(),($=this.engine)===null||$===void 0||$.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",Y,X),this._reconnection&&!this.skipReconnect)this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let Y=this;if(this.backoff.attempts>=this._reconnectionAttempts)g1("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let X=this.backoff.duration();g1("will wait %dms before reconnect attempt",X),this._reconnecting=!0;let $=this.setTimeoutFn(()=>{if(Y.skipReconnect)return;if(g1("attempting reconnect"),this.emitReserved("reconnect_attempt",Y.backoff.attempts),Y.skipReconnect)return;Y.open((Q)=>{if(Q)g1("reconnect attempt error"),Y._reconnecting=!1,Y.reconnect(),this.emitReserved("reconnect_error",Q);else g1("reconnect success"),Y.onreconnect()})},X);if(this.opts.autoUnref)$.unref();this.subs.push(()=>{this.clearTimeoutFn($)})}}onreconnect(){let Y=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",Y)}}var AG=JY(xY(),1),BG=AG.default("socket.io-client"),p$={};function i$(Y,X){if(typeof Y==="object")X=Y,Y=void 0;X=X||{};let $=YG(Y,X.path||"/socket.io"),Q=$.source,Z=$.id,W=$.path,J=p$[Z]&&W in p$[Z].nsps,M=X.forceNew||X["force new connection"]||X.multiplex===!1||J,N;if(M)BG("ignoring socket cache for %s",Q),N=new c$(Q,X);else{if(!p$[Z])BG("new io instance for %s",Q),p$[Z]=new c$(Q,X);N=p$[Z]}if($.query&&!X.query)X.query=$.queryKey;return N.socket($.path,X)}Object.assign(i$,{Manager:c$,Socket:u$,io:i$,connect:i$});import wG from"path";import BP from"fs";async function HG(){await $0`PRAGMA foreign_keys = ON`,await $0`PRAGMA journal_mode = WAL`,await $0`PRAGMA synchronous = NORMAL`,await $0`
        BEGIN TRANSACTION;
        CREATE TABLE IF NOT EXISTS users (
            id INTEGER PRIMARY KEY,
            username TEXT NOT NULL,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
        );

        CREATE TABLE IF NOT EXISTS animes (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            name TEXT NOT NULL,
            description TEXT NOT NULL,
            img_url TEXT NOT NULL,
            status TEXT NOT NULL,
            slug TEXT NOT NULL,
            date INTEGER NOT NULL,
            genres TEXT NOT NULL,
            caps INTEGER NOT NULL,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
        );
        CREATE INDEX IF NOT EXISTS idx_animes_slug ON animes(slug);

        CREATE TABLE IF NOT EXISTS episodes (
            id TEXT PRIMARY KEY,
            cap INTEGER NOT NULL,
            anime_id INTEGER NOT NULL,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (anime_id) REFERENCES animes(id),
            UNIQUE (anime_id, cap)
        );
        CREATE INDEX IF NOT EXISTS idx_episodes_anime_id ON episodes(anime_id);

        CREATE TABLE IF NOT EXISTS favorites (
            id TEXT PRIMARY KEY NOT NULL,
            user_id INTEGER NOT NULL DEFAULT 1,
            anime_id INTEGER NOT NULL,
            name TEXT NOT NULL,
            slug TEXT NOT NULL,
            img_url TEXT NOT NULL,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (user_id) REFERENCES users (id),
            UNIQUE (user_id, anime_id)
        );

        CREATE TABLE IF NOT EXISTS activity_history (
            id TEXT PRIMARY KEY NOT NULL,
            user_id INTEGER NOT NULL,
            anime_id INTEGER NOT NULL,
            name TEXT NOT NULL,
            slug TEXT NOT NULL,
            img_url TEXT NOT NULL,
            last_episode INTEGER NOT NULL DEFAULT 0,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (user_id) REFERENCES users (id),
            UNIQUE (user_id, anime_id)
        );
        CREATE INDEX IF NOT EXISTS idx_activity_user_id ON activity_history(user_id);
        CREATE INDEX IF NOT EXISTS idx_activity_anime_id ON activity_history(anime_id);

        CREATE TABLE IF NOT EXISTS history (
            id TEXT PRIMARY KEY,
            user_id INTEGER NOT NULL,
            anime_id INTEGER NOT NULL,
            cap_number INTEGER NOT NULL,
            last_position_seconds INTEGER DEFAULT 0,
            watched INTEGER DEFAULT 0,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (user_id) REFERENCES users(id),
            UNIQUE (user_id, anime_id, cap_number)
        );
        CREATE INDEX IF NOT EXISTS idx_history_user_id ON history(user_id);
        CREATE INDEX IF NOT EXISTS idx_history_anime_id ON history(anime_id);

      COMMIT;
    `,await $0`
          CREATE TABLE IF NOT EXISTS cache (
            id TEXT PRIMARY KEY NOT NULL,
            value TEXT NOT NULL,
            createdAt DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL
          )
        `,await $0`
          CREATE TABLE IF NOT EXISTS plugins_manifest (
            name TEXT PRIMARY KEY NOT NULL,
            version TEXT NOT NULL,
            urlPage TEXT NOT NULL,
            date_created DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL,
            filterSupportedList TEXT NOT NULL,
            createdAt DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL
          )
        `}var zG=process.env.PORT??3000,qG=process.env.HOSTNAME??"0.0.0.0",OG=process.env.SOCKET_IO_URL??"http://localhost:";async function DG(){if((await $0`SELECT * FROM plugins_manifest`).length===0){let X=await QY("getManifest",{});if(X.success)await $0`
            INSERT INTO plugins_manifest (
              name,
              version,
              urlPage,
              date_created,
              filterSupportedList
            ) VALUES (
              ${X.content.name},
              ${X.content.version},
              ${X.content.urlPage},
              ${X.content.date_created},
              ${JSON.stringify(X.content.filterSupportedList)}
            )
          `}}Bun.spawn([wG.join(process.cwd(),"plugins","animeav1.exe")]);var AP=wG.join(UP.tmpdir(),"animeav1","config.json"),HP=JSON.parse(BP.readFileSync(AP,"utf-8")),m4=i$(OG+HP.port);m4.on("connect",()=>{console.log("\u2705 Connected to scraper server webSocket")});var QY=async(Y,X)=>{return new Promise(($,Q)=>{m4.emit(Y,X,(Z)=>{$(Z)})})};m4.on("disconnect",()=>{console.log("\u274C Disconnected from scraper server webSocket")});var L1=GZ.create();await HG();await DG();if(import.meta.main)D9.listen({port:zG,hostname:qG});export{QY as sendMessage,L1 as cacheRepository};
